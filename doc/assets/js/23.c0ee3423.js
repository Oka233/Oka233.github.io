(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{859:function(e,t,s){"use strict";function a(e,t){const s=Object.create(null),a=e.split(",");for(let e=0;e<a.length;e++)s[a[e]]=!0;return t?e=>!!s[e.toLowerCase()]:e=>!!s[e]}s.r(t),s.d(t,"VueAdvancedChat",(function(){return Lg})),s.d(t,"register",(function(){return Pg}));const o=()=>{},n=Object.assign,r=Object.prototype.hasOwnProperty,i=(e,t)=>r.call(e,t),l=Array.isArray,c=e=>"[object Map]"===p(e),d=e=>"symbol"==typeof e,u=e=>null!==e&&"object"==typeof e,m=Object.prototype.toString,p=e=>m.call(e),h=e=>"string"==typeof e&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,f=(e,t)=>!Object.is(e,t);let g;class _{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&g&&(this.parent=g,this.index=(g.scopes||(g.scopes=[])).push(this)-1)}run(e){if(this.active){const t=g;try{return g=this,e()}finally{g=t}}}on(){g=this}off(){g=this.parent}stop(e){if(this.active){let t,s;for(t=0,s=this.effects.length;t<s;t++)this.effects[t].stop();for(t=0,s=this.cleanups.length;t<s;t++)this.cleanups[t]();if(this.scopes)for(t=0,s=this.scopes.length;t<s;t++)this.scopes[t].stop(!0);if(this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.active=!1}}}const v=e=>{const t=new Set(e);return t.w=0,t.n=0,t},b=e=>(e.w&k)>0,y=e=>(e.n&k)>0,x=new WeakMap;let w=0,k=1;let S;const M=Symbol(""),A=Symbol("");class R{constructor(e,t=null,s){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],this.parent=void 0,function(e,t=g){t&&t.active&&t.effects.push(e)}(this,s)}run(){if(!this.active)return this.fn();let e=S,t=E;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=S,S=this,E=!0,k=1<<++w,w<=30?(({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=k})(this):T(this),this.fn()}finally{w<=30&&(e=>{const{deps:t}=e;if(t.length){let s=0;for(let a=0;a<t.length;a++){const o=t[a];b(o)&&!y(o)?o.delete(e):t[s++]=o,o.w&=~k,o.n&=~k}t.length=s}})(this),k=1<<--w,S=this.parent,E=t,this.parent=void 0,this.deferStop&&this.stop()}}stop(){S===this?this.deferStop=!0:this.active&&(T(this),this.onStop&&this.onStop(),this.active=!1)}}function T(e){const{deps:t}=e;if(t.length){for(let s=0;s<t.length;s++)t[s].delete(e);t.length=0}}let E=!0;const B=[];function O(){B.push(E),E=!1}function C(){const e=B.pop();E=void 0===e||e}function j(e,t,s){if(E&&S){let t=x.get(e);t||x.set(e,t=new Map);let a=t.get(s);a||t.set(s,a=v()),I(a)}}function I(e,t){let s=!1;w<=30?y(e)||(e.n|=k,s=!b(e)):s=!e.has(S),s&&(e.add(S),S.deps.push(e))}function L(e,t,s,a,o,n){const r=x.get(e);if(!r)return;let i=[];if("clear"===t)i=[...r.values()];else if("length"===s&&l(e))r.forEach((e,t)=>{("length"===t||t>=a)&&i.push(e)});else switch(void 0!==s&&i.push(r.get(s)),t){case"add":l(e)?h(s)&&i.push(r.get("length")):(i.push(r.get(M)),c(e)&&i.push(r.get(A)));break;case"delete":l(e)||(i.push(r.get(M)),c(e)&&i.push(r.get(A)));break;case"set":c(e)&&i.push(r.get(M))}if(1===i.length)i[0]&&P(i[0]);else{const e=[];for(const t of i)t&&e.push(...t);P(v(e))}}function P(e,t){const s=l(e)?e:[...e];for(const e of s)e.computed&&N(e);for(const e of s)e.computed||N(e)}function N(e,t){(e!==S||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const H=a("__proto__,__v_isRef,__isVue"),F=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>"arguments"!==e&&"caller"!==e).map(e=>Symbol[e]).filter(d)),D=z(),$=z(!1,!0),U=z(!0),q=V();function V(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...e){const s=Ee(this);for(let e=0,t=this.length;e<t;e++)j(s,0,e+"");const a=s[t](...e);return-1===a||!1===a?s[t](...e.map(Ee)):a}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...e){O();const s=Ee(this)[t].apply(this,e);return C(),s}}),e}function z(e=!1,t=!1){return function(s,a,o){if("__v_isReactive"===a)return!e;if("__v_isReadonly"===a)return e;if("__v_isShallow"===a)return t;if("__v_raw"===a&&o===(e?t?ye:be:t?ve:_e).get(s))return s;const n=l(s);if(!e&&n&&i(q,a))return Reflect.get(q,a,o);const r=Reflect.get(s,a,o);return(d(a)?F.has(a):H(a))?r:(e||j(s,0,a),t?r:je(r)?n&&h(a)?r:r.value:u(r)?e?ke(r):we(r):r)}}function X(e=!1){return function(t,s,a,o){let n=t[s];if(Ae(n)&&je(n)&&!je(a))return!1;if(!e&&!Ae(a)&&(Re(a)||(a=Ee(a),n=Ee(n)),!l(t)&&je(n)&&!je(a)))return n.value=a,!0;const r=l(t)&&h(s)?Number(s)<t.length:i(t,s),c=Reflect.set(t,s,a,o);return t===Ee(o)&&(r?f(a,n)&&L(t,"set",s,a):L(t,"add",s,a)),c}}const Y={get:D,set:X(),deleteProperty:function(e,t){const s=i(e,t);e[t];const a=Reflect.deleteProperty(e,t);return a&&s&&L(e,"delete",t,void 0),a},has:function(e,t){const s=Reflect.has(e,t);return d(t)&&F.has(t)||j(e,0,t),s},ownKeys:function(e){return j(e,0,l(e)?"length":M),Reflect.ownKeys(e)}},K={get:U,set:(e,t)=>!0,deleteProperty:(e,t)=>!0},G=n({},Y,{get:$,set:X(!0)}),Z=e=>e,W=e=>Reflect.getPrototypeOf(e);function Q(e,t,s=!1,a=!1){const o=Ee(e=e.__v_raw),n=Ee(t);s||(t!==n&&j(o,0,t),j(o,0,n));const{has:r}=W(o),i=a?Z:s?Ce:Oe;return r.call(o,t)?i(e.get(t)):r.call(o,n)?i(e.get(n)):void(e!==o&&e.get(t))}function J(e,t=!1){const s=this.__v_raw,a=Ee(s),o=Ee(e);return t||(e!==o&&j(a,0,e),j(a,0,o)),e===o?s.has(e):s.has(e)||s.has(o)}function ee(e,t=!1){return e=e.__v_raw,!t&&j(Ee(e),0,M),Reflect.get(e,"size",e)}function te(e){e=Ee(e);const t=Ee(this);return W(t).has.call(t,e)||(t.add(e),L(t,"add",e,e)),this}function se(e,t){t=Ee(t);const s=Ee(this),{has:a,get:o}=W(s);let n=a.call(s,e);n||(e=Ee(e),n=a.call(s,e));const r=o.call(s,e);return s.set(e,t),n?f(t,r)&&L(s,"set",e,t):L(s,"add",e,t),this}function ae(e){const t=Ee(this),{has:s,get:a}=W(t);let o=s.call(t,e);o||(e=Ee(e),o=s.call(t,e)),a&&a.call(t,e);const n=t.delete(e);return o&&L(t,"delete",e,void 0),n}function oe(){const e=Ee(this),t=0!==e.size,s=e.clear();return t&&L(e,"clear",void 0,void 0),s}function ne(e,t){return function(s,a){const o=this,n=o.__v_raw,r=Ee(n),i=t?Z:e?Ce:Oe;return!e&&j(r,0,M),n.forEach((e,t)=>s.call(a,i(e),i(t),o))}}function re(e,t,s){return function(...a){const o=this.__v_raw,n=Ee(o),r=c(n),i="entries"===e||e===Symbol.iterator&&r,l="keys"===e&&r,d=o[e](...a),u=s?Z:t?Ce:Oe;return!t&&j(n,0,l?A:M),{next(){const{value:e,done:t}=d.next();return t?{value:e,done:t}:{value:i?[u(e[0]),u(e[1])]:u(e),done:t}},[Symbol.iterator](){return this}}}}function ie(e){return function(...t){return"delete"!==e&&this}}function le(){const e={get(e){return Q(this,e)},get size(){return ee(this)},has:J,add:te,set:se,delete:ae,clear:oe,forEach:ne(!1,!1)},t={get(e){return Q(this,e,!1,!0)},get size(){return ee(this)},has:J,add:te,set:se,delete:ae,clear:oe,forEach:ne(!1,!0)},s={get(e){return Q(this,e,!0)},get size(){return ee(this,!0)},has(e){return J.call(this,e,!0)},add:ie("add"),set:ie("set"),delete:ie("delete"),clear:ie("clear"),forEach:ne(!0,!1)},a={get(e){return Q(this,e,!0,!0)},get size(){return ee(this,!0)},has(e){return J.call(this,e,!0)},add:ie("add"),set:ie("set"),delete:ie("delete"),clear:ie("clear"),forEach:ne(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(o=>{e[o]=re(o,!1,!1),s[o]=re(o,!0,!1),t[o]=re(o,!1,!0),a[o]=re(o,!0,!0)}),[e,s,t,a]}const[ce,de,ue,me]=le();function pe(e,t){const s=t?e?me:ue:e?de:ce;return(t,a,o)=>"__v_isReactive"===a?!e:"__v_isReadonly"===a?e:"__v_raw"===a?t:Reflect.get(i(s,a)&&a in t?s:t,a,o)}const he={get:pe(!1,!1)},fe={get:pe(!1,!0)},ge={get:pe(!0,!1)},_e=new WeakMap,ve=new WeakMap,be=new WeakMap,ye=new WeakMap;function xe(e){return e.__v_skip||!Object.isExtensible(e)?0:function(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}((e=>p(e).slice(8,-1))(e))}function we(e){return Ae(e)?e:Se(e,!1,Y,he,_e)}function ke(e){return Se(e,!0,K,ge,be)}function Se(e,t,s,a,o){if(!u(e))return e;if(e.__v_raw&&(!t||!e.__v_isReactive))return e;const n=o.get(e);if(n)return n;const r=xe(e);if(0===r)return e;const i=new Proxy(e,2===r?a:s);return o.set(e,i),i}function Me(e){return Ae(e)?Me(e.__v_raw):!(!e||!e.__v_isReactive)}function Ae(e){return!(!e||!e.__v_isReadonly)}function Re(e){return!(!e||!e.__v_isShallow)}function Te(e){return Me(e)||Ae(e)}function Ee(e){const t=e&&e.__v_raw;return t?Ee(t):e}function Be(e){return((e,t,s)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:s})})(e,"__v_skip",!0),e}const Oe=e=>u(e)?we(e):e,Ce=e=>u(e)?ke(e):e;function je(e){return!(!e||!0!==e.__v_isRef)}const Ie={get:(e,t,s)=>{return je(a=Reflect.get(e,t,s))?a.value:a;var a},set:(e,t,s,a)=>{const o=e[t];return je(o)&&!je(s)?(o.value=s,!0):Reflect.set(e,t,s,a)}};function Le(e){return Me(e)?e:new Proxy(e,Ie)}class Pe{constructor(e,t,s,a){this._setter=t,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new R(e,()=>{var e;this._dirty||(this._dirty=!0,(e=Ee(e=this)).dep&&P(e.dep))}),this.effect.computed=this,this.effect.active=this._cacheable=!a,this.__v_isReadonly=s}get value(){const e=Ee(this);var t;return t=e,E&&S&&I((t=Ee(t)).dep||(t.dep=v())),!e._dirty&&e._cacheable||(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function Ne(e,t){const s=Object.create(null),a=e.split(",");for(let e=0;e<a.length;e++)s[a[e]]=!0;return t?e=>!!s[e.toLowerCase()]:e=>!!s[e]}function He(e){if(at(e)){const t={};for(let s=0;s<e.length;s++){const a=e[s],o=it(a)?$e(a):He(a);if(o)for(const e in o)t[e]=o[e]}return t}return it(e)||lt(e)?e:void 0}const Fe=/;(?![^(]*\))/g,De=/:(.+)/;function $e(e){const t={};return e.split(Fe).forEach(e=>{if(e){const s=e.split(De);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function Ue(e){let t="";if(it(e))t=e;else if(at(e))for(let s=0;s<e.length;s++){const a=Ue(e[s]);a&&(t+=a+" ")}else if(lt(e))for(const s in e)e[s]&&(t+=s+" ");return t.trim()}function qe(e){if(!e)return null;let{class:t,style:s}=e;return t&&!it(t)&&(e.class=Ue(t)),s&&(e.style=He(s)),e}const Ve=e=>it(e)?e:null==e?"":at(e)||lt(e)&&(e.toString===dt||!rt(e.toString))?JSON.stringify(e,ze,2):String(e),ze=(e,t)=>t&&t.__v_isRef?ze(e,t.value):ot(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[t,s])=>(e[t+" =>"]=s,e),{})}:nt(t)?{[`Set(${t.size})`]:[...t.values()]}:!lt(t)||at(t)||mt(t)?t:String(t),Xe={},Ye=[],Ke=()=>{},Ge=()=>!1,Ze=/^on[^a-z]/,We=e=>Ze.test(e),Qe=e=>e.startsWith("onUpdate:"),Je=Object.assign,et=(e,t)=>{const s=e.indexOf(t);s>-1&&e.splice(s,1)},tt=Object.prototype.hasOwnProperty,st=(e,t)=>tt.call(e,t),at=Array.isArray,ot=e=>"[object Map]"===ut(e),nt=e=>"[object Set]"===ut(e),rt=e=>"function"==typeof e,it=e=>"string"==typeof e,lt=e=>null!==e&&"object"==typeof e,ct=e=>lt(e)&&rt(e.then)&&rt(e.catch),dt=Object.prototype.toString,ut=e=>dt.call(e),mt=e=>"[object Object]"===ut(e),pt=Ne(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ht=e=>{const t=Object.create(null);return s=>t[s]||(t[s]=e(s))},ft=/-(\w)/g,gt=ht(e=>e.replace(ft,(e,t)=>t?t.toUpperCase():"")),_t=/\B([A-Z])/g,vt=ht(e=>e.replace(_t,"-$1").toLowerCase()),bt=ht(e=>e.charAt(0).toUpperCase()+e.slice(1)),yt=ht(e=>e?"on"+bt(e):""),xt=(e,t)=>!Object.is(e,t),wt=(e,t)=>{for(let s=0;s<e.length;s++)e[s](t)},kt=(e,t,s)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:s})},St=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Mt;function At(e,t,s,a){let o;try{o=a?e(...a):e()}catch(e){Tt(e,t,s)}return o}function Rt(e,t,s,a){if(rt(e)){const o=At(e,t,s,a);return o&&ct(o)&&o.catch(e=>{Tt(e,t,s)}),o}const o=[];for(let n=0;n<e.length;n++)o.push(Rt(e[n],t,s,a));return o}function Tt(e,t,s,a=!0){t&&t.vnode;if(t){let a=t.parent;const o=t.proxy,n=s;for(;a;){const t=a.ec;if(t)for(let s=0;s<t.length;s++)if(!1===t[s](e,o,n))return;a=a.parent}const r=t.appContext.config.errorHandler;if(r)return void At(r,null,10,[e,o,n])}!function(e,t,s,a=!0){console.error(e)}(e,0,0,a)}let Et=!1,Bt=!1;const Ot=[];let Ct=0;const jt=[];let It=null,Lt=0;const Pt=[];let Nt=null,Ht=0;const Ft=Promise.resolve();let Dt=null,$t=null;function Ut(e){const t=Dt||Ft;return e?t.then(this?e.bind(this):e):t}function qt(e){Ot.length&&Ot.includes(e,Et&&e.allowRecurse?Ct+1:Ct)||e===$t||(null==e.id?Ot.push(e):Ot.splice(function(e){let t=Ct+1,s=Ot.length;for(;t<s;){const a=t+s>>>1;Kt(Ot[a])<e?t=a+1:s=a}return t}(e.id),0,e),Vt())}function Vt(){Et||Bt||(Bt=!0,Dt=Ft.then(Gt))}function zt(e,t,s,a){at(e)?s.push(...e):t&&t.includes(e,e.allowRecurse?a+1:a)||s.push(e),Vt()}function Xt(e,t=null){if(jt.length){for($t=t,It=[...new Set(jt)],jt.length=0,Lt=0;Lt<It.length;Lt++)It[Lt]();It=null,Lt=0,$t=null,Xt(e,t)}}function Yt(e){if(Xt(),Pt.length){const e=[...new Set(Pt)];if(Pt.length=0,Nt)return void Nt.push(...e);for(Nt=e,Nt.sort((e,t)=>Kt(e)-Kt(t)),Ht=0;Ht<Nt.length;Ht++)Nt[Ht]();Nt=null,Ht=0}}const Kt=e=>null==e.id?1/0:e.id;function Gt(e){Bt=!1,Et=!0,Xt(e),Ot.sort((e,t)=>Kt(e)-Kt(t));try{for(Ct=0;Ct<Ot.length;Ct++){const e=Ot[Ct];e&&!1!==e.active&&At(e,null,14)}}finally{Ct=0,Ot.length=0,Yt(),Et=!1,Dt=null,(Ot.length||jt.length||Pt.length)&&Gt(e)}}function Zt(e,t,...s){if(e.isUnmounted)return;const a=e.vnode.props||Xe;let o=s;const n=t.startsWith("update:"),r=n&&t.slice(7);if(r&&r in a){const e=("modelValue"===r?"model":r)+"Modifiers",{number:t,trim:n}=a[e]||Xe;n&&(o=s.map(e=>e.trim())),t&&(o=s.map(St))}let i,l=a[i=yt(t)]||a[i=yt(gt(t))];!l&&n&&(l=a[i=yt(vt(t))]),l&&Rt(l,e,6,o);const c=a[i+"Once"];if(c){if(e.emitted){if(e.emitted[i])return}else e.emitted={};e.emitted[i]=!0,Rt(c,e,6,o)}}function Wt(e,t,s=!1){const a=t.emitsCache,o=a.get(e);if(void 0!==o)return o;const n=e.emits;let r={},i=!1;if(!rt(e)){const a=e=>{const s=Wt(e,t,!0);s&&(i=!0,Je(r,s))};!s&&t.mixins.length&&t.mixins.forEach(a),e.extends&&a(e.extends),e.mixins&&e.mixins.forEach(a)}return n||i?(at(n)?n.forEach(e=>r[e]=null):Je(r,n),a.set(e,r),r):(a.set(e,null),null)}function Qt(e,t){return!(!e||!We(t))&&(t=t.slice(2).replace(/Once$/,""),st(e,t[0].toLowerCase()+t.slice(1))||st(e,vt(t))||st(e,t))}let Jt=null,es=null;function ts(e){const t=Jt;return Jt=e,es=e&&e.type.__scopeId||null,t}function ss(e,t=Jt,s){if(!t)return e;if(e._n)return e;const a=(...s)=>{a._d&&Fa(-1);const o=ts(t),n=e(...s);return ts(o),a._d&&Fa(1),n};return a._n=!0,a._c=!0,a._d=!0,a}function as(e){const{type:t,vnode:s,proxy:a,withProxy:o,props:n,propsOptions:[r],slots:i,attrs:l,emit:c,render:d,renderCache:u,data:m,setupState:p,ctx:h,inheritAttrs:f}=e;let g,_;const v=ts(e);try{if(4&s.shapeFlag){const e=o||a;g=eo(d.call(e,e,u,n,p,m,h)),_=l}else{const e=t;0,g=eo(e.length>1?e(n,{attrs:l,slots:i,emit:c}):e(n,null)),_=t.props?l:os(l)}}catch(t){La.length=0,Tt(t,e,1),g=Ga(ja)}let b=g;if(_&&!1!==f){const e=Object.keys(_),{shapeFlag:t}=b;e.length&&7&t&&(r&&e.some(Qe)&&(_=ns(_,r)),b=Wa(b,_))}return s.dirs&&(b=Wa(b),b.dirs=b.dirs?b.dirs.concat(s.dirs):s.dirs),s.transition&&(b.transition=s.transition),g=b,ts(v),g}const os=e=>{let t;for(const s in e)("class"===s||"style"===s||We(s))&&((t||(t={}))[s]=e[s]);return t},ns=(e,t)=>{const s={};for(const a in e)Qe(a)&&a.slice(9)in t||(s[a]=e[a]);return s};function rs(e,t,s){const a=Object.keys(t);if(a.length!==Object.keys(e).length)return!0;for(let o=0;o<a.length;o++){const n=a[o];if(t[n]!==e[n]&&!Qt(s,n))return!0}return!1}function is(e,t,s=!1){const a=io||Jt;if(a){const o=null==a.parent?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides;if(o&&e in o)return o[e];if(arguments.length>1)return s&&rt(t)?t.call(a.proxy):t}}const ls={};function cs(e,t,s){return ds(e,t,s)}function ds(e,t,{immediate:s,deep:a,flush:o,onTrack:n,onTrigger:r}=Xe){const i=io;let l,c,d=!1,u=!1;if(je(e)?(l=()=>e.value,d=Re(e)):Me(e)?(l=()=>e,a=!0):at(e)?(u=!0,d=e.some(e=>Me(e)||Re(e)),l=()=>e.map(e=>je(e)?e.value:Me(e)?ps(e):rt(e)?At(e,i,2):void 0)):l=rt(e)?t?()=>At(e,i,2):()=>{if(!i||!i.isUnmounted)return c&&c(),Rt(e,i,3,[m])}:Ke,t&&a){const e=l;l=()=>ps(e())}let m=e=>{c=g.onStop=()=>{At(e,i,4)}};if(po)return m=Ke,t?s&&Rt(t,i,3,[l(),u?[]:void 0,m]):l(),Ke;let p=u?[]:ls;const h=()=>{if(g.active)if(t){const e=g.run();(a||d||(u?e.some((e,t)=>xt(e,p[t])):xt(e,p)))&&(c&&c(),Rt(t,i,3,[e,p===ls?void 0:p,m]),p=e)}else g.run()};let f;h.allowRecurse=!!t,f="sync"===o?h:"post"===o?()=>Ta(h,i&&i.suspense):()=>function(e){zt(e,It,jt,Lt)}(h);const g=new R(l,f);return t?s?h():p=g.run():"post"===o?Ta(g.run.bind(g),i&&i.suspense):g.run(),()=>{g.stop(),i&&i.scope&&et(i.scope.effects,g)}}function us(e,t,s){const a=this.proxy,o=it(e)?e.includes(".")?ms(a,e):()=>a[e]:e.bind(a,a);let n;rt(t)?n=t:(n=t.handler,s=t);const r=io;co(this);const i=ds(o,n.bind(a),s);return r?co(r):uo(),i}function ms(e,t){const s=t.split(".");return()=>{let t=e;for(let e=0;e<s.length&&t;e++)t=t[s[e]];return t}}function ps(e,t){if(!lt(e)||e.__v_skip)return e;if((t=t||new Set).has(e))return e;if(t.add(e),je(e))ps(e.value,t);else if(at(e))for(let s=0;s<e.length;s++)ps(e[s],t);else if(nt(e)||ot(e))e.forEach(e=>{ps(e,t)});else if(mt(e))for(const s in e)ps(e[s],t);return e}function hs(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Cs(()=>{e.isMounted=!0}),Ls(()=>{e.isUnmounting=!0}),e}const fs=[Function,Array],gs={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:fs,onEnter:fs,onAfterEnter:fs,onEnterCancelled:fs,onBeforeLeave:fs,onLeave:fs,onAfterLeave:fs,onLeaveCancelled:fs,onBeforeAppear:fs,onAppear:fs,onAfterAppear:fs,onAppearCancelled:fs},setup(e,{slots:t}){const s=lo(),a=hs();let o;return()=>{const n=t.default&&ws(t.default(),!0);if(!n||!n.length)return;let r=n[0];if(n.length>1)for(const e of n)if(e.type!==ja){r=e;break}const i=Ee(e),{mode:l}=i;if(a.isLeaving)return bs(r);const c=ys(r);if(!c)return bs(r);const d=vs(c,i,a,s);xs(c,d);const u=s.subTree,m=u&&ys(u);let p=!1;const{getTransitionKey:h}=c.type;if(h){const e=h();void 0===o?o=e:e!==o&&(o=e,p=!0)}if(m&&m.type!==ja&&(!Va(c,m)||p)){const e=vs(m,i,a,s);if(xs(m,e),"out-in"===l)return a.isLeaving=!0,e.afterLeave=()=>{a.isLeaving=!1,s.update()},bs(r);"in-out"===l&&c.type!==ja&&(e.delayLeave=(e,t,s)=>{_s(a,m)[String(m.key)]=m,e._leaveCb=()=>{t(),e._leaveCb=void 0,delete d.delayedLeave},d.delayedLeave=s})}return r}}};function _s(e,t){const{leavingVNodes:s}=e;let a=s.get(t.type);return a||(a=Object.create(null),s.set(t.type,a)),a}function vs(e,t,s,a){const{appear:o,mode:n,persisted:r=!1,onBeforeEnter:i,onEnter:l,onAfterEnter:c,onEnterCancelled:d,onBeforeLeave:u,onLeave:m,onAfterLeave:p,onLeaveCancelled:h,onBeforeAppear:f,onAppear:g,onAfterAppear:_,onAppearCancelled:v}=t,b=String(e.key),y=_s(s,e),x=(e,t)=>{e&&Rt(e,a,9,t)},w=(e,t)=>{const s=t[1];x(e,t),at(e)?e.every(e=>e.length<=1)&&s():e.length<=1&&s()},k={mode:n,persisted:r,beforeEnter(t){let a=i;if(!s.isMounted){if(!o)return;a=f||i}t._leaveCb&&t._leaveCb(!0);const n=y[b];n&&Va(e,n)&&n.el._leaveCb&&n.el._leaveCb(),x(a,[t])},enter(e){let t=l,a=c,n=d;if(!s.isMounted){if(!o)return;t=g||l,a=_||c,n=v||d}let r=!1;const i=e._enterCb=t=>{r||(r=!0,x(t?n:a,[e]),k.delayedLeave&&k.delayedLeave(),e._enterCb=void 0)};t?w(t,[e,i]):i()},leave(t,a){const o=String(e.key);if(t._enterCb&&t._enterCb(!0),s.isUnmounting)return a();x(u,[t]);let n=!1;const r=t._leaveCb=s=>{n||(n=!0,a(),x(s?h:p,[t]),t._leaveCb=void 0,y[o]===e&&delete y[o])};y[o]=e,m?w(m,[t,r]):r()},clone:e=>vs(e,t,s,a)};return k}function bs(e){if(Ss(e))return(e=Wa(e)).children=null,e}function ys(e){return Ss(e)?e.children?e.children[0]:void 0:e}function xs(e,t){6&e.shapeFlag&&e.component?xs(e.component.subTree,t):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function ws(e,t=!1,s){let a=[],o=0;for(let n=0;n<e.length;n++){let r=e[n];const i=null==s?r.key:String(s)+String(null!=r.key?r.key:n);r.type===Oa?(128&r.patchFlag&&o++,a=a.concat(ws(r.children,t,i))):(t||r.type!==ja)&&a.push(null!=i?Wa(r,{key:i}):r)}if(o>1)for(let e=0;e<a.length;e++)a[e].patchFlag=-2;return a}const ks=e=>!!e.type.__asyncLoader,Ss=e=>e.type.__isKeepAlive;function Ms(e,t){Rs(e,"a",t)}function As(e,t){Rs(e,"da",t)}function Rs(e,t,s=io){const a=e.__wdc||(e.__wdc=()=>{let t=s;for(;t;){if(t.isDeactivated)return;t=t.parent}return e()});if(Es(t,a,s),s){let e=s.parent;for(;e&&e.parent;)Ss(e.parent.vnode)&&Ts(a,t,s,e),e=e.parent}}function Ts(e,t,s,a){const o=Es(t,e,a,!0);Ps(()=>{et(a[t],o)},s)}function Es(e,t,s=io,a=!1){if(s){const o=s[e]||(s[e]=[]),n=t.__weh||(t.__weh=(...a)=>{if(s.isUnmounted)return;O(),co(s);const o=Rt(t,s,e,a);return uo(),C(),o});return a?o.unshift(n):o.push(n),n}}const Bs=e=>(t,s=io)=>(!po||"sp"===e)&&Es(e,t,s),Os=Bs("bm"),Cs=Bs("m"),js=Bs("bu"),Is=Bs("u"),Ls=Bs("bum"),Ps=Bs("um"),Ns=Bs("sp"),Hs=Bs("rtg"),Fs=Bs("rtc");function Ds(e,t=io){Es("ec",e,t)}function $s(e,t){const s=Jt;if(null===s)return e;const a=go(s)||s.proxy,o=e.dirs||(e.dirs=[]);for(let e=0;e<t.length;e++){let[s,n,r,i=Xe]=t[e];rt(s)&&(s={mounted:s,updated:s}),s.deep&&ps(n),o.push({dir:s,instance:a,value:n,oldValue:void 0,arg:r,modifiers:i})}return e}function Us(e,t,s,a){const o=e.dirs,n=t&&t.dirs;for(let r=0;r<o.length;r++){const i=o[r];n&&(i.oldValue=n[r].value);let l=i.dir[a];l&&(O(),Rt(l,s,8,[e.el,i,e,t]),C())}}function qs(e,t){return Xs("components",e,!0,t)||e}const Vs=Symbol();function zs(e){return Xs("directives",e)}function Xs(e,t,s=!0,a=!1){const o=Jt||io;if(o){const s=o.type;if("components"===e){const e=function(e,t=!0){return rt(e)?e.displayName||e.name:e.name||t&&e.__name}(s,!1);if(e&&(e===t||e===gt(t)||e===bt(gt(t))))return s}const n=Ys(o[e]||s[e],t)||Ys(o.appContext[e],t);return!n&&a?s:n}}function Ys(e,t){return e&&(e[t]||e[gt(t)]||e[bt(gt(t))])}function Ks(e,t,s,a){let o;const n=s&&s[a];if(at(e)||it(e)){o=new Array(e.length);for(let s=0,a=e.length;s<a;s++)o[s]=t(e[s],s,void 0,n&&n[s])}else if("number"==typeof e){o=new Array(e);for(let s=0;s<e;s++)o[s]=t(s+1,s,void 0,n&&n[s])}else if(lt(e))if(e[Symbol.iterator])o=Array.from(e,(e,s)=>t(e,s,void 0,n&&n[s]));else{const s=Object.keys(e);o=new Array(s.length);for(let a=0,r=s.length;a<r;a++){const r=s[a];o[a]=t(e[r],r,a,n&&n[a])}}else o=[];return s&&(s[a]=o),o}function Gs(e,t){for(let s=0;s<t.length;s++){const a=t[s];if(at(a))for(let t=0;t<a.length;t++)e[a[t].name]=a[t].fn;else a&&(e[a.name]=a.fn)}return e}function Zs(e,t,s={},a,o){if(Jt.isCE||Jt.parent&&ks(Jt.parent)&&Jt.parent.isCE)return Ga("slot","default"===t?null:{name:t},a&&a());let n=e[t];n&&n._c&&(n._d=!1),Na();const r=n&&function e(t){return t.some(t=>!qa(t)||t.type!==ja&&!(t.type===Oa&&!e(t.children)))?t:null}(n(s)),i=Ua(Oa,{key:s.key||"_"+t},r||(a?a():[]),r&&1===e._?64:-2);return!o&&i.scopeId&&(i.slotScopeIds=[i.scopeId+"-s"]),n&&n._c&&(n._d=!0),i}const Ws=e=>e?mo(e)?go(e)||e.proxy:Ws(e.parent):null,Qs=Je(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Ws(e.parent),$root:e=>Ws(e.root),$emit:e=>e.emit,$options:e=>oa(e),$forceUpdate:e=>e.f||(e.f=()=>qt(e.update)),$nextTick:e=>e.n||(e.n=Ut.bind(e.proxy)),$watch:e=>us.bind(e)}),Js={get({_:e},t){const{ctx:s,setupState:a,data:o,props:n,accessCache:r,type:i,appContext:l}=e;let c;if("$"!==t[0]){const i=r[t];if(void 0!==i)switch(i){case 1:return a[t];case 2:return o[t];case 4:return s[t];case 3:return n[t]}else{if(a!==Xe&&st(a,t))return r[t]=1,a[t];if(o!==Xe&&st(o,t))return r[t]=2,o[t];if((c=e.propsOptions[0])&&st(c,t))return r[t]=3,n[t];if(s!==Xe&&st(s,t))return r[t]=4,s[t];ea&&(r[t]=0)}}const d=Qs[t];let u,m;return d?("$attrs"===t&&j(e,0,t),d(e)):(u=i.__cssModules)&&(u=u[t])?u:s!==Xe&&st(s,t)?(r[t]=4,s[t]):(m=l.config.globalProperties,st(m,t)?m[t]:void 0)},set({_:e},t,s){const{data:a,setupState:o,ctx:n}=e;return o!==Xe&&st(o,t)?(o[t]=s,!0):a!==Xe&&st(a,t)?(a[t]=s,!0):!st(e.props,t)&&(("$"!==t[0]||!(t.slice(1)in e))&&(n[t]=s,!0))},has({_:{data:e,setupState:t,accessCache:s,ctx:a,appContext:o,propsOptions:n}},r){let i;return!!s[r]||e!==Xe&&st(e,r)||t!==Xe&&st(t,r)||(i=n[0])&&st(i,r)||st(a,r)||st(Qs,r)||st(o.config.globalProperties,r)},defineProperty(e,t,s){return null!=s.get?e._.accessCache[t]=0:st(s,"value")&&this.set(e,t,s.value,null),Reflect.defineProperty(e,t,s)}};let ea=!0;function ta(e){const t=oa(e),s=e.proxy,a=e.ctx;ea=!1,t.beforeCreate&&sa(t.beforeCreate,e,"bc");const{data:o,computed:n,methods:r,watch:i,provide:l,inject:c,created:d,beforeMount:u,mounted:m,beforeUpdate:p,updated:h,activated:f,deactivated:g,beforeDestroy:_,beforeUnmount:v,destroyed:b,unmounted:y,render:x,renderTracked:w,renderTriggered:k,errorCaptured:S,serverPrefetch:M,expose:A,inheritAttrs:R,components:T,directives:E,filters:B}=t;if(c&&function(e,t,s=Ke,a=!1){at(e)&&(e=la(e));for(const s in e){const o=e[s];let n;n=lt(o)?"default"in o?is(o.from||s,o.default,!0):is(o.from||s):is(o),je(n)&&a?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>n.value,set:e=>n.value=e}):t[s]=n}}(c,a,null,e.appContext.config.unwrapInjectedRef),r)for(const e in r){const t=r[e];rt(t)&&(a[e]=t.bind(s))}if(o){const t=o.call(s,s);lt(t)&&(e.data=we(t))}if(ea=!0,n)for(const e in n){const t=n[e],o=rt(t)?t.bind(s,s):rt(t.get)?t.get.bind(s,s):Ke,r=!rt(t)&&rt(t.set)?t.set.bind(s):Ke,i=_o({get:o,set:r});Object.defineProperty(a,e,{enumerable:!0,configurable:!0,get:()=>i.value,set:e=>i.value=e})}if(i)for(const e in i)aa(i[e],a,s,e);if(l){const e=rt(l)?l.call(s):l;Reflect.ownKeys(e).forEach(t=>{!function(e,t){if(io){let s=io.provides;const a=io.parent&&io.parent.provides;a===s&&(s=io.provides=Object.create(a)),s[e]=t}else;}(t,e[t])})}function O(e,t){at(t)?t.forEach(t=>e(t.bind(s))):t&&e(t.bind(s))}if(d&&sa(d,e,"c"),O(Os,u),O(Cs,m),O(js,p),O(Is,h),O(Ms,f),O(As,g),O(Ds,S),O(Fs,w),O(Hs,k),O(Ls,v),O(Ps,y),O(Ns,M),at(A))if(A.length){const t=e.exposed||(e.exposed={});A.forEach(e=>{Object.defineProperty(t,e,{get:()=>s[e],set:t=>s[e]=t})})}else e.exposed||(e.exposed={});x&&e.render===Ke&&(e.render=x),null!=R&&(e.inheritAttrs=R),T&&(e.components=T),E&&(e.directives=E)}function sa(e,t,s){Rt(at(e)?e.map(e=>e.bind(t.proxy)):e.bind(t.proxy),t,s)}function aa(e,t,s,a){const o=a.includes(".")?ms(s,a):()=>s[a];if(it(e)){const s=t[e];rt(s)&&cs(o,s)}else if(rt(e))cs(o,e.bind(s));else if(lt(e))if(at(e))e.forEach(e=>aa(e,t,s,a));else{const a=rt(e.handler)?e.handler.bind(s):t[e.handler];rt(a)&&cs(o,a,e)}}function oa(e){const t=e.type,{mixins:s,extends:a}=t,{mixins:o,optionsCache:n,config:{optionMergeStrategies:r}}=e.appContext,i=n.get(t);let l;return i?l=i:o.length||s||a?(l={},o.length&&o.forEach(e=>na(l,e,r,!0)),na(l,t,r)):l=t,n.set(t,l),l}function na(e,t,s,a=!1){const{mixins:o,extends:n}=t;n&&na(e,n,s,!0),o&&o.forEach(t=>na(e,t,s,!0));for(const o in t)if(a&&"expose"===o);else{const a=ra[o]||s&&s[o];e[o]=a?a(e[o],t[o]):t[o]}return e}const ra={data:ia,props:da,emits:da,methods:da,computed:da,beforeCreate:ca,created:ca,beforeMount:ca,mounted:ca,beforeUpdate:ca,updated:ca,beforeDestroy:ca,beforeUnmount:ca,destroyed:ca,unmounted:ca,activated:ca,deactivated:ca,errorCaptured:ca,serverPrefetch:ca,components:da,directives:da,watch:function(e,t){if(!e)return t;if(!t)return e;const s=Je(Object.create(null),e);for(const a in t)s[a]=ca(e[a],t[a]);return s},provide:ia,inject:function(e,t){return da(la(e),la(t))}};function ia(e,t){return t?e?function(){return Je(rt(e)?e.call(this,this):e,rt(t)?t.call(this,this):t)}:t:e}function la(e){if(at(e)){const t={};for(let s=0;s<e.length;s++)t[e[s]]=e[s];return t}return e}function ca(e,t){return e?[...new Set([].concat(e,t))]:t}function da(e,t){return e?Je(Je(Object.create(null),e),t):t}function ua(e,t,s,a=!1){const o={},n={};kt(n,za,1),e.propsDefaults=Object.create(null),ma(e,t,o,n);for(const t in e.propsOptions[0])t in o||(o[t]=void 0);s?e.props=a?o:Se(o,!1,G,fe,ve):e.type.props?e.props=o:e.props=n,e.attrs=n}function ma(e,t,s,a){const[o,n]=e.propsOptions;let r,i=!1;if(t)for(let l in t){if(pt(l))continue;const c=t[l];let d;o&&st(o,d=gt(l))?n&&n.includes(d)?(r||(r={}))[d]=c:s[d]=c:Qt(e.emitsOptions,l)||l in a&&c===a[l]||(a[l]=c,i=!0)}if(n){const t=Ee(s),a=r||Xe;for(let r=0;r<n.length;r++){const i=n[r];s[i]=pa(o,t,i,a[i],e,!st(a,i))}}return i}function pa(e,t,s,a,o,n){const r=e[s];if(null!=r){const e=st(r,"default");if(e&&void 0===a){const e=r.default;if(r.type!==Function&&rt(e)){const{propsDefaults:n}=o;s in n?a=n[s]:(co(o),a=n[s]=e.call(null,t),uo())}else a=e}r[0]&&(n&&!e?a=!1:!r[1]||""!==a&&a!==vt(s)||(a=!0))}return a}function ha(e,t,s=!1){const a=t.propsCache,o=a.get(e);if(o)return o;const n=e.props,r={},i=[];let l=!1;if(!rt(e)){const a=e=>{l=!0;const[s,a]=ha(e,t,!0);Je(r,s),a&&i.push(...a)};!s&&t.mixins.length&&t.mixins.forEach(a),e.extends&&a(e.extends),e.mixins&&e.mixins.forEach(a)}if(!n&&!l)return a.set(e,Ye),Ye;if(at(n))for(let e=0;e<n.length;e++){const t=gt(n[e]);fa(t)&&(r[t]=Xe)}else if(n)for(const e in n){const t=gt(e);if(fa(t)){const s=n[e],a=r[t]=at(s)||rt(s)?{type:s}:s;if(a){const e=va(Boolean,a.type),s=va(String,a.type);a[0]=e>-1,a[1]=s<0||e<s,(e>-1||st(a,"default"))&&i.push(t)}}}const c=[r,i];return a.set(e,c),c}function fa(e){return"$"!==e[0]}function ga(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:null===e?"null":""}function _a(e,t){return ga(e)===ga(t)}function va(e,t){return at(t)?t.findIndex(t=>_a(t,e)):rt(t)&&_a(t,e)?0:-1}const ba=e=>"_"===e[0]||"$stable"===e,ya=e=>at(e)?e.map(eo):[eo(e)],xa=(e,t,s)=>{if(t._n)return t;const a=ss((...e)=>ya(t(...e)),s);return a._c=!1,a},wa=(e,t,s)=>{const a=e._ctx;for(const s in e){if(ba(s))continue;const o=e[s];if(rt(o))t[s]=xa(0,o,a);else if(null!=o){const e=ya(o);t[s]=()=>e}}},ka=(e,t)=>{const s=ya(t);e.slots.default=()=>s};function Sa(){return{app:null,config:{isNativeTag:Ge,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ma=0;function Aa(e,t){return function(s,a=null){rt(s)||(s=Object.assign({},s)),null==a||lt(a)||(a=null);const o=Sa(),n=new Set;let r=!1;const i=o.app={_uid:Ma++,_component:s,_props:a,_container:null,_context:o,_instance:null,version:vo,get config(){return o.config},set config(e){},use:(e,...t)=>(n.has(e)||(e&&rt(e.install)?(n.add(e),e.install(i,...t)):rt(e)&&(n.add(e),e(i,...t))),i),mixin:e=>(o.mixins.includes(e)||o.mixins.push(e),i),component:(e,t)=>t?(o.components[e]=t,i):o.components[e],directive:(e,t)=>t?(o.directives[e]=t,i):o.directives[e],mount(n,l,c){if(!r){const d=Ga(s,a);return d.appContext=o,l&&t?t(d,n):e(d,n,c),r=!0,i._container=n,n.__vue_app__=i,go(d.component)||d.component.proxy}},unmount(){r&&(e(null,i._container),delete i._container.__vue_app__)},provide:(e,t)=>(o.provides[e]=t,i)};return i}}function Ra(e,t,s,a,o=!1){if(at(e))return void e.forEach((e,n)=>Ra(e,t&&(at(t)?t[n]:t),s,a,o));if(ks(a)&&!o)return;const n=4&a.shapeFlag?go(a.component)||a.component.proxy:a.el,r=o?null:n,{i:i,r:l}=e,c=t&&t.r,d=i.refs===Xe?i.refs={}:i.refs,u=i.setupState;if(null!=c&&c!==l&&(it(c)?(d[c]=null,st(u,c)&&(u[c]=null)):je(c)&&(c.value=null)),rt(l))At(l,i,12,[r,d]);else{const t=it(l),a=je(l);if(t||a){const i=()=>{if(e.f){const s=t?d[l]:l.value;o?at(s)&&et(s,n):at(s)?s.includes(n)||s.push(n):t?(d[l]=[n],st(u,l)&&(u[l]=d[l])):(l.value=[n],e.k&&(d[e.k]=l.value))}else t?(d[l]=r,st(u,l)&&(u[l]=r)):a&&(l.value=r,e.k&&(d[e.k]=r))};r?(i.id=-1,Ta(i,s)):i()}}}const Ta=function(e,t){t&&t.pendingBranch?at(e)?t.effects.push(...e):t.effects.push(e):zt(e,Nt,Pt,Ht)};function Ea(e){return function(e,t){(Mt||(Mt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})).__VUE__=!0;const{insert:s,remove:a,patchProp:o,createElement:n,createText:r,createComment:i,setText:l,setElementText:c,parentNode:d,nextSibling:u,setScopeId:m=Ke,cloneNode:p,insertStaticContent:h}=e,f=(e,t,s,a=null,o=null,n=null,r=!1,i=null,l=!!t.dynamicChildren)=>{if(e===t)return;e&&!Va(e,t)&&(a=Y(e),U(e,o,n,!0),e=null),-2===t.patchFlag&&(l=!1,t.dynamicChildren=null);const{type:c,ref:d,shapeFlag:u}=t;switch(c){case Ca:g(e,t,s,a);break;case ja:v(e,t,s,a);break;case Ia:null==e&&b(t,s,a,r);break;case Oa:T(e,t,s,a,o,n,r,i,l);break;default:1&u?y(e,t,s,a,o,n,r,i,l):6&u?E(e,t,s,a,o,n,r,i,l):(64&u||128&u)&&c.process(e,t,s,a,o,n,r,i,l,G)}null!=d&&o&&Ra(d,e&&e.ref,n,t||e,!t)},g=(e,t,a,o)=>{if(null==e)s(t.el=r(t.children),a,o);else{const s=t.el=e.el;t.children!==e.children&&l(s,t.children)}},v=(e,t,a,o)=>{null==e?s(t.el=i(t.children||""),a,o):t.el=e.el},b=(e,t,s,a)=>{[e.el,e.anchor]=h(e.children,t,s,a,e.el,e.anchor)},y=(e,t,s,a,o,n,r,i,l)=>{r=r||"svg"===t.type,null==e?x(t,s,a,o,n,r,i,l):S(e,t,o,n,r,i,l)},x=(e,t,a,r,i,l,d,u)=>{let m,h;const{type:f,props:g,shapeFlag:_,transition:v,patchFlag:b,dirs:y}=e;if(e.el&&void 0!==p&&-1===b)m=e.el=p(e.el);else{if(m=e.el=n(e.type,l,g&&g.is,g),8&_?c(m,e.children):16&_&&k(e.children,m,null,r,i,l&&"foreignObject"!==f,d,u),y&&Us(e,null,r,"created"),g){for(const t in g)"value"===t||pt(t)||o(m,t,null,g[t],l,e.children,r,i,X);"value"in g&&o(m,"value",null,g.value),(h=g.onVnodeBeforeMount)&&oo(h,r,e)}w(m,e,e.scopeId,d,r)}y&&Us(e,null,r,"beforeMount");const x=(!i||i&&!i.pendingBranch)&&v&&!v.persisted;x&&v.beforeEnter(m),s(m,t,a),((h=g&&g.onVnodeMounted)||x||y)&&Ta(()=>{h&&oo(h,r,e),x&&v.enter(m),y&&Us(e,null,r,"mounted")},i)},w=(e,t,s,a,o)=>{if(s&&m(e,s),a)for(let t=0;t<a.length;t++)m(e,a[t]);if(o){if(t===o.subTree){const t=o.vnode;w(e,t,t.scopeId,t.slotScopeIds,o.parent)}}},k=(e,t,s,a,o,n,r,i,l=0)=>{for(let c=l;c<e.length;c++){const l=e[c]=i?to(e[c]):eo(e[c]);f(null,l,t,s,a,o,n,r,i)}},S=(e,t,s,a,n,r,i)=>{const l=t.el=e.el;let{patchFlag:d,dynamicChildren:u,dirs:m}=t;d|=16&e.patchFlag;const p=e.props||Xe,h=t.props||Xe;let f;s&&Ba(s,!1),(f=h.onVnodeBeforeUpdate)&&oo(f,s,t,e),m&&Us(t,e,s,"beforeUpdate"),s&&Ba(s,!0);const g=n&&"foreignObject"!==t.type;if(u?M(e.dynamicChildren,u,l,s,a,g,r):i||H(e,t,l,null,s,a,g,r,!1),d>0){if(16&d)A(l,t,p,h,s,a,n);else if(2&d&&p.class!==h.class&&o(l,"class",null,h.class,n),4&d&&o(l,"style",p.style,h.style,n),8&d){const r=t.dynamicProps;for(let t=0;t<r.length;t++){const i=r[t],c=p[i],d=h[i];d===c&&"value"!==i||o(l,i,c,d,n,e.children,s,a,X)}}1&d&&e.children!==t.children&&c(l,t.children)}else i||null!=u||A(l,t,p,h,s,a,n);((f=h.onVnodeUpdated)||m)&&Ta(()=>{f&&oo(f,s,t,e),m&&Us(t,e,s,"updated")},a)},M=(e,t,s,a,o,n,r)=>{for(let i=0;i<t.length;i++){const l=e[i],c=t[i],u=l.el&&(l.type===Oa||!Va(l,c)||70&l.shapeFlag)?d(l.el):s;f(l,c,u,null,a,o,n,r,!0)}},A=(e,t,s,a,n,r,i)=>{if(s!==a){for(const l in a){if(pt(l))continue;const c=a[l],d=s[l];c!==d&&"value"!==l&&o(e,l,d,c,i,t.children,n,r,X)}if(s!==Xe)for(const l in s)pt(l)||l in a||o(e,l,s[l],null,i,t.children,n,r,X);"value"in a&&o(e,"value",s.value,a.value)}},T=(e,t,a,o,n,i,l,c,d)=>{const u=t.el=e?e.el:r(""),m=t.anchor=e?e.anchor:r("");let{patchFlag:p,dynamicChildren:h,slotScopeIds:f}=t;f&&(c=c?c.concat(f):f),null==e?(s(u,a,o),s(m,a,o),k(t.children,a,m,n,i,l,c,d)):p>0&&64&p&&h&&e.dynamicChildren?(M(e.dynamicChildren,h,a,n,i,l,c),(null!=t.key||n&&t===n.subTree)&&function e(t,s,a=!1){const o=t.children,n=s.children;if(at(o)&&at(n))for(let t=0;t<o.length;t++){const s=o[t];let r=n[t];1&r.shapeFlag&&!r.dynamicChildren&&((r.patchFlag<=0||32===r.patchFlag)&&(r=n[t]=to(n[t]),r.el=s.el),a||e(s,r))}}(e,t,!0)):H(e,t,a,m,n,i,l,c,d)},E=(e,t,s,a,o,n,r,i,l)=>{t.slotScopeIds=i,null==e?512&t.shapeFlag?o.ctx.activate(t,s,a,r,l):B(t,s,a,o,n,r,l):I(e,t,l)},B=(e,t,s,a,o,n,r)=>{const i=e.component=function(e,t,s){const a=e.type,o=(t?t.appContext:e.appContext)||no,n={uid:ro++,vnode:e,type:a,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,scope:new _(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ha(a,o),emitsOptions:Wt(a,o),emit:null,emitted:null,propsDefaults:Xe,inheritAttrs:a.inheritAttrs,ctx:Xe,data:Xe,props:Xe,attrs:Xe,slots:Xe,refs:Xe,setupState:Xe,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};n.ctx={_:n},n.root=t?t.root:n,n.emit=Zt.bind(null,n),e.ce&&e.ce(n);return n}(e,a,o);if(Ss(e)&&(i.ctx.renderer=G),function(e,t=!1){po=t;const{props:s,children:a}=e.vnode,o=mo(e);ua(e,s,o,t),((e,t)=>{if(32&e.vnode.shapeFlag){const s=t._;s?(e.slots=Ee(t),kt(t,"_",s)):wa(t,e.slots={})}else e.slots={},t&&ka(e,t);kt(e.slots,za,1)})(e,a);const n=o?function(e,t){const s=e.type;e.accessCache=Object.create(null),e.proxy=Be(new Proxy(e.ctx,Js));const{setup:a}=s;if(a){const s=e.setupContext=a.length>1?function(e){const t=t=>{e.exposed=t||{}};let s;return{get attrs(){return s||(s=function(e){return new Proxy(e.attrs,{get:(t,s)=>(j(e,0,"$attrs"),t[s])})}(e))},slots:e.slots,emit:e.emit,expose:t}}(e):null;co(e),O();const o=At(a,e,0,[e.props,s]);if(C(),uo(),ct(o)){if(o.then(uo,uo),t)return o.then(s=>{ho(e,s,t)}).catch(t=>{Tt(t,e,0)});e.asyncDep=o}else ho(e,o,t)}else fo(e,t)}(e,t):void 0;po=!1}(i),i.asyncDep){if(o&&o.registerDep(i,P),!e.el){const e=i.subTree=Ga(ja);v(null,e,t,s)}}else P(i,e,t,s,o,n,r)},I=(e,t,s)=>{const a=t.component=e.component;if(function(e,t,s){const{props:a,children:o,component:n}=e,{props:r,children:i,patchFlag:l}=t,c=n.emitsOptions;if(t.dirs||t.transition)return!0;if(!(s&&l>=0))return!(!o&&!i||i&&i.$stable)||a!==r&&(a?!r||rs(a,r,c):!!r);if(1024&l)return!0;if(16&l)return a?rs(a,r,c):!!r;if(8&l){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const s=e[t];if(r[s]!==a[s]&&!Qt(c,s))return!0}}return!1}(e,t,s)){if(a.asyncDep&&!a.asyncResolved)return void N(a,t,s);a.next=t,function(e){const t=Ot.indexOf(e);t>Ct&&Ot.splice(t,1)}(a.update),a.update()}else t.el=e.el,a.vnode=t},P=(e,t,s,a,o,n,r)=>{const i=e.effect=new R(()=>{if(e.isMounted){let t,{next:s,bu:a,u:i,parent:l,vnode:c}=e,u=s;Ba(e,!1),s?(s.el=c.el,N(e,s,r)):s=c,a&&wt(a),(t=s.props&&s.props.onVnodeBeforeUpdate)&&oo(t,l,s,c),Ba(e,!0);const m=as(e),p=e.subTree;e.subTree=m,f(p,m,d(p.el),Y(p),e,o,n),s.el=m.el,null===u&&function({vnode:e,parent:t},s){for(;t&&t.subTree===e;)(e=t.vnode).el=s,t=t.parent}(e,m.el),i&&Ta(i,o),(t=s.props&&s.props.onVnodeUpdated)&&Ta(()=>oo(t,l,s,c),o)}else{let r;const{el:i,props:l}=t,{bm:c,m:d,parent:u}=e,m=ks(t);if(Ba(e,!1),c&&wt(c),!m&&(r=l&&l.onVnodeBeforeMount)&&oo(r,u,t),Ba(e,!0),i&&W){const s=()=>{e.subTree=as(e),W(i,e.subTree,e,o,null)};m?t.type.__asyncLoader().then(()=>!e.isUnmounted&&s()):s()}else{const r=e.subTree=as(e);f(null,r,s,a,e,o,n),t.el=r.el}if(d&&Ta(d,o),!m&&(r=l&&l.onVnodeMounted)){const e=t;Ta(()=>oo(r,u,e),o)}(256&t.shapeFlag||u&&ks(u.vnode)&&256&u.vnode.shapeFlag)&&e.a&&Ta(e.a,o),e.isMounted=!0,t=s=a=null}},()=>qt(l),e.scope),l=e.update=()=>i.run();l.id=e.uid,Ba(e,!0),l()},N=(e,t,s)=>{t.component=e;const a=e.vnode.props;e.vnode=t,e.next=null,function(e,t,s,a){const{props:o,attrs:n,vnode:{patchFlag:r}}=e,i=Ee(o),[l]=e.propsOptions;let c=!1;if(!(a||r>0)||16&r){let a;ma(e,t,o,n)&&(c=!0);for(const n in i)t&&(st(t,n)||(a=vt(n))!==n&&st(t,a))||(l?!s||void 0===s[n]&&void 0===s[a]||(o[n]=pa(l,i,n,void 0,e,!0)):delete o[n]);if(n!==i)for(const e in n)t&&st(t,e)||(delete n[e],c=!0)}else if(8&r){const s=e.vnode.dynamicProps;for(let a=0;a<s.length;a++){let r=s[a];if(Qt(e.emitsOptions,r))continue;const d=t[r];if(l)if(st(n,r))d!==n[r]&&(n[r]=d,c=!0);else{const t=gt(r);o[t]=pa(l,i,t,d,e,!1)}else d!==n[r]&&(n[r]=d,c=!0)}}c&&L(e,"set","$attrs")}(e,t.props,a,s),((e,t,s)=>{const{vnode:a,slots:o}=e;let n=!0,r=Xe;if(32&a.shapeFlag){const e=t._;e?s&&1===e?n=!1:(Je(o,t),s||1!==e||delete o._):(n=!t.$stable,wa(t,o)),r=t}else t&&(ka(e,t),r={default:1});if(n)for(const e in o)ba(e)||e in r||delete o[e]})(e,t.children,s),O(),Xt(void 0,e.update),C()},H=(e,t,s,a,o,n,r,i,l=!1)=>{const d=e&&e.children,u=e?e.shapeFlag:0,m=t.children,{patchFlag:p,shapeFlag:h}=t;if(p>0){if(128&p)return void D(d,m,s,a,o,n,r,i,l);if(256&p)return void F(d,m,s,a,o,n,r,i,l)}8&h?(16&u&&X(d,o,n),m!==d&&c(s,m)):16&u?16&h?D(d,m,s,a,o,n,r,i,l):X(d,o,n,!0):(8&u&&c(s,""),16&h&&k(m,s,a,o,n,r,i,l))},F=(e,t,s,a,o,n,r,i,l)=>{t=t||Ye;const c=(e=e||Ye).length,d=t.length,u=Math.min(c,d);let m;for(m=0;m<u;m++){const a=t[m]=l?to(t[m]):eo(t[m]);f(e[m],a,s,null,o,n,r,i,l)}c>d?X(e,o,n,!0,!1,u):k(t,s,a,o,n,r,i,l,u)},D=(e,t,s,a,o,n,r,i,l)=>{let c=0;const d=t.length;let u=e.length-1,m=d-1;for(;c<=u&&c<=m;){const a=e[c],d=t[c]=l?to(t[c]):eo(t[c]);if(!Va(a,d))break;f(a,d,s,null,o,n,r,i,l),c++}for(;c<=u&&c<=m;){const a=e[u],c=t[m]=l?to(t[m]):eo(t[m]);if(!Va(a,c))break;f(a,c,s,null,o,n,r,i,l),u--,m--}if(c>u){if(c<=m){const e=m+1,u=e<d?t[e].el:a;for(;c<=m;)f(null,t[c]=l?to(t[c]):eo(t[c]),s,u,o,n,r,i,l),c++}}else if(c>m)for(;c<=u;)U(e[c],o,n,!0),c++;else{const p=c,h=c,g=new Map;for(c=h;c<=m;c++){const e=t[c]=l?to(t[c]):eo(t[c]);null!=e.key&&g.set(e.key,c)}let _,v=0;const b=m-h+1;let y=!1,x=0;const w=new Array(b);for(c=0;c<b;c++)w[c]=0;for(c=p;c<=u;c++){const a=e[c];if(v>=b){U(a,o,n,!0);continue}let d;if(null!=a.key)d=g.get(a.key);else for(_=h;_<=m;_++)if(0===w[_-h]&&Va(a,t[_])){d=_;break}void 0===d?U(a,o,n,!0):(w[d-h]=c+1,d>=x?x=d:y=!0,f(a,t[d],s,null,o,n,r,i,l),v++)}const k=y?function(e){const t=e.slice(),s=[0];let a,o,n,r,i;const l=e.length;for(a=0;a<l;a++){const l=e[a];if(0!==l){if(o=s[s.length-1],e[o]<l){t[a]=o,s.push(a);continue}for(n=0,r=s.length-1;n<r;)i=n+r>>1,e[s[i]]<l?n=i+1:r=i;l<e[s[n]]&&(n>0&&(t[a]=s[n-1]),s[n]=a)}}n=s.length,r=s[n-1];for(;n-- >0;)s[n]=r,r=t[r];return s}(w):Ye;for(_=k.length-1,c=b-1;c>=0;c--){const e=h+c,u=t[e],m=e+1<d?t[e+1].el:a;0===w[c]?f(null,u,s,m,o,n,r,i,l):y&&(_<0||c!==k[_]?$(u,s,m,2):_--)}}},$=(e,t,a,o,n=null)=>{const{el:r,type:i,transition:l,children:c,shapeFlag:d}=e;if(6&d)return void $(e.component.subTree,t,a,o);if(128&d)return void e.suspense.move(t,a,o);if(64&d)return void i.move(e,t,a,G);if(i===Oa){s(r,t,a);for(let e=0;e<c.length;e++)$(c[e],t,a,o);return void s(e.anchor,t,a)}if(i===Ia)return void(({el:e,anchor:t},a,o)=>{let n;for(;e&&e!==t;)n=u(e),s(e,a,o),e=n;s(t,a,o)})(e,t,a);if(2!==o&&1&d&&l)if(0===o)l.beforeEnter(r),s(r,t,a),Ta(()=>l.enter(r),n);else{const{leave:e,delayLeave:o,afterLeave:n}=l,i=()=>s(r,t,a),c=()=>{e(r,()=>{i(),n&&n()})};o?o(r,i,c):c()}else s(r,t,a)},U=(e,t,s,a=!1,o=!1)=>{const{type:n,props:r,ref:i,children:l,dynamicChildren:c,shapeFlag:d,patchFlag:u,dirs:m}=e;if(null!=i&&Ra(i,null,s,e,!0),256&d)return void t.ctx.deactivate(e);const p=1&d&&m,h=!ks(e);let f;if(h&&(f=r&&r.onVnodeBeforeUnmount)&&oo(f,t,e),6&d)z(e.component,s,a);else{if(128&d)return void e.suspense.unmount(s,a);p&&Us(e,null,t,"beforeUnmount"),64&d?e.type.remove(e,t,s,o,G,a):c&&(n!==Oa||u>0&&64&u)?X(c,t,s,!1,!0):(n===Oa&&384&u||!o&&16&d)&&X(l,t,s),a&&q(e)}(h&&(f=r&&r.onVnodeUnmounted)||p)&&Ta(()=>{f&&oo(f,t,e),p&&Us(e,null,t,"unmounted")},s)},q=e=>{const{type:t,el:s,anchor:o,transition:n}=e;if(t===Oa)return void V(s,o);if(t===Ia)return void(({el:e,anchor:t})=>{let s;for(;e&&e!==t;)s=u(e),a(e),e=s;a(t)})(e);const r=()=>{a(s),n&&!n.persisted&&n.afterLeave&&n.afterLeave()};if(1&e.shapeFlag&&n&&!n.persisted){const{leave:t,delayLeave:a}=n,o=()=>t(s,r);a?a(e.el,r,o):o()}else r()},V=(e,t)=>{let s;for(;e!==t;)s=u(e),a(e),e=s;a(t)},z=(e,t,s)=>{const{bum:a,scope:o,update:n,subTree:r,um:i}=e;a&&wt(a),o.stop(),n&&(n.active=!1,U(r,e,t,s)),i&&Ta(i,t),Ta(()=>{e.isUnmounted=!0},t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},X=(e,t,s,a=!1,o=!1,n=0)=>{for(let r=n;r<e.length;r++)U(e[r],t,s,a,o)},Y=e=>6&e.shapeFlag?Y(e.component.subTree):128&e.shapeFlag?e.suspense.next():u(e.anchor||e.el),K=(e,t,s)=>{null==e?t._vnode&&U(t._vnode,null,null,!0):f(t._vnode||null,e,t,null,null,null,s),Yt(),t._vnode=e},G={p:f,um:U,m:$,r:q,mt:B,mc:k,pc:H,pbc:M,n:Y,o:e};let Z,W;t&&([Z,W]=t(G));return{render:K,hydrate:Z,createApp:Aa(K,Z)}}(e)}function Ba({effect:e,update:t},s){e.allowRecurse=t.allowRecurse=s}const Oa=Symbol(void 0),Ca=Symbol(void 0),ja=Symbol(void 0),Ia=Symbol(void 0),La=[];let Pa=null;function Na(e=!1){La.push(Pa=e?null:[])}let Ha=1;function Fa(e){Ha+=e}function Da(e){return e.dynamicChildren=Ha>0?Pa||Ye:null,La.pop(),Pa=La[La.length-1]||null,Ha>0&&Pa&&Pa.push(e),e}function $a(e,t,s,a,o,n){return Da(Ka(e,t,s,a,o,n,!0))}function Ua(e,t,s,a,o){return Da(Ga(e,t,s,a,o,!0))}function qa(e){return!!e&&!0===e.__v_isVNode}function Va(e,t){return e.type===t.type&&e.key===t.key}const za="__vInternal",Xa=({key:e})=>null!=e?e:null,Ya=({ref:e,ref_key:t,ref_for:s})=>null!=e?it(e)||je(e)||rt(e)?{i:Jt,r:e,k:t,f:!!s}:e:null;function Ka(e,t=null,s=null,a=0,o=null,n=(e===Oa?0:1),r=!1,i=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Xa(t),ref:t&&Ya(t),scopeId:es,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:n,patchFlag:a,dynamicProps:o,dynamicChildren:null,appContext:null};return i?(so(l,s),128&n&&e.normalize(l)):s&&(l.shapeFlag|=it(s)?8:16),Ha>0&&!r&&Pa&&(l.patchFlag>0||6&n)&&32!==l.patchFlag&&Pa.push(l),l}const Ga=function(e,t=null,s=null,a=0,o=null,n=!1){e&&e!==Vs||(e=ja);if(qa(e)){const a=Wa(e,t,!0);return s&&so(a,s),Ha>0&&!n&&Pa&&(6&a.shapeFlag?Pa[Pa.indexOf(e)]=a:Pa.push(a)),a.patchFlag|=-2,a}r=e,rt(r)&&"__vccOpts"in r&&(e=e.__vccOpts);var r;if(t){t=Za(t);let{class:e,style:s}=t;e&&!it(e)&&(t.class=Ue(e)),lt(s)&&(Te(s)&&!at(s)&&(s=Je({},s)),t.style=He(s))}const i=it(e)?1:(e=>e.__isSuspense)(e)?128:(e=>e.__isTeleport)(e)?64:lt(e)?4:rt(e)?2:0;return Ka(e,t,s,a,o,i,n,!0)};function Za(e){return e?Te(e)||za in e?Je({},e):e:null}function Wa(e,t,s=!1){const{props:a,ref:o,patchFlag:n,children:r}=e,i=t?ao(a||{},t):a;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:i,key:i&&Xa(i),ref:t&&t.ref?s&&o?at(o)?o.concat(Ya(t)):[o,Ya(t)]:Ya(t):o,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:r,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Oa?-1===n?16:16|n:n,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Wa(e.ssContent),ssFallback:e.ssFallback&&Wa(e.ssFallback),el:e.el,anchor:e.anchor}}function Qa(e=" ",t=0){return Ga(Ca,null,e,t)}function Ja(e="",t=!1){return t?(Na(),Ua(ja,null,e)):Ga(ja,null,e)}function eo(e){return null==e||"boolean"==typeof e?Ga(ja):at(e)?Ga(Oa,null,e.slice()):"object"==typeof e?to(e):Ga(Ca,null,String(e))}function to(e){return null===e.el||e.memo?e:Wa(e)}function so(e,t){let s=0;const{shapeFlag:a}=e;if(null==t)t=null;else if(at(t))s=16;else if("object"==typeof t){if(65&a){const s=t.default;return void(s&&(s._c&&(s._d=!1),so(e,s()),s._c&&(s._d=!0)))}{s=32;const a=t._;a||za in t?3===a&&Jt&&(1===Jt.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=Jt}}else rt(t)?(t={default:t,_ctx:Jt},s=32):(t=String(t),64&a?(s=16,t=[Qa(t)]):s=8);e.children=t,e.shapeFlag|=s}function ao(...e){const t={};for(let s=0;s<e.length;s++){const a=e[s];for(const e in a)if("class"===e)t.class!==a.class&&(t.class=Ue([t.class,a.class]));else if("style"===e)t.style=He([t.style,a.style]);else if(We(e)){const s=t[e],o=a[e];!o||s===o||at(s)&&s.includes(o)||(t[e]=s?[].concat(s,o):o)}else""!==e&&(t[e]=a[e])}return t}function oo(e,t,s,a=null){Rt(e,t,7,[s,a])}const no=Sa();let ro=0;let io=null;const lo=()=>io||Jt,co=e=>{io=e,e.scope.on()},uo=()=>{io&&io.scope.off(),io=null};function mo(e){return 4&e.vnode.shapeFlag}let po=!1;function ho(e,t,s){rt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:lt(t)&&(e.setupState=Le(t)),fo(e,s)}function fo(e,t,s){const a=e.type;e.render||(e.render=a.render||Ke),co(e),O(),ta(e),C(),uo()}function go(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Le(Be(e.exposed)),{get:(t,s)=>s in t?t[s]:s in Qs?Qs[s](e):void 0}))}const _o=(e,t)=>function(e,t,s=!1){let a,n;const r="function"==typeof e;return r?(a=e,n=o):(a=e.get,n=e.set),new Pe(a,n,r||!n,s)}(e,0,po);const vo="3.2.37";function bo(e,t){const s=Object.create(null),a=e.split(",");for(let e=0;e<a.length;e++)s[a[e]]=!0;return t?e=>!!s[e.toLowerCase()]:e=>!!s[e]}const yo=bo("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function xo(e){return!!e||""===e}const wo=/^on[^a-z]/,ko=Object.assign,So=Array.isArray,Mo=e=>"string"==typeof e,Ao=e=>{const t=Object.create(null);return s=>t[s]||(t[s]=e(s))},Ro=/-(\w)/g,To=Ao(e=>e.replace(Ro,(e,t)=>t?t.toUpperCase():"")),Eo=/\B([A-Z])/g,Bo=Ao(e=>e.replace(Eo,"-$1").toLowerCase()),Oo=Ao(e=>e.charAt(0).toUpperCase()+e.slice(1)),Co=e=>{const t=parseFloat(e);return isNaN(t)?e:t},jo="undefined"!=typeof document?document:null,Io=jo&&jo.createElement("template"),Lo={insert:(e,t,s)=>{t.insertBefore(e,s||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,s,a)=>{const o=t?jo.createElementNS("http://www.w3.org/2000/svg",e):jo.createElement(e,s?{is:s}:void 0);return"select"===e&&a&&null!=a.multiple&&o.setAttribute("multiple",a.multiple),o},createText:e=>jo.createTextNode(e),createComment:e=>jo.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>jo.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,s,a,o,n){const r=s?s.previousSibling:t.lastChild;if(o&&(o===n||o.nextSibling))for(;t.insertBefore(o.cloneNode(!0),s),o!==n&&(o=o.nextSibling););else{Io.innerHTML=a?`<svg>${e}</svg>`:e;const o=Io.content;if(a){const e=o.firstChild;for(;e.firstChild;)o.appendChild(e.firstChild);o.removeChild(e)}t.insertBefore(o,s)}return[r?r.nextSibling:t.firstChild,s?s.previousSibling:t.lastChild]}};const Po=/\s*!important$/;function No(e,t,s){if(So(s))s.forEach(s=>No(e,t,s));else if(null==s&&(s=""),t.startsWith("--"))e.setProperty(t,s);else{const a=function(e,t){const s=Fo[t];if(s)return s;let a=gt(t);if("filter"!==a&&a in e)return Fo[t]=a;a=Oo(a);for(let s=0;s<Ho.length;s++){const o=Ho[s]+a;if(o in e)return Fo[t]=o}return t}(e,t);Po.test(s)?e.setProperty(Bo(a),s.replace(Po,""),"important"):e[a]=s}}const Ho=["Webkit","Moz","ms"],Fo={};const Do="http://www.w3.org/1999/xlink";const[$o,Uo]=(()=>{let e=Date.now,t=!1;if("undefined"!=typeof window){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const s=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(s&&Number(s[1])<=53)}return[e,t]})();let qo=0;const Vo=Promise.resolve(),zo=()=>{qo=0};function Xo(e,t,s,a,o=null){const n=e._vei||(e._vei={}),r=n[t];if(a&&r)r.value=a;else{const[s,i]=function(e){let t;if(Yo.test(e)){let s;for(t={};s=e.match(Yo);)e=e.slice(0,e.length-s[0].length),t[s[0].toLowerCase()]=!0}return[Bo(e.slice(2)),t]}(t);if(a){!function(e,t,s,a){e.addEventListener(t,s,a)}(e,s,n[t]=function(e,t){const s=e=>{const a=e.timeStamp||$o();(Uo||a>=s.attached-1)&&Rt(function(e,t){if(So(t)){const s=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{s.call(e),e._stopped=!0},t.map(e=>t=>!t._stopped&&e&&e(t))}return t}(e,s.value),t,5,[e])};return s.value=e,s.attached=(()=>qo||(Vo.then(zo),qo=$o()))(),s}(a,o),i)}else r&&(!function(e,t,s,a){e.removeEventListener(t,s,a)}(e,s,r,i),n[t]=void 0)}}const Yo=/(?:Once|Passive|Capture)$/;const Ko=/^on[a-z]/;const Go="undefined"!=typeof HTMLElement?HTMLElement:class{};class Zo extends Go{constructor(e,t={},s){super(),this._def=e,this._props=t,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this.shadowRoot&&s?s(this._createVNode(),this.shadowRoot):this.attachShadow({mode:"open"})}connectedCallback(){this._connected=!0,this._instance||this._resolveDef()}disconnectedCallback(){this._connected=!1,Ut(()=>{this._connected||(En(null,this.shadowRoot),this._instance=null)})}_resolveDef(){if(this._resolved)return;this._resolved=!0;for(let e=0;e<this.attributes.length;e++)this._setAttr(this.attributes[e].name);new MutationObserver(e=>{for(const t of e)this._setAttr(t.attributeName)}).observe(this,{attributes:!0});const e=e=>{const{props:t,styles:s}=e,a=!So(t),o=t?a?Object.keys(t):t:[];let n;if(a)for(const e in this._props){const s=t[e];(s===Number||s&&s.type===Number)&&(this._props[e]=Co(this._props[e]),(n||(n=Object.create(null)))[e]=!0)}this._numberProps=n;for(const e of Object.keys(this))"_"!==e[0]&&this._setProp(e,this[e],!0,!1);for(const e of o.map(To))Object.defineProperty(this,e,{get(){return this._getProp(e)},set(t){this._setProp(e,t)}});this._applyStyles(s),this._update()},t=this._def.__asyncLoader;t?t().then(e):e(this._def)}_setAttr(e){let t=this.getAttribute(e);this._numberProps&&this._numberProps[e]&&(t=Co(t)),this._setProp(To(e),t,!1)}_getProp(e){return this._props[e]}_setProp(e,t,s=!0,a=!0){t!==this._props[e]&&(this._props[e]=t,a&&this._instance&&this._update(),s&&(!0===t?this.setAttribute(Bo(e),""):"string"==typeof t||"number"==typeof t?this.setAttribute(Bo(e),t+""):t||this.removeAttribute(Bo(e))))}_update(){En(this._createVNode(),this.shadowRoot)}_createVNode(){const e=Ga(this._def,ko({},this._props));return this._instance||(e.ce=e=>{this._instance=e,e.isCE=!0,e.emit=(e,...t)=>{this.dispatchEvent(new CustomEvent(e,{detail:t}))};let t=this;for(;t=t&&(t.parentNode||t.host);)if(t instanceof Zo){e.parent=t._instance;break}}),e}_applyStyles(e){e&&e.forEach(e=>{const t=document.createElement("style");t.textContent=e,this.shadowRoot.appendChild(t)})}}const Wo=(e,{slots:t})=>function(e,t,s){const a=arguments.length;return 2===a?lt(t)&&!at(t)?qa(t)?Ga(e,null,[t]):Ga(e,t):Ga(e,null,t):(a>3?s=Array.prototype.slice.call(arguments,2):3===a&&qa(s)&&(s=[s]),Ga(e,t,s))}(gs,sn(e),t);Wo.displayName="Transition";const Qo={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Jo=Wo.props=ko({},gs.props,Qo),en=(e,t=[])=>{So(e)?e.forEach(e=>e(...t)):e&&e(...t)},tn=e=>!!e&&(So(e)?e.some(e=>e.length>1):e.length>1);function sn(e){const t={};for(const s in e)s in Qo||(t[s]=e[s]);if(!1===e.css)return t;const{name:s="v",type:a,duration:o,enterFromClass:n=s+"-enter-from",enterActiveClass:r=s+"-enter-active",enterToClass:i=s+"-enter-to",appearFromClass:l=n,appearActiveClass:c=r,appearToClass:d=i,leaveFromClass:u=s+"-leave-from",leaveActiveClass:m=s+"-leave-active",leaveToClass:p=s+"-leave-to"}=e,h=function(e){if(null==e)return null;if(null!==(t=e)&&"object"==typeof t)return[an(e.enter),an(e.leave)];{const t=an(e);return[t,t]}var t}(o),f=h&&h[0],g=h&&h[1],{onBeforeEnter:_,onEnter:v,onEnterCancelled:b,onLeave:y,onLeaveCancelled:x,onBeforeAppear:w=_,onAppear:k=v,onAppearCancelled:S=b}=t,M=(e,t,s)=>{nn(e,t?d:i),nn(e,t?c:r),s&&s()},A=(e,t)=>{e._isLeaving=!1,nn(e,u),nn(e,p),nn(e,m),t&&t()},R=e=>(t,s)=>{const o=e?k:v,r=()=>M(t,e,s);en(o,[t,r]),rn(()=>{nn(t,e?l:n),on(t,e?d:i),tn(o)||cn(t,a,f,r)})};return ko(t,{onBeforeEnter(e){en(_,[e]),on(e,n),on(e,r)},onBeforeAppear(e){en(w,[e]),on(e,l),on(e,c)},onEnter:R(!1),onAppear:R(!0),onLeave(e,t){e._isLeaving=!0;const s=()=>A(e,t);on(e,u),pn(),on(e,m),rn(()=>{e._isLeaving&&(nn(e,u),on(e,p),tn(y)||cn(e,a,g,s))}),en(y,[e,s])},onEnterCancelled(e){M(e,!1),en(b,[e])},onAppearCancelled(e){M(e,!0),en(S,[e])},onLeaveCancelled(e){A(e),en(x,[e])}})}function an(e){return Co(e)}function on(e,t){t.split(/\s+/).forEach(t=>t&&e.classList.add(t)),(e._vtc||(e._vtc=new Set)).add(t)}function nn(e,t){t.split(/\s+/).forEach(t=>t&&e.classList.remove(t));const{_vtc:s}=e;s&&(s.delete(t),s.size||(e._vtc=void 0))}function rn(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let ln=0;function cn(e,t,s,a){const o=e._endId=++ln,n=()=>{o===e._endId&&a()};if(s)return setTimeout(n,s);const{type:r,timeout:i,propCount:l}=dn(e,t);if(!r)return a();const c=r+"end";let d=0;const u=()=>{e.removeEventListener(c,m),n()},m=t=>{t.target===e&&++d>=l&&u()};setTimeout(()=>{d<l&&u()},i+1),e.addEventListener(c,m)}function dn(e,t){const s=window.getComputedStyle(e),a=e=>(s[e]||"").split(", "),o=a("transitionDelay"),n=a("transitionDuration"),r=un(o,n),i=a("animationDelay"),l=a("animationDuration"),c=un(i,l);let d=null,u=0,m=0;"transition"===t?r>0&&(d="transition",u=r,m=n.length):"animation"===t?c>0&&(d="animation",u=c,m=l.length):(u=Math.max(r,c),d=u>0?r>c?"transition":"animation":null,m=d?"transition"===d?n.length:l.length:0);return{type:d,timeout:u,propCount:m,hasTransform:"transition"===d&&/\b(transform|all)(,|$)/.test(s.transitionProperty)}}function un(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((t,s)=>mn(t)+mn(e[s])))}function mn(e){return 1e3*Number(e.slice(0,-1).replace(",","."))}function pn(){return document.body.offsetHeight}const hn=new WeakMap,fn=new WeakMap,gn={name:"TransitionGroup",props:ko({},Jo,{tag:String,moveClass:String}),setup(e,{slots:t}){const s=lo(),a=hs();let o,n;return Is(()=>{if(!o.length)return;const t=e.moveClass||(e.name||"v")+"-move";if(!function(e,t,s){const a=e.cloneNode();e._vtc&&e._vtc.forEach(e=>{e.split(/\s+/).forEach(e=>e&&a.classList.remove(e))});s.split(/\s+/).forEach(e=>e&&a.classList.add(e)),a.style.display="none";const o=1===t.nodeType?t:t.parentNode;o.appendChild(a);const{hasTransform:n}=dn(a);return o.removeChild(a),n}(o[0].el,s.vnode.el,t))return;o.forEach(_n),o.forEach(vn);const a=o.filter(bn);pn(),a.forEach(e=>{const s=e.el,a=s.style;on(s,t),a.transform=a.webkitTransform=a.transitionDuration="";const o=s._moveCb=e=>{e&&e.target!==s||e&&!/transform$/.test(e.propertyName)||(s.removeEventListener("transitionend",o),s._moveCb=null,nn(s,t))};s.addEventListener("transitionend",o)})}),()=>{const r=Ee(e),i=sn(r);let l=r.tag||Oa;o=n,n=t.default?ws(t.default()):[];for(let e=0;e<n.length;e++){const t=n[e];null!=t.key&&xs(t,vs(t,i,a,s))}if(o)for(let e=0;e<o.length;e++){const t=o[e];xs(t,vs(t,i,a,s)),hn.set(t,t.el.getBoundingClientRect())}return Ga(l,null,n)}}};function _n(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function vn(e){fn.set(e,e.el.getBoundingClientRect())}function bn(e){const t=hn.get(e),s=fn.get(e),a=t.left-s.left,o=t.top-s.top;if(a||o){const t=e.el.style;return t.transform=t.webkitTransform=`translate(${a}px,${o}px)`,t.transitionDuration="0s",e}}const yn=["ctrl","shift","alt","meta"],xn={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&0!==e.button,middle:e=>"button"in e&&1!==e.button,right:e=>"button"in e&&2!==e.button,exact:(e,t)=>yn.some(s=>e[s+"Key"]&&!t.includes(s))},wn=(e,t)=>(s,...a)=>{for(let e=0;e<t.length;e++){const a=xn[t[e]];if(a&&a(s,t))return}return e(s,...a)},kn={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Sn=(e,t)=>s=>{if(!("key"in s))return;const a=Bo(s.key);return t.some(e=>e===a||kn[e]===a)?e(s):void 0},Mn={beforeMount(e,{value:t},{transition:s}){e._vod="none"===e.style.display?"":e.style.display,s&&t?s.beforeEnter(e):An(e,t)},mounted(e,{value:t},{transition:s}){s&&t&&s.enter(e)},updated(e,{value:t,oldValue:s},{transition:a}){!t!=!s&&(a?t?(a.beforeEnter(e),An(e,!0),a.enter(e)):a.leave(e,()=>{An(e,!1)}):An(e,t))},beforeUnmount(e,{value:t}){An(e,t)}};function An(e,t){e.style.display=t?e._vod:"none"}const Rn=ko({patchProp:(e,t,s,a,o=!1,n,r,i,l)=>{"class"===t?function(e,t,s){const a=e._vtc;a&&(t=(t?[t,...a]:[...a]).join(" ")),null==t?e.removeAttribute("class"):s?e.setAttribute("class",t):e.className=t}(e,a,o):"style"===t?function(e,t,s){const a=e.style,o=Mo(s);if(s&&!o){for(const e in s)No(a,e,s[e]);if(t&&!Mo(t))for(const e in t)null==s[e]&&No(a,e,"")}else{const n=a.display;o?t!==s&&(a.cssText=s):t&&e.removeAttribute("style"),"_vod"in e&&(a.display=n)}}(e,s,a):(e=>wo.test(e))(t)?(e=>e.startsWith("onUpdate:"))(t)||Xo(e,t,0,a,r):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):function(e,t,s,a){if(a)return"innerHTML"===t||"textContent"===t||!(!(t in e)||!Ko.test(t)||(o=s,"function"!=typeof o));var o;if("spellcheck"===t||"draggable"===t||"translate"===t)return!1;if("form"===t)return!1;if("list"===t&&"INPUT"===e.tagName)return!1;if("type"===t&&"TEXTAREA"===e.tagName)return!1;if(Ko.test(t)&&Mo(s))return!1;return t in e}(e,t,a,o))?function(e,t,s,a,o,n,r){if("innerHTML"===t||"textContent"===t)return a&&r(a,o,n),void(e[t]=null==s?"":s);if("value"===t&&"PROGRESS"!==e.tagName&&!e.tagName.includes("-")){e._value=s;const a=null==s?"":s;return e.value===a&&"OPTION"!==e.tagName||(e.value=a),void(null==s&&e.removeAttribute(t))}let i=!1;if(""===s||null==s){const a=typeof e[t];"boolean"===a?s=xo(s):null==s&&"string"===a?(s="",i=!0):"number"===a&&(s=0,i=!0)}try{e[t]=s}catch(e){}i&&e.removeAttribute(t)}(e,t,a,n,r,i,l):("true-value"===t?e._trueValue=a:"false-value"===t&&(e._falseValue=a),function(e,t,s,a,o){if(a&&t.startsWith("xlink:"))null==s?e.removeAttributeNS(Do,t.slice(6,t.length)):e.setAttributeNS(Do,t,s);else{const a=yo(t);null==s||a&&!xo(s)?e.removeAttribute(t):e.setAttribute(t,a?"":s)}}(e,t,a,o))}},Lo);let Tn;const En=(...e)=>{(Tn||(Tn=Ea(Rn))).render(...e)};var Bn=(e,t)=>{const s=e.__vccOpts||e;for(const[e,a]of t)s[e]=a;return s};const On={name:"AppLoader",props:{show:{type:Boolean,default:!1},infinite:{type:Boolean,default:!1},type:{type:String,required:!0},messageId:{type:String,default:""}}},Cn=Ka("div",{id:"vac-circle"},null,-1),jn=Ka("div",{id:"vac-circle"},null,-1),In=Ka("div",{id:"vac-circle"},null,-1),Ln=Ka("div",{id:"vac-circle"},null,-1),Pn=Ka("div",{id:"vac-circle"},null,-1),Nn=Ka("div",{id:"vac-circle"},null,-1);var Hn=Bn(On,[["render",function(e,t,s,a,o,n){return Na(),Ua(Wo,{name:"vac-fade-spinner",appear:""},{default:ss(()=>[s.show?(Na(),$a("div",{key:0,class:Ue(["vac-loader-wrapper",{"vac-container-center":!s.infinite,"vac-container-top":s.infinite}])},["rooms"===s.type?Zs(e.$slots,"spinner-icon-rooms",{key:0},()=>[Cn]):Ja("",!0),"infinite-rooms"===s.type?Zs(e.$slots,"spinner-icon-infinite-rooms",{key:1},()=>[jn]):Ja("",!0),"message-file"===s.type?Zs(e.$slots,"spinner-icon-message-file_"+s.messageId,{key:2},()=>[In]):Ja("",!0),"room-file"===s.type?Zs(e.$slots,"spinner-icon-room-file",{key:3},()=>[Ln]):Ja("",!0),"messages"===s.type?Zs(e.$slots,"spinner-icon-messages",{key:4},()=>[Pn]):Ja("",!0),"infinite-messages"===s.type?Zs(e.$slots,"spinner-icon-infinite-messages",{key:5},()=>[Nn]):Ja("",!0)],2)):Ja("",!0)]),_:3})}]]);const Fn=["viewBox"],Dn=["id","d"],$n=["id","d"];var Un=Bn({name:"SvgIcon",props:{name:{type:String,default:null},param:{type:String,default:null}},data:()=>({svgItem:{search:{path:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"},add:{path:"M17,13H13V17H11V13H7V11H11V7H13V11H17M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"},toggle:{path:"M5,13L9,17L7.6,18.42L1.18,12L7.6,5.58L9,7L5,11H21V13H5M21,6V8H11V6H21M21,16V18H11V16H21Z"},menu:{path:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"},close:{path:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z"},file:{path:"M14,17H7V15H14M17,13H7V11H17M17,9H7V7H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z"},paperclip:{path:"M16.5,6V17.5A4,4 0 0,1 12.5,21.5A4,4 0 0,1 8.5,17.5V5A2.5,2.5 0 0,1 11,2.5A2.5,2.5 0 0,1 13.5,5V15.5A1,1 0 0,1 12.5,16.5A1,1 0 0,1 11.5,15.5V6H10V15.5A2.5,2.5 0 0,0 12.5,18A2.5,2.5 0 0,0 15,15.5V5A4,4 0 0,0 11,1A4,4 0 0,0 7,5V17.5A5.5,5.5 0 0,0 12.5,23A5.5,5.5 0 0,0 18,17.5V6H16.5Z"},"close-outline":{path:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"},send:{path:"M2,21L23,12L2,3V10L17,12L2,14V21Z"},emoji:{path:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"},document:{path:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"},pencil:{path:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"},checkmark:{path:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"},"double-checkmark":{path:"M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"},eye:{path:"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"},dropdown:{path:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"},deleted:{path:"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12C4,13.85 4.63,15.55 5.68,16.91L16.91,5.68C15.55,4.63 13.85,4 12,4M12,20A8,8 0 0,0 20,12C20,10.15 19.37,8.45 18.32,7.09L7.09,18.32C8.45,19.37 10.15,20 12,20Z"},microphone:{size:"large",path:"M432.8,216.4v39.2c0,45.2-15.3,84.3-45.2,118.4c-29.8,33.2-67.3,52.8-111.6,57.9v40.9h78.4c5.1,0,10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6c0,5.1-1.7,10.2-6,13.6c-4.3,4.3-8.5,6-13.6,6H157.6c-5.1,0-10.2-1.7-13.6-6c-4.3-4.3-6-8.5-6-13.6c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6H236v-40.9c-44.3-5.1-81.8-23.9-111.6-57.9s-45.2-73.3-45.2-118.4v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6s10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6v39.2c0,37.5,13.6,70.7,40,97.1s59.6,40,97.1,40s70.7-13.6,97.1-40c26.4-26.4,40-59.6,40-97.1v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6c5.1,0,10.2,1.7,13.6,6C430.2,206.2,432.8,211.3,432.8,216.4z M353.5,98v157.6c0,27.3-9.4,50.3-29,69c-19.6,19.6-42.6,29-69,29s-50.3-9.4-69-29c-19.6-19.6-29-42.6-29-69V98c0-27.3,9.4-50.3,29-69c19.6-19.6,42.6-29,69-29s50.3,9.4,69,29C344.2,47.7,353.5,71.6,353.5,98z"},"audio-play":{size:"medium",path:"M43.331,21.237L7.233,0.397c-0.917-0.529-2.044-0.529-2.96,0c-0.916,0.528-1.48,1.505-1.48,2.563v41.684   c0,1.058,0.564,2.035,1.48,2.563c0.458,0.268,0.969,0.397,1.48,0.397c0.511,0,1.022-0.133,1.48-0.397l36.098-20.84   c0.918-0.529,1.479-1.506,1.479-2.564S44.247,21.767,43.331,21.237z"},"audio-pause":{size:"medium",path:"M17.991,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C4.729,2.969,7.698,0,11.36,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z",path2:"M42.877,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C29.616,2.969,32.585,0,36.246,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z"}}}),computed:{svgId(){const e=this.param?"-"+this.param:"";return`vac-icon-${this.name}${e}`},size(){const e=this.svgItem[this.name];return"large"===e.size?512:"medium"===e.size?48:24}}},[["render",function(e,t,s,a,o,n){return Na(),$a("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",width:"24",height:"24",viewBox:`0 0 ${n.size} ${n.size}`},[Ka("path",{id:n.svgId,d:o.svgItem[s.name].path},null,8,Dn),o.svgItem[s.name].path2?(Na(),$a("path",{key:0,id:n.svgId,d:o.svgItem[s.name].path2},null,8,$n)):Ja("",!0)],8,Fn)}]]);const qn={name:"RoomsSearch",components:{SvgIcon:Un},props:{textMessages:{type:Object,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0}},emits:["search-room","add-room"],computed:{showSearchBar(){return this.showSearch||this.showAddRoom}}},Vn={key:0,class:"vac-icon-search"},zn=["placeholder"];var Xn=Bn(qn,[["render",function(e,t,s,a,o,n){const r=qs("svg-icon");return Na(),$a("div",{class:Ue({"vac-box-search":n.showSearchBar,"vac-box-empty":!n.showSearchBar})},[s.showSearch?(Na(),$a(Oa,{key:0},[!s.loadingRooms&&s.rooms.length?(Na(),$a("div",Vn,[Zs(e.$slots,"search-icon",{},()=>[Ga(r,{name:"search"})])])):Ja("",!0),!s.loadingRooms&&s.rooms.length?(Na(),$a("input",{key:1,type:"search",placeholder:s.textMessages.SEARCH,autocomplete:"off",class:"vac-input",onInput:t[0]||(t[0]=t=>e.$emit("search-room",t))},null,40,zn)):Ja("",!0)],64)):Ja("",!0),s.showAddRoom?(Na(),$a("div",{key:1,class:"vac-svg-button vac-add-icon",onClick:t[1]||(t[1]=t=>e.$emit("add-room"))},[Zs(e.$slots,"add-icon",{},()=>[Ga(r,{name:"add"})])])):Ja("",!0)],2)}]]),Yn={},Kn={};Kn.__esModule=!0,Kn.inherits=function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=Object.create(e.prototype);for(var o in s)a[o]=s[o];return a.constructor=t,t.prototype=a,t};var Gn={__esModule:!0},Zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wn={defaultProtocol:"http",events:null,format:Jn,formatHref:Jn,nl2br:!1,tagName:"a",target:function(e,t){return"url"===t?"_blank":null},validate:!0,ignoreTags:[],attributes:null,className:"linkified"};function Qn(e){e=e||{},this.defaultProtocol=e.hasOwnProperty("defaultProtocol")?e.defaultProtocol:Wn.defaultProtocol,this.events=e.hasOwnProperty("events")?e.events:Wn.events,this.format=e.hasOwnProperty("format")?e.format:Wn.format,this.formatHref=e.hasOwnProperty("formatHref")?e.formatHref:Wn.formatHref,this.nl2br=e.hasOwnProperty("nl2br")?e.nl2br:Wn.nl2br,this.tagName=e.hasOwnProperty("tagName")?e.tagName:Wn.tagName,this.target=e.hasOwnProperty("target")?e.target:Wn.target,this.validate=e.hasOwnProperty("validate")?e.validate:Wn.validate,this.ignoreTags=[],this.attributes=e.attributes||e.linkAttributes||Wn.attributes,this.className=e.hasOwnProperty("className")?e.className:e.linkClass||Wn.className;for(var t=e.hasOwnProperty("ignoreTags")?e.ignoreTags:Wn.ignoreTags,s=0;s<t.length;s++)this.ignoreTags.push(t[s].toUpperCase())}function Jn(e){return e}Gn.defaults=Wn,Gn.Options=Qn,Gn.contains=function(e,t){for(var s=0;s<e.length;s++)if(e[s]===t)return!0;return!1},Qn.prototype={resolve:function(e){var t=e.toHref(this.defaultProtocol);return{formatted:this.get("format",e.toString(),e),formattedHref:this.get("formatHref",t,e),tagName:this.get("tagName",t,e),className:this.get("className",t,e),target:this.get("target",t,e),events:this.getObject("events",t,e),attributes:this.getObject("attributes",t,e)}},check:function(e){return this.get("validate",e.toString(),e)},get:function(e,t,s){var a=void 0,o=this[e];if(!o)return o;switch(void 0===o?"undefined":Zn(o)){case"function":return o(t,s.type);case"object":return"function"==typeof(a=o.hasOwnProperty(s.type)?o[s.type]:Wn[e])?a(t,s.type):a}return o},getObject:function(e,t,s){var a=this[e];return"function"==typeof a?a(t,s.type):a}};var er={},tr={__esModule:!0};tr.stateify=tr.TokenState=tr.CharacterState=void 0;var sr=Kn;var ar=function(e){this.j=[],this.T=e||null};ar.prototype={defaultTransition:!1,on:function(e,t){if(e instanceof Array){for(var s=0;s<e.length;s++)this.j.push([e[s],t]);return this}return this.j.push([e,t]),this},next:function(e){for(var t=0;t<this.j.length;t++){var s=this.j[t],a=s[0],o=s[1];if(this.test(e,a))return o}return this.defaultTransition},accepts:function(){return!!this.T},test:function(e,t){return e===t},emit:function(){return this.T}};var or=(0,sr.inherits)(ar,(function(e){this.j=[],this.T=e||null}),{test:function(e,t){return e===t||t instanceof RegExp&&t.test(e)}}),nr=(0,sr.inherits)(ar,(function(e){this.j=[],this.T=e||null}),{jump:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this.next(new e(""));return s===this.defaultTransition?(s=new this.constructor(t),this.on(e,s)):t&&(s.T=t),s},test:function(e,t){return e instanceof t}});tr.CharacterState=or,tr.TokenState=nr,tr.stateify=function(e,t,s,a){for(var o=0,n=e.length,r=t,i=[],l=void 0;o<n&&(l=r.next(e[o]));)r=l,o++;if(o>=n)return[];for(;o<n-1;)l=new or(a),i.push(l),r.on(e[o],l),r=l,o++;return l=new or(s),i.push(l),r.on(e[n-1],l),i};var rr={},ir={};ir.__esModule=!0,ir.createTokenClass=function(){return function(e){e&&(this.v=e)}},rr.__esModule=!0,rr.AMPERSAND=rr.CLOSEPAREN=rr.CLOSEANGLEBRACKET=rr.CLOSEBRACKET=rr.CLOSEBRACE=rr.OPENPAREN=rr.OPENANGLEBRACKET=rr.OPENBRACKET=rr.OPENBRACE=rr.WS=rr.TLD=rr.SYM=rr.UNDERSCORE=rr.SLASH=rr.MAILTO=rr.PROTOCOL=rr.QUERY=rr.POUND=rr.PLUS=rr.NUM=rr.NL=rr.LOCALHOST=rr.PUNCTUATION=rr.DOT=rr.COLON=rr.AT=rr.DOMAIN=rr.Base=void 0;var lr=ir,cr=Kn,dr=(0,lr.createTokenClass)();function ur(e){var t=e?{v:e}:{};return(0,cr.inherits)(dr,(0,lr.createTokenClass)(),t)}dr.prototype={toString:function(){return this.v+""}};var mr=ur(),pr=ur("@"),hr=ur(":"),fr=ur("."),gr=ur(),_r=ur(),vr=ur("\n"),br=ur(),yr=ur("+"),xr=ur("#"),wr=ur(),kr=ur("mailto:"),Sr=ur("?"),Mr=ur("/"),Ar=ur("_"),Rr=ur(),Tr=ur(),Er=ur(),Br=ur("{"),Or=ur("["),Cr=ur("<"),jr=ur("("),Ir=ur("}"),Lr=ur("]"),Pr=ur(">"),Nr=ur(")"),Hr=ur("&");rr.Base=dr,rr.DOMAIN=mr,rr.AT=pr,rr.COLON=hr,rr.DOT=fr,rr.PUNCTUATION=gr,rr.LOCALHOST=_r,rr.NL=vr,rr.NUM=br,rr.PLUS=yr,rr.POUND=xr,rr.QUERY=Sr,rr.PROTOCOL=wr,rr.MAILTO=kr,rr.SLASH=Mr,rr.UNDERSCORE=Ar,rr.SYM=Rr,rr.TLD=Tr,rr.WS=Er,rr.OPENBRACE=Br,rr.OPENBRACKET=Or,rr.OPENANGLEBRACKET=Cr,rr.OPENPAREN=jr,rr.CLOSEBRACE=Ir,rr.CLOSEBRACKET=Lr,rr.CLOSEANGLEBRACKET=Pr,rr.CLOSEPAREN=Nr,rr.AMPERSAND=Hr,er.__esModule=!0,er.start=er.run=er.TOKENS=er.State=void 0;var Fr=tr,Dr=rr,$r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t}(Dr);var Ur="aaa|aarp|abarth|abb|abbott|abbvie|abc|able|abogado|abudhabi|ac|academy|accenture|accountant|accountants|aco|active|actor|ad|adac|ads|adult|ae|aeg|aero|aetna|af|afamilycompany|afl|africa|ag|agakhan|agency|ai|aig|aigo|airbus|airforce|airtel|akdn|al|alfaromeo|alibaba|alipay|allfinanz|allstate|ally|alsace|alstom|am|americanexpress|americanfamily|amex|amfam|amica|amsterdam|analytics|android|anquan|anz|ao|aol|apartments|app|apple|aq|aquarelle|ar|arab|aramco|archi|army|arpa|art|arte|as|asda|asia|associates|at|athleta|attorney|au|auction|audi|audible|audio|auspost|author|auto|autos|avianca|aw|aws|ax|axa|az|azure|ba|baby|baidu|banamex|bananarepublic|band|bank|bar|barcelona|barclaycard|barclays|barefoot|bargains|baseball|basketball|bauhaus|bayern|bb|bbc|bbt|bbva|bcg|bcn|bd|be|beats|beauty|beer|bentley|berlin|best|bestbuy|bet|bf|bg|bh|bharti|bi|bible|bid|bike|bing|bingo|bio|biz|bj|black|blackfriday|blanco|blockbuster|blog|bloomberg|blue|bm|bms|bmw|bn|bnl|bnpparibas|bo|boats|boehringer|bofa|bom|bond|boo|book|booking|boots|bosch|bostik|boston|bot|boutique|box|br|bradesco|bridgestone|broadway|broker|brother|brussels|bs|bt|budapest|bugatti|build|builders|business|buy|buzz|bv|bw|by|bz|bzh|ca|cab|cafe|cal|call|calvinklein|cam|camera|camp|cancerresearch|canon|capetown|capital|capitalone|car|caravan|cards|care|career|careers|cars|cartier|casa|case|caseih|cash|casino|cat|catering|catholic|cba|cbn|cbre|cbs|cc|cd|ceb|center|ceo|cern|cf|cfa|cfd|cg|ch|chanel|channel|chase|chat|cheap|chintai|chloe|christmas|chrome|chrysler|church|ci|cipriani|circle|cisco|citadel|citi|citic|city|cityeats|ck|cl|claims|cleaning|click|clinic|clinique|clothing|cloud|club|clubmed|cm|cn|co|coach|codes|coffee|college|cologne|com|comcast|commbank|community|company|compare|computer|comsec|condos|construction|consulting|contact|contractors|cooking|cookingchannel|cool|coop|corsica|country|coupon|coupons|courses|cr|credit|creditcard|creditunion|cricket|crown|crs|cruise|cruises|csc|cu|cuisinella|cv|cw|cx|cy|cymru|cyou|cz|dabur|dad|dance|data|date|dating|datsun|day|dclk|dds|de|deal|dealer|deals|degree|delivery|dell|deloitte|delta|democrat|dental|dentist|desi|design|dev|dhl|diamonds|diet|digital|direct|directory|discount|discover|dish|diy|dj|dk|dm|dnp|do|docs|doctor|dodge|dog|doha|domains|dot|download|drive|dtv|dubai|duck|dunlop|duns|dupont|durban|dvag|dvr|dz|earth|eat|ec|eco|edeka|edu|education|ee|eg|email|emerck|energy|engineer|engineering|enterprises|epost|epson|equipment|er|ericsson|erni|es|esq|estate|esurance|et|etisalat|eu|eurovision|eus|events|everbank|exchange|expert|exposed|express|extraspace|fage|fail|fairwinds|faith|family|fan|fans|farm|farmers|fashion|fast|fedex|feedback|ferrari|ferrero|fi|fiat|fidelity|fido|film|final|finance|financial|fire|firestone|firmdale|fish|fishing|fit|fitness|fj|fk|flickr|flights|flir|florist|flowers|fly|fm|fo|foo|food|foodnetwork|football|ford|forex|forsale|forum|foundation|fox|fr|free|fresenius|frl|frogans|frontdoor|frontier|ftr|fujitsu|fujixerox|fun|fund|furniture|futbol|fyi|ga|gal|gallery|gallo|gallup|game|games|gap|garden|gb|gbiz|gd|gdn|ge|gea|gent|genting|george|gf|gg|ggee|gh|gi|gift|gifts|gives|giving|gl|glade|glass|gle|global|globo|gm|gmail|gmbh|gmo|gmx|gn|godaddy|gold|goldpoint|golf|goo|goodhands|goodyear|goog|google|gop|got|gov|gp|gq|gr|grainger|graphics|gratis|green|gripe|grocery|group|gs|gt|gu|guardian|gucci|guge|guide|guitars|guru|gw|gy|hair|hamburg|hangout|haus|hbo|hdfc|hdfcbank|health|healthcare|help|helsinki|here|hermes|hgtv|hiphop|hisamitsu|hitachi|hiv|hk|hkt|hm|hn|hockey|holdings|holiday|homedepot|homegoods|homes|homesense|honda|honeywell|horse|hospital|host|hosting|hot|hoteles|hotels|hotmail|house|how|hr|hsbc|ht|htc|hu|hughes|hyatt|hyundai|ibm|icbc|ice|icu|id|ie|ieee|ifm|ikano|il|im|imamat|imdb|immo|immobilien|in|industries|infiniti|info|ing|ink|institute|insurance|insure|int|intel|international|intuit|investments|io|ipiranga|iq|ir|irish|is|iselect|ismaili|ist|istanbul|it|itau|itv|iveco|iwc|jaguar|java|jcb|jcp|je|jeep|jetzt|jewelry|jio|jlc|jll|jm|jmp|jnj|jo|jobs|joburg|jot|joy|jp|jpmorgan|jprs|juegos|juniper|kaufen|kddi|ke|kerryhotels|kerrylogistics|kerryproperties|kfh|kg|kh|ki|kia|kim|kinder|kindle|kitchen|kiwi|km|kn|koeln|komatsu|kosher|kp|kpmg|kpn|kr|krd|kred|kuokgroup|kw|ky|kyoto|kz|la|lacaixa|ladbrokes|lamborghini|lamer|lancaster|lancia|lancome|land|landrover|lanxess|lasalle|lat|latino|latrobe|law|lawyer|lb|lc|lds|lease|leclerc|lefrak|legal|lego|lexus|lgbt|li|liaison|lidl|life|lifeinsurance|lifestyle|lighting|like|lilly|limited|limo|lincoln|linde|link|lipsy|live|living|lixil|lk|loan|loans|locker|locus|loft|lol|london|lotte|lotto|love|lpl|lplfinancial|lr|ls|lt|ltd|ltda|lu|lundbeck|lupin|luxe|luxury|lv|ly|ma|macys|madrid|maif|maison|makeup|man|management|mango|map|market|marketing|markets|marriott|marshalls|maserati|mattel|mba|mc|mckinsey|md|me|med|media|meet|melbourne|meme|memorial|men|menu|meo|merckmsd|metlife|mg|mh|miami|microsoft|mil|mini|mint|mit|mitsubishi|mk|ml|mlb|mls|mm|mma|mn|mo|mobi|mobile|mobily|moda|moe|moi|mom|monash|money|monster|mopar|mormon|mortgage|moscow|moto|motorcycles|mov|movie|movistar|mp|mq|mr|ms|msd|mt|mtn|mtr|mu|museum|mutual|mv|mw|mx|my|mz|na|nab|nadex|nagoya|name|nationwide|natura|navy|nba|nc|ne|nec|net|netbank|netflix|network|neustar|new|newholland|news|next|nextdirect|nexus|nf|nfl|ng|ngo|nhk|ni|nico|nike|nikon|ninja|nissan|nissay|nl|no|nokia|northwesternmutual|norton|now|nowruz|nowtv|np|nr|nra|nrw|ntt|nu|nyc|nz|obi|observer|off|office|okinawa|olayan|olayangroup|oldnavy|ollo|om|omega|one|ong|onl|online|onyourside|ooo|open|oracle|orange|org|organic|origins|osaka|otsuka|ott|ovh|pa|page|panasonic|panerai|paris|pars|partners|parts|party|passagens|pay|pccw|pe|pet|pf|pfizer|pg|ph|pharmacy|phd|philips|phone|photo|photography|photos|physio|piaget|pics|pictet|pictures|pid|pin|ping|pink|pioneer|pizza|pk|pl|place|play|playstation|plumbing|plus|pm|pn|pnc|pohl|poker|politie|porn|post|pr|pramerica|praxi|press|prime|pro|prod|productions|prof|progressive|promo|properties|property|protection|pru|prudential|ps|pt|pub|pw|pwc|py|qa|qpon|quebec|quest|qvc|racing|radio|raid|re|read|realestate|realtor|realty|recipes|red|redstone|redumbrella|rehab|reise|reisen|reit|reliance|ren|rent|rentals|repair|report|republican|rest|restaurant|review|reviews|rexroth|rich|richardli|ricoh|rightathome|ril|rio|rip|rmit|ro|rocher|rocks|rodeo|rogers|room|rs|rsvp|ru|rugby|ruhr|run|rw|rwe|ryukyu|sa|saarland|safe|safety|sakura|sale|salon|samsclub|samsung|sandvik|sandvikcoromant|sanofi|sap|sapo|sarl|sas|save|saxo|sb|sbi|sbs|sc|sca|scb|schaeffler|schmidt|scholarships|school|schule|schwarz|science|scjohnson|scor|scot|sd|se|search|seat|secure|security|seek|select|sener|services|ses|seven|sew|sex|sexy|sfr|sg|sh|shangrila|sharp|shaw|shell|shia|shiksha|shoes|shop|shopping|shouji|show|showtime|shriram|si|silk|sina|singles|site|sj|sk|ski|skin|sky|skype|sl|sling|sm|smart|smile|sn|sncf|so|soccer|social|softbank|software|sohu|solar|solutions|song|sony|soy|space|spiegel|spot|spreadbetting|sr|srl|srt|st|stada|staples|star|starhub|statebank|statefarm|statoil|stc|stcgroup|stockholm|storage|store|stream|studio|study|style|su|sucks|supplies|supply|support|surf|surgery|suzuki|sv|swatch|swiftcover|swiss|sx|sy|sydney|symantec|systems|sz|tab|taipei|talk|taobao|target|tatamotors|tatar|tattoo|tax|taxi|tc|tci|td|tdk|team|tech|technology|tel|telecity|telefonica|temasek|tennis|teva|tf|tg|th|thd|theater|theatre|tiaa|tickets|tienda|tiffany|tips|tires|tirol|tj|tjmaxx|tjx|tk|tkmaxx|tl|tm|tmall|tn|to|today|tokyo|tools|top|toray|toshiba|total|tours|town|toyota|toys|tr|trade|trading|training|travel|travelchannel|travelers|travelersinsurance|trust|trv|tt|tube|tui|tunes|tushu|tv|tvs|tw|tz|ua|ubank|ubs|uconnect|ug|uk|unicom|university|uno|uol|ups|us|uy|uz|va|vacations|vana|vanguard|vc|ve|vegas|ventures|verisign|versicherung|vet|vg|vi|viajes|video|vig|viking|villas|vin|vip|virgin|visa|vision|vista|vistaprint|viva|vivo|vlaanderen|vn|vodka|volkswagen|volvo|vote|voting|voto|voyage|vu|vuelos|wales|walmart|walter|wang|wanggou|warman|watch|watches|weather|weatherchannel|webcam|weber|website|wed|wedding|weibo|weir|wf|whoswho|wien|wiki|williamhill|win|windows|wine|winners|wme|wolterskluwer|woodside|work|works|world|wow|ws|wtc|wtf|xbox|xerox|xfinity|xihuan|xin|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--30rr7y|xn--3bst00m|xn--3ds443g|xn--3e0b707e|xn--3hcrj9c|xn--3oq18vl8pn36a|xn--3pxu8k|xn--42c2d9a|xn--45br5cyl|xn--45brj9c|xn--45q11c|xn--4gbrim|xn--54b7fta0cc|xn--55qw42g|xn--55qx5d|xn--5su34j936bgsg|xn--5tzm5g|xn--6frz82g|xn--6qq986b3xl|xn--80adxhks|xn--80ao21a|xn--80aqecdr1a|xn--80asehdb|xn--80aswg|xn--8y0a063a|xn--90a3ac|xn--90ae|xn--90ais|xn--9dbq2a|xn--9et52u|xn--9krt00a|xn--b4w605ferd|xn--bck1b9a5dre4c|xn--c1avg|xn--c2br7g|xn--cck2b3b|xn--cg4bki|xn--clchc0ea0b2g2a9gcd|xn--czr694b|xn--czrs0t|xn--czru2d|xn--d1acj3b|xn--d1alf|xn--e1a4c|xn--eckvdtc9d|xn--efvy88h|xn--estv75g|xn--fct429k|xn--fhbei|xn--fiq228c5hs|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--fjq720a|xn--flw351e|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--fzys8d69uvgm|xn--g2xx48c|xn--gckr3f0f|xn--gecrj9c|xn--gk3at1e|xn--h2breg3eve|xn--h2brj9c|xn--h2brj9c8c|xn--hxt814e|xn--i1b6b1a6a2e|xn--imr513n|xn--io0a7i|xn--j1aef|xn--j1amh|xn--j6w193g|xn--jlq61u9w7b|xn--jvr189m|xn--kcrx77d1x4a|xn--kprw13d|xn--kpry57d|xn--kpu716f|xn--kput3i|xn--l1acc|xn--lgbbat1ad8j|xn--mgb9awbf|xn--mgba3a3ejt|xn--mgba3a4f16a|xn--mgba7c0bbn0a|xn--mgbaakc7dvf|xn--mgbaam7a8h|xn--mgbab2bd|xn--mgbai9azgqp6j|xn--mgbayh7gpa|xn--mgbb9fbpob|xn--mgbbh1a|xn--mgbbh1a71e|xn--mgbc0a9azcg|xn--mgbca7dzdo|xn--mgberp4a5d4ar|xn--mgbgu82a|xn--mgbi4ecexp|xn--mgbpl2fh|xn--mgbt3dhd|xn--mgbtx2b|xn--mgbx4cd0ab|xn--mix891f|xn--mk1bu44c|xn--mxtq1m|xn--ngbc5azd|xn--ngbe9e0a|xn--ngbrx|xn--node|xn--nqv7f|xn--nqv7fs00ema|xn--nyqy26a|xn--o3cw4h|xn--ogbpf8fl|xn--p1acf|xn--p1ai|xn--pbt977c|xn--pgbs0dh|xn--pssy2u|xn--q9jyb4c|xn--qcka1pmc|xn--qxam|xn--rhqv96g|xn--rovu88b|xn--rvc1e0am3e|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--tckwe|xn--tiq49xqyj|xn--unup4y|xn--vermgensberater-ctb|xn--vermgensberatung-pwb|xn--vhquv|xn--vuq861b|xn--w4r85el8fhu5dnra|xn--w4rs40l|xn--wgbh1c|xn--wgbl6a|xn--xhq521b|xn--xkc2al3hye2a|xn--xkc2dl3a5ee0h|xn--y9a3aq|xn--yfro4i67o|xn--ygbi2ammx|xn--zfr164b|xperia|xxx|xyz|yachts|yahoo|yamaxun|yandex|ye|yodobashi|yoga|yokohama|you|youtube|yt|yun|za|zappos|zara|zero|zip|zippo|zm|zone|zuerich|zw".split("|"),qr="0123456789".split(""),Vr="0123456789abcdefghijklmnopqrstuvwxyz".split(""),zr=[" ","\f","\r","\t","\v"," "," ","᠎"],Xr=[],Yr=function(e){return new Fr.CharacterState(e)},Kr=Yr(),Gr=Yr(Dr.NUM),Zr=Yr(Dr.DOMAIN),Wr=Yr(),Qr=Yr(Dr.WS);Kr.on("@",Yr(Dr.AT)).on(".",Yr(Dr.DOT)).on("+",Yr(Dr.PLUS)).on("#",Yr(Dr.POUND)).on("?",Yr(Dr.QUERY)).on("/",Yr(Dr.SLASH)).on("_",Yr(Dr.UNDERSCORE)).on(":",Yr(Dr.COLON)).on("{",Yr(Dr.OPENBRACE)).on("[",Yr(Dr.OPENBRACKET)).on("<",Yr(Dr.OPENANGLEBRACKET)).on("(",Yr(Dr.OPENPAREN)).on("}",Yr(Dr.CLOSEBRACE)).on("]",Yr(Dr.CLOSEBRACKET)).on(">",Yr(Dr.CLOSEANGLEBRACKET)).on(")",Yr(Dr.CLOSEPAREN)).on("&",Yr(Dr.AMPERSAND)).on([",",";","!",'"',"'"],Yr(Dr.PUNCTUATION)),Kr.on("\n",Yr(Dr.NL)).on(zr,Qr),Qr.on(zr,Qr);for(var Jr=0;Jr<Ur.length;Jr++){var ei=(0,Fr.stateify)(Ur[Jr],Kr,Dr.TLD,Dr.DOMAIN);Xr.push.apply(Xr,ei)}var ti=(0,Fr.stateify)("file",Kr,Dr.DOMAIN,Dr.DOMAIN),si=(0,Fr.stateify)("ftp",Kr,Dr.DOMAIN,Dr.DOMAIN),ai=(0,Fr.stateify)("http",Kr,Dr.DOMAIN,Dr.DOMAIN),oi=(0,Fr.stateify)("mailto",Kr,Dr.DOMAIN,Dr.DOMAIN);Xr.push.apply(Xr,ti),Xr.push.apply(Xr,si),Xr.push.apply(Xr,ai),Xr.push.apply(Xr,oi);var ni=ti.pop(),ri=si.pop(),ii=ai.pop(),li=oi.pop(),ci=Yr(Dr.DOMAIN),di=Yr(Dr.PROTOCOL),ui=Yr(Dr.MAILTO);ri.on("s",ci).on(":",di),ii.on("s",ci).on(":",di),Xr.push(ci),ni.on(":",di),ci.on(":",di),li.on(":",ui);var mi=(0,Fr.stateify)("localhost",Kr,Dr.LOCALHOST,Dr.DOMAIN);Xr.push.apply(Xr,mi),Kr.on(qr,Gr),Gr.on("-",Wr).on(qr,Gr).on(Vr,Zr),Zr.on("-",Wr).on(Vr,Zr);for(var pi=0;pi<Xr.length;pi++)Xr[pi].on("-",Wr).on(Vr,Zr);Wr.on("-",Wr).on(qr,Zr).on(Vr,Zr),Kr.defaultTransition=Yr(Dr.SYM);var hi=Kr;er.State=Fr.CharacterState,er.TOKENS=$r,er.run=function(e){for(var t=e.replace(/[A-Z]/g,(function(e){return e.toLowerCase()})),s=e.length,a=[],o=0;o<s;){for(var n=Kr,r=null,i=0,l=null,c=-1;o<s&&(r=n.next(t[o]));)(n=r).accepts()?(c=0,l=n):c>=0&&c++,i++,o++;if(!(c<0)){o-=c,i-=c;var d=l.emit();a.push(new d(e.substr(o-i,i)))}}return a},er.start=hi;var fi={},gi={__esModule:!0};gi.URL=gi.TEXT=gi.NL=gi.EMAIL=gi.MAILTOEMAIL=gi.Base=void 0;var _i=ir,vi=Kn,bi=rr;function yi(e){return e instanceof bi.DOMAIN||e instanceof bi.TLD}var xi=(0,_i.createTokenClass)();xi.prototype={type:"token",isLink:!1,toString:function(){for(var e=[],t=0;t<this.v.length;t++)e.push(this.v[t].toString());return e.join("")},toHref:function(){return this.toString()},toObject:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http";return{type:this.type,value:this.toString(),href:this.toHref(e)}}};var wi=(0,vi.inherits)(xi,(0,_i.createTokenClass)(),{type:"email",isLink:!0}),ki=(0,vi.inherits)(xi,(0,_i.createTokenClass)(),{type:"email",isLink:!0,toHref:function(){return"mailto:"+this.toString()}}),Si=(0,vi.inherits)(xi,(0,_i.createTokenClass)(),{type:"text"}),Mi=(0,vi.inherits)(xi,(0,_i.createTokenClass)(),{type:"nl"}),Ai=(0,vi.inherits)(xi,(0,_i.createTokenClass)(),{type:"url",isLink:!0,toHref:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http",t=!1,s=!1,a=this.v,o=[],n=0;a[n]instanceof bi.PROTOCOL;)t=!0,o.push(a[n].toString().toLowerCase()),n++;for(;a[n]instanceof bi.SLASH;)s=!0,o.push(a[n].toString()),n++;for(;yi(a[n]);)o.push(a[n].toString().toLowerCase()),n++;for(;n<a.length;n++)o.push(a[n].toString());return o=o.join(""),t||s||(o=e+"://"+o),o},hasProtocol:function(){return this.v[0]instanceof bi.PROTOCOL}});gi.Base=xi,gi.MAILTOEMAIL=wi,gi.EMAIL=ki,gi.NL=Mi,gi.TEXT=Si,gi.URL=Ai,fi.__esModule=!0,fi.start=fi.run=fi.TOKENS=fi.State=void 0;var Ri=tr,Ti=gi,Ei=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t}(Ti),Bi=rr;var Oi=function(e){return new Ri.TokenState(e)},Ci=Oi(),ji=Oi(),Ii=Oi(),Li=Oi(),Pi=Oi(),Ni=Oi(),Hi=Oi(),Fi=Oi(Ti.URL),Di=Oi(),$i=Oi(Ti.URL),Ui=Oi(Ti.URL),qi=Oi(),Vi=Oi(),zi=Oi(),Xi=Oi(),Yi=Oi(),Ki=Oi(Ti.URL),Gi=Oi(Ti.URL),Zi=Oi(Ti.URL),Wi=Oi(Ti.URL),Qi=Oi(),Ji=Oi(),el=Oi(),tl=Oi(),sl=Oi(),al=Oi(),ol=Oi(Ti.EMAIL),nl=Oi(),rl=Oi(Ti.EMAIL),il=Oi(Ti.MAILTOEMAIL),ll=Oi(),cl=Oi(),dl=Oi(),ul=Oi(),ml=Oi(Ti.NL);Ci.on(Bi.NL,ml).on(Bi.PROTOCOL,ji).on(Bi.MAILTO,Ii).on(Bi.SLASH,Li),ji.on(Bi.SLASH,Li),Li.on(Bi.SLASH,Pi),Ci.on(Bi.TLD,Ni).on(Bi.DOMAIN,Ni).on(Bi.LOCALHOST,Fi).on(Bi.NUM,Ni),Pi.on(Bi.TLD,Ui).on(Bi.DOMAIN,Ui).on(Bi.NUM,Ui).on(Bi.LOCALHOST,Ui),Ni.on(Bi.DOT,Hi),sl.on(Bi.DOT,al),Hi.on(Bi.TLD,Fi).on(Bi.DOMAIN,Ni).on(Bi.NUM,Ni).on(Bi.LOCALHOST,Ni),al.on(Bi.TLD,ol).on(Bi.DOMAIN,sl).on(Bi.NUM,sl).on(Bi.LOCALHOST,sl),Fi.on(Bi.DOT,Hi),ol.on(Bi.DOT,al),Fi.on(Bi.COLON,Di).on(Bi.SLASH,Ui),Di.on(Bi.NUM,$i),$i.on(Bi.SLASH,Ui),ol.on(Bi.COLON,nl),nl.on(Bi.NUM,rl);var pl=[Bi.DOMAIN,Bi.AT,Bi.LOCALHOST,Bi.NUM,Bi.PLUS,Bi.POUND,Bi.PROTOCOL,Bi.SLASH,Bi.TLD,Bi.UNDERSCORE,Bi.SYM,Bi.AMPERSAND],hl=[Bi.COLON,Bi.DOT,Bi.QUERY,Bi.PUNCTUATION,Bi.CLOSEBRACE,Bi.CLOSEBRACKET,Bi.CLOSEANGLEBRACKET,Bi.CLOSEPAREN,Bi.OPENBRACE,Bi.OPENBRACKET,Bi.OPENANGLEBRACKET,Bi.OPENPAREN];Ui.on(Bi.OPENBRACE,Vi).on(Bi.OPENBRACKET,zi).on(Bi.OPENANGLEBRACKET,Xi).on(Bi.OPENPAREN,Yi),qi.on(Bi.OPENBRACE,Vi).on(Bi.OPENBRACKET,zi).on(Bi.OPENANGLEBRACKET,Xi).on(Bi.OPENPAREN,Yi),Vi.on(Bi.CLOSEBRACE,Ui),zi.on(Bi.CLOSEBRACKET,Ui),Xi.on(Bi.CLOSEANGLEBRACKET,Ui),Yi.on(Bi.CLOSEPAREN,Ui),Ki.on(Bi.CLOSEBRACE,Ui),Gi.on(Bi.CLOSEBRACKET,Ui),Zi.on(Bi.CLOSEANGLEBRACKET,Ui),Wi.on(Bi.CLOSEPAREN,Ui),Qi.on(Bi.CLOSEBRACE,Ui),Ji.on(Bi.CLOSEBRACKET,Ui),el.on(Bi.CLOSEANGLEBRACKET,Ui),tl.on(Bi.CLOSEPAREN,Ui),Vi.on(pl,Ki),zi.on(pl,Gi),Xi.on(pl,Zi),Yi.on(pl,Wi),Vi.on(hl,Qi),zi.on(hl,Ji),Xi.on(hl,el),Yi.on(hl,tl),Ki.on(pl,Ki),Gi.on(pl,Gi),Zi.on(pl,Zi),Wi.on(pl,Wi),Ki.on(hl,Ki),Gi.on(hl,Gi),Zi.on(hl,Zi),Wi.on(hl,Wi),Qi.on(pl,Ki),Ji.on(pl,Gi),el.on(pl,Zi),tl.on(pl,Wi),Qi.on(hl,Qi),Ji.on(hl,Ji),el.on(hl,el),tl.on(hl,tl),Ui.on(pl,Ui),qi.on(pl,Ui),Ui.on(hl,qi),qi.on(hl,qi),Ii.on(Bi.TLD,il).on(Bi.DOMAIN,il).on(Bi.NUM,il).on(Bi.LOCALHOST,il),il.on(pl,il).on(hl,ll),ll.on(pl,il).on(hl,ll);var fl=[Bi.DOMAIN,Bi.NUM,Bi.PLUS,Bi.POUND,Bi.QUERY,Bi.UNDERSCORE,Bi.SYM,Bi.AMPERSAND,Bi.TLD];Ni.on(fl,cl).on(Bi.AT,dl),Fi.on(fl,cl).on(Bi.AT,dl),Hi.on(fl,cl),cl.on(fl,cl).on(Bi.AT,dl).on(Bi.DOT,ul),ul.on(fl,cl),dl.on(Bi.TLD,sl).on(Bi.DOMAIN,sl).on(Bi.LOCALHOST,ol);fi.State=Ri.TokenState,fi.TOKENS=Ei,fi.run=function(e){for(var t=e.length,s=0,a=[],o=[];s<t;){for(var n=Ci,r=null,i=null,l=0,c=null,d=-1;s<t&&!(r=n.next(e[s]));)o.push(e[s++]);for(;s<t&&(i=r||n.next(e[s]));)r=null,(n=i).accepts()?(d=0,c=n):d>=0&&d++,s++,l++;if(d<0)for(var u=s-l;u<s;u++)o.push(e[u]);else{o.length>0&&(a.push(new Ti.TEXT(o)),o=[]),s-=d,l-=d;var m=c.emit();a.push(new m(e.slice(s-l,s)))}}return o.length>0&&a.push(new Ti.TEXT(o)),a},fi.start=Ci,Yn.__esModule=!0,Yn.tokenize=Yn.test=Yn.scanner=Yn.parser=Yn.options=Yn.inherits=Yn.find=void 0;var gl=Kn,_l=yl(Gn),vl=yl(er),bl=yl(fi);function yl(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t}Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var xl=function(e){return bl.run(vl.run(e))};Yn.find=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=xl(e),a=[],o=0;o<s.length;o++){var n=s[o];!n.isLink||t&&n.type!==t||a.push(n.toObject())}return a},Yn.inherits=gl.inherits,Yn.options=_l,Yn.parser=bl,Yn.scanner=vl,Yn.test=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=xl(e);return 1===s.length&&s[0].isLink&&(!t||s[0].type===t)},Yn.tokenize=xl;var wl=Yn,kl=(e,t,s)=>{const a={bold:s.bold,italic:s.italic,strike:s.strike,underline:s.underline,multilineCode:s.multilineCode,inlineCode:s.inlineCode},o={[a.bold]:{end:"\\"+a.bold,allowed_chars:".",type:"bold"},[a.italic]:{end:a.italic,allowed_chars:".",type:"italic"},[a.strike]:{end:a.strike,allowed_chars:".",type:"strike"},[a.underline]:{end:a.underline,allowed_chars:".",type:"underline"},[a.multilineCode]:{end:a.multilineCode,allowed_chars:"(.|\n)",type:"multiline-code"},[a.inlineCode]:{end:a.inlineCode,allowed_chars:".",type:"inline-code"},"<usertag>":{allowed_chars:".",end:"</usertag>",type:"tag"}},n=function(e,t){const s=[];return e.forEach(e=>{"string"==typeof e?s.push({types:[],value:e}):t[e.start]&&s.push(function(e){const t=[];return function e(t,s,a){t.content.forEach(o=>{"string"==typeof o?s.push({types:Sl(a.concat([t.type])),value:o}):e(o,s,Sl([o.type].concat([t.type]).concat(a)))})}(e,t,[]),t}(e))}),s}(function e(t,s){let a=[],o=-1,n=null,r=wl.find(t),i=!1;r.length>0&&(o=t.indexOf(r[0].value),i=!0);if(Object.keys(s).forEach(e=>{const s=t.indexOf(e);s>=0&&(o<0||s<o)&&(o=s,n=e,i=!1)}),i&&-1!==n){let n=t.substr(0,o),i=t.substr(o,r[0].value.length),l=t.substr(o+r[0].value.length);return a.push(n),a.push(i),a=a.concat(e(l,s)),a}if(n){let r=t.substr(0,o);const i=n;let l=t.substr(o+i.length);if(t.replace(/\s/g,"").length===2*i.length)return[t];const c=l.match(new RegExp("^("+(s[i].allowed_chars||".")+"*"+(s[i].end?"?":"")+")"+(s[i].end?"("+s[i].end+")":""),"m"));if(c&&c[1]){r&&a.push(r);const t={start:i,content:e(c[1],s),end:c[2],type:s[i].type};a.push(t),l=l.substr(c[0].length)}else r+=i,a.push(r);return a=a.concat(e(l,s)),a}return t?[t]:[]}(e,o),o),r=[].concat.apply([],n);return t&&function(e){const t=[];e.forEach(e=>{const s=wl.find(e.value);if(s.length){const a=e.value.replace(s[0].value,"");t.push({types:e.types,value:a}),e.types=["url"].concat(e.types),e.href=s[0].href,e.value=s[0].value}t.push(e)})}(r),r};function Sl(e){return[...new Set(e)]}const Ml=["png","jpg","jpeg","webp","svg","gif"],Al=["mp4","video/ogg","webm","quicktime"],Rl=["mp3","audio/ogg","wav","mpeg"],Tl={name:"FormatMessage",components:{SvgIcon:Un},props:{messageId:{type:String,default:""},roomId:{type:String,default:""},roomList:{type:Boolean,default:!1},content:{type:[String,Number],required:!0},deleted:{type:Boolean,default:!1},users:{type:Array,default:()=>[]},linkify:{type:Boolean,default:!0},singleLine:{type:Boolean,default:!1},reply:{type:Boolean,default:!1},textFormatting:{type:Object,required:!0},textMessages:{type:Object,default:()=>{}},linkOptions:{type:Object,required:!0}},emits:["open-user-tag"],computed:{linkifiedMessage(){if(this.deleted)return[{value:this.textMessages.MESSAGE_DELETED}];const e=kl(this.formatTags(this.content),this.linkify&&!this.linkOptions.disabled,this.textFormatting);return e.forEach(e=>{e.url=this.checkType(e,"url"),e.bold=this.checkType(e,"bold"),e.italic=this.checkType(e,"italic"),e.strike=this.checkType(e,"strike"),e.underline=this.checkType(e,"underline"),e.inline=this.checkType(e,"inline-code"),e.multiline=this.checkType(e,"multiline-code"),e.tag=this.checkType(e,"tag"),e.image=this.checkImageType(e),e.value=this.replaceEmojiByElement(e.value)}),e},formattedContent(){return this.deleted?this.textMessages.MESSAGE_DELETED:this.formatTags(this.content)}},methods:{checkType:(e,t)=>e.types&&-1!==e.types.indexOf(t),checkImageType(e){let t=e.value.lastIndexOf(".");e.value.lastIndexOf("/")>t&&(t=-1);const s=e.value.substring(t+1,e.value.length),a=t>0&&Ml.some(e=>s.toLowerCase().includes(e));return a&&this.setImageSize(e),a},setImageSize(e){const t=new Image;t.src=e.value,t.addEventListener("load",(function s(a){const o=a.path[0].width/150;e.height=Math.round(a.path[0].height/o)+"px",t.removeEventListener("load",s)}))},formatTags(e){const t=[...e.matchAll(new RegExp("<usertag>","gi"))].map(e=>e.index),s=e;return t.forEach(t=>{const a=s.substring(t+"<usertag>".length,s.indexOf("</usertag>",t)),o=this.users.find(e=>e._id===a);e=e.replaceAll(a,"@"+((null==o?void 0:o.username)||"unknown"))}),e},openTag(e){if(!this.singleLine&&this.checkType(e,"tag")){const t=this.users.find(t=>-1!==e.value.indexOf(t.username));this.$emit("open-user-tag",t)}},replaceEmojiByElement(e){let t;if(this.singleLine)t=16;else{const e=this.containsOnlyEmojis();t=e?28:20}return e.replaceAll(/[\p{Extended_Pictographic}\u{1F3FB}-\u{1F3FF}\u{1F9B0}-\u{1F9B3}]/gu,e=>`<span style="font-size: ${t}px">${e}</span>`)},containsOnlyEmojis(){const e=this.content.replace(new RegExp("[\0-ữf]","g"),""),t=this.content.replace(new RegExp("[\n\rs]+|( )+","g"),"");return e.length===t.length}}},El={class:"vac-image-link-container"},Bl={class:"vac-image-link-message"},Ol=["innerHTML"],Cl=["innerHTML"];var jl=Bn(Tl,[["render",function(e,t,s,a,o,n){const r=qs("svg-icon");return Na(),$a("div",{class:Ue(["vac-format-message-wrapper",{"vac-text-ellipsis":s.singleLine}])},[s.textFormatting.disabled?(Na(),$a("div",{key:1,innerHTML:n.formattedContent},null,8,Cl)):(Na(),$a("div",{key:0,class:Ue({"vac-text-ellipsis":s.singleLine})},[(Na(!0),$a(Oa,null,Ks(n.linkifiedMessage,(t,a)=>{return Na(),$a("div",{key:a,class:"vac-format-container"},[(Na(),Ua((o=t.url?"a":"span",it(o)?Xs("components",o,!1)||o:o||Vs),{class:Ue({"vac-text-ellipsis":s.singleLine,"vac-text-bold":t.bold,"vac-text-italic":s.deleted||t.italic,"vac-text-strike":t.strike,"vac-text-underline":t.underline,"vac-text-inline-code":!s.singleLine&&t.inline,"vac-text-multiline-code":!s.singleLine&&t.multiline,"vac-text-tag":!s.singleLine&&!s.reply&&t.tag}),href:t.href,target:t.href?s.linkOptions.target:null,rel:t.href?s.linkOptions.rel:null,onClick:e=>n.openTag(t)},{default:ss(()=>[s.deleted?(Na(),$a(Oa,{key:0},[Zs(e.$slots,s.roomList?"deleted-icon-room_"+s.roomId:"deleted-icon_"+s.messageId,{},()=>[Ga(r,{name:"deleted",class:Ue(["vac-icon-deleted",{"vac-icon-deleted-room":s.roomList}])},null,8,["class"])]),Qa(" "+Ve(s.textMessages.MESSAGE_DELETED),1)],64)):t.url&&t.image?(Na(),$a(Oa,{key:1},[Ka("div",El,[Ka("div",{class:"vac-image-link",style:He({"background-image":`url('${t.value}')`,height:t.height})},null,4)]),Ka("div",Bl,[Ka("span",null,Ve(t.value),1)])],64)):(Na(),$a("span",{key:2,innerHTML:t.value},null,8,Ol))]),_:2},1032,["class","href","target","rel","onClick"]))]);var o}),128))],2))],2)}]]);const Il="undefined"!=typeof window,Ll="undefined"!=typeof navigator,Pl=Il&&("ontouchstart"in window||Ll&&navigator.msMaxTouchPoints>0)?["touchstart"]:["click"],Nl=({event:e,handler:t,middleware:s})=>{s(e)&&t(e)},Hl=(e,{value:t})=>{const{events:s,handler:a,middleware:o,isActive:n,detectIframe:r,capture:i}=(e=>{const t="function"==typeof e;if(!t&&"object"!=typeof e)throw new Error("v-click-outside: Binding value must be a function or an object");return{handler:t?e:e.handler,middleware:e.middleware||(e=>e),events:e.events||Pl,isActive:!(!1===e.isActive),detectIframe:!(!1===e.detectIframe),capture:Boolean(e.capture)}})(t);if(n){if(e["__v-click-outside"]=s.map(t=>({event:t,srcTarget:document.documentElement,handler:t=>(({el:e,event:t,handler:s,middleware:a})=>{const o=t.path||t.composedPath&&t.composedPath();(o?o.indexOf(e)<0:!e.contains(t.target))&&Nl({event:t,handler:s,middleware:a})})({el:e,event:t,handler:a,middleware:o}),capture:i})),r){const t={event:"blur",srcTarget:window,handler:t=>(({el:e,event:t,handler:s,middleware:a})=>{setTimeout(()=>{const{activeElement:o}=document;o&&"IFRAME"===o.tagName&&!e.contains(o)&&Nl({event:t,handler:s,middleware:a})},0)})({el:e,event:t,handler:a,middleware:o}),capture:i};e["__v-click-outside"]=[...e["__v-click-outside"],t]}e["__v-click-outside"].forEach(({event:t,srcTarget:s,handler:a})=>setTimeout(()=>{e["__v-click-outside"]&&s.addEventListener(t,a,i)},0))}},Fl=e=>{(e["__v-click-outside"]||[]).forEach(({event:e,srcTarget:t,handler:s,capture:a})=>t.removeEventListener(e,s,a)),delete e["__v-click-outside"]};var Dl=Il?{beforeMount:Hl,updated:(e,{value:t,oldValue:s})=>{JSON.stringify(t)!==JSON.stringify(s)&&(Fl(e),Hl(e,{value:t}))},unmounted:Fl}:{},$l=(e,t,s)=>{if(e.typingUsers&&e.typingUsers.length){const a=e.users.filter(s=>{if(s._id!==t&&-1!==e.typingUsers.indexOf(s._id)&&(!s.status||"offline"!==s.status.state))return!0});if(!a.length)return;return 2===e.users.length?s.IS_TYPING:a.map(e=>e.username).join(", ")+" "+s.IS_TYPING}};function Ul(e,t){if(t&&t.type)return e.some(e=>t.type.toLowerCase().includes(e))}function ql(e){return Ul(Ml,e)}function Vl(e){return Ul(Al,e)}function zl(e){return Ul(Ml,e)||Ul(Al,e)}function Xl(e){return Ul(Rl,e)}const Yl={class:"vac-room-container"},Kl={class:"vac-name-container vac-text-ellipsis"},Gl={class:"vac-title-container"},Zl={class:"vac-room-name vac-text-ellipsis"},Wl={key:1,class:"vac-text-date"},Ql={key:0},Jl={key:1,class:"vac-text-ellipsis"},ec={key:3,class:"vac-text-ellipsis"},tc={class:"vac-room-options-container"},sc={key:0,class:"vac-badge-counter vac-room-badge"},ac={key:0,class:"vac-menu-options"},oc={class:"vac-menu-list"},nc=["onClick"];var rc=(e,t,s,a=!1)=>s&&""!==s?e.filter(e=>a?ic(e[t]).startsWith(ic(s)):ic(e[t]).includes(ic(s))):e;function ic(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}const lc={name:"RoomsList",components:{Loader:Hn,RoomsSearch:Xn,RoomContent:Bn({name:"RoomsContent",components:{SvgIcon:Un,FormatMessage:jl},directives:{clickOutside:Dl},props:{currentUserId:{type:[String,Number],required:!0},room:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},roomActions:{type:Array,required:!0}},emits:["room-action-handler"],data:()=>({roomMenuOpened:null}),computed:{getLastMessage(){const e=this.typingUsers;if(e)return e;const t=this.room.lastMessage.content;if(this.room.users.length<=2)return t;const s=this.room.users.find(e=>e._id===this.room.lastMessage.senderId);return this.room.lastMessage.username?`${this.room.lastMessage.username} - ${t}`:s&&s._id!==this.currentUserId?`${s.username} - ${t}`:t},userStatus(){if(!this.room.users||2!==this.room.users.length)return;const e=this.room.users.find(e=>e._id!==this.currentUserId);return e&&e.status?e.status.state:null},typingUsers(){return $l(this.room,this.currentUserId,this.textMessages)},isMessageCheckmarkVisible(){return!this.typingUsers&&this.room.lastMessage&&!this.room.lastMessage.deleted&&this.room.lastMessage.senderId===this.currentUserId&&(this.room.lastMessage.saved||this.room.lastMessage.distributed||this.room.lastMessage.seen)},formattedDuration(){var e,t;const s=null==(t=null==(e=this.room.lastMessage)?void 0:e.files)?void 0:t[0];if(s){if(!s.duration)return`${s.name}.${s.extension}`;let e=Math.floor(s.duration);return(e-(e%=60))/60+(e>9?":":":0")+e}return""},isAudio(){return!!this.room.lastMessage.files&&Xl(this.room.lastMessage.files[0])}},methods:{roomActionHandler(e){this.closeRoomMenu(),this.$emit("room-action-handler",{action:e,roomId:this.room.roomId})},closeRoomMenu(){this.roomMenuOpened=null}}},[["render",function(e,t,s,a,o,n){const r=qs("svg-icon"),i=qs("format-message"),l=zs("click-outside");return Na(),$a("div",Yl,[Zs(e.$slots,"room-list-item_"+s.room.roomId,{},()=>[Zs(e.$slots,"room-list-avatar_"+s.room.roomId,{},()=>[s.room.avatar?(Na(),$a("div",{key:0,class:"vac-avatar",style:He({"background-image":`url('${s.room.avatar}')`})},null,4)):Ja("",!0)]),Ka("div",Kl,[Ka("div",Gl,[n.userStatus?(Na(),$a("div",{key:0,class:Ue(["vac-state-circle",{"vac-state-online":"online"===n.userStatus}])},null,2)):Ja("",!0),Ka("div",Zl,Ve(s.room.roomName),1),s.room.lastMessage?(Na(),$a("div",Wl,Ve(s.room.lastMessage.timestamp),1)):Ja("",!0)]),Ka("div",{class:Ue(["vac-text-last",{"vac-message-new":s.room.lastMessage&&s.room.lastMessage.new&&!n.typingUsers}])},[n.isMessageCheckmarkVisible?(Na(),$a("span",Ql,[Zs(e.$slots,"checkmark-icon_"+s.room.roomId,{},()=>[Ga(r,{name:s.room.lastMessage.distributed?"double-checkmark":"checkmark",param:s.room.lastMessage.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])])])):Ja("",!0),s.room.lastMessage&&!s.room.lastMessage.deleted&&n.isAudio?(Na(),$a("div",Jl,[Zs(e.$slots,"microphone-icon_"+s.room.roomId,{},()=>[Ga(r,{name:"microphone",class:"vac-icon-microphone"})]),Qa(" "+Ve(n.formattedDuration),1)])):s.room.lastMessage?(Na(),Ua(i,{key:2,"message-id":s.room.lastMessage._id,"room-id":s.room.roomId,"room-list":!0,content:n.getLastMessage,deleted:!!s.room.lastMessage.deleted&&!n.typingUsers,users:s.room.users,"text-messages":s.textMessages,linkify:!1,"text-formatting":s.textFormatting,"link-options":s.linkOptions,"single-line":!0},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["message-id","room-id","content","deleted","users","text-messages","text-formatting","link-options"])):Ja("",!0),!s.room.lastMessage&&n.typingUsers?(Na(),$a("div",ec,Ve(n.typingUsers),1)):Ja("",!0),Ka("div",tc,[s.room.unreadCount?(Na(),$a("div",sc,Ve(s.room.unreadCount),1)):Ja("",!0),Zs(e.$slots,"room-list-options_"+s.room.roomId,{},()=>[s.roomActions.length?(Na(),$a("div",{key:0,class:"vac-svg-button vac-list-room-options",onClick:t[0]||(t[0]=wn(e=>o.roomMenuOpened=s.room.roomId,["stop"]))},[Zs(e.$slots,"room-list-options-icon_"+s.room.roomId,{},()=>[Ga(r,{name:"dropdown",param:"room"})])])):Ja("",!0),s.roomActions.length?(Na(),Ua(Wo,{key:1,name:"vac-slide-left"},{default:ss(()=>[o.roomMenuOpened===s.room.roomId?$s((Na(),$a("div",ac,[Ka("div",oc,[(Na(!0),$a(Oa,null,Ks(s.roomActions,e=>(Na(),$a("div",{key:e.name},[Ka("div",{class:"vac-menu-item",onClick:wn(t=>n.roomActionHandler(e),["stop"])},Ve(e.title),9,nc)]))),128))])])),[[l,n.closeRoomMenu]]):Ja("",!0)]),_:1})):Ja("",!0)])])],2)])])])}]])},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},showRoomsList:{type:Boolean,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0},roomsLoaded:{type:Boolean,required:!0},room:{type:Object,required:!0},customSearchRoomEnabled:{type:[Boolean,String],default:!1},roomActions:{type:Array,required:!0},scrollDistance:{type:Number,required:!0}},emits:["add-room","search-room","room-action-handler","loading-more-rooms","fetch-room","fetch-more-rooms"],data(){return{filteredRooms:this.rooms||[],observer:null,showLoader:!0,loadingMoreRooms:!1,selectedRoomId:""}},watch:{rooms:{deep:!0,handler(e,t){this.filteredRooms=e,(e.length!==t.length||this.roomsLoaded)&&(this.loadingMoreRooms=!1)}},loadingRooms(e){e||setTimeout(()=>this.initIntersectionObserver())},loadingMoreRooms(e){this.$emit("loading-more-rooms",e)},roomsLoaded:{immediate:!0,handler(e){e&&(this.loadingMoreRooms=!1,this.loadingRooms||(this.showLoader=!1))}},room:{immediate:!0,handler(e){e&&!this.isMobile&&(this.selectedRoomId=e.roomId)}}},methods:{initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=this.$el.querySelector("#infinite-loader-rooms");if(e){const t={root:this.$el.querySelector("#rooms-list"),rootMargin:this.scrollDistance+"px",threshold:0};this.observer=new IntersectionObserver(e=>{e[0].isIntersecting&&this.loadMoreRooms()},t),this.observer.observe(e)}},searchRoom(e){this.customSearchRoomEnabled?this.$emit("search-room",e.target.value):this.filteredRooms=rc(this.rooms,"roomName",e.target.value)},openRoom(e){(e.roomId!==this.room.roomId||this.isMobile)&&(this.isMobile||(this.selectedRoomId=e.roomId),this.$emit("fetch-room",{room:e}))},loadMoreRooms(){if(!this.loadingMoreRooms){if(this.roomsLoaded)return this.loadingMoreRooms=!1,void(this.showLoader=!1);this.$emit("fetch-more-rooms"),this.loadingMoreRooms=!0}}}},cc={key:0,class:"vac-rooms-empty"},dc={key:1,id:"rooms-list",class:"vac-room-list"},uc=["id","onClick"],mc={key:0,id:"infinite-loader-rooms"};var pc=Bn(lc,[["render",function(e,t,s,a,o,n){const r=qs("rooms-search"),i=qs("loader"),l=qs("room-content");return $s((Na(),$a("div",{class:Ue(["vac-rooms-container",{"vac-rooms-container-full":s.isMobile,"vac-app-border-r":!s.isMobile}])},[Zs(e.$slots,"rooms-header"),Zs(e.$slots,"rooms-list-search",{},()=>[Ga(r,{rooms:s.rooms,"loading-rooms":s.loadingRooms,"text-messages":s.textMessages,"show-search":s.showSearch,"show-add-room":s.showAddRoom,onSearchRoom:n.searchRoom,onAddRoom:t[0]||(t[0]=t=>e.$emit("add-room"))},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["rooms","loading-rooms","text-messages","show-search","show-add-room","onSearchRoom"])]),Ga(i,{show:s.loadingRooms,type:"rooms"},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["show"]),s.loadingRooms||s.rooms.length?Ja("",!0):(Na(),$a("div",cc,[Zs(e.$slots,"rooms-empty",{},()=>[Qa(Ve(s.textMessages.ROOMS_EMPTY),1)])])),s.loadingRooms?Ja("",!0):(Na(),$a("div",dc,[(Na(!0),$a(Oa,null,Ks(o.filteredRooms,a=>(Na(),$a("div",{id:a.roomId,key:a.roomId,class:Ue(["vac-room-item",{"vac-room-selected":o.selectedRoomId===a.roomId}]),onClick:e=>n.openRoom(a)},[Ga(l,{"current-user-id":s.currentUserId,room:a,"text-formatting":s.textFormatting,"link-options":s.linkOptions,"text-messages":s.textMessages,"room-actions":s.roomActions,onRoomActionHandler:t[1]||(t[1]=t=>e.$emit("room-action-handler",t))},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["current-user-id","room","text-formatting","link-options","text-messages","room-actions"])],10,uc))),128)),Ga(Wo,{name:"vac-fade-message"},{default:ss(()=>[s.rooms.length&&!s.loadingRooms?(Na(),$a("div",mc,[Ga(i,{show:o.showLoader,infinite:!0,type:"infinite-rooms"},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["show"])])):Ja("",!0)]),_:3})]))],2)),[[Mn,s.showRoomsList]])}]]);const hc={name:"RoomHeader",components:{SvgIcon:Un},directives:{clickOutside:Dl},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},room:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},messageSelectionActions:{type:Array,required:!0},selectedMessagesTotal:{type:Number,required:!0}},emits:["toggle-rooms-list","room-info","menu-action-handler","cancel-message-selection","message-selection-action-handler"],data:()=>({menuOpened:!1,messageSelectionAnimationEnded:!0}),computed:{typingUsers(){return $l(this.room,this.currentUserId,this.textMessages)},userStatus(){if(!this.room.users||2!==this.room.users.length)return;const e=this.room.users.find(e=>e._id!==this.currentUserId);if(!(null==e?void 0:e.status))return;let t="";return"online"===e.status.state?t=this.textMessages.IS_ONLINE:e.status.lastChanged&&(t=this.textMessages.LAST_SEEN+e.status.lastChanged),t}},watch:{messageSelectionEnabled(e){e?this.messageSelectionAnimationEnded=!1:setTimeout(()=>{this.messageSelectionAnimationEnded=!0},300)}},methods:{menuActionHandler(e){this.closeMenu(),this.$emit("menu-action-handler",e)},closeMenu(){this.menuOpened=!1},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",e)}}},fc={class:"vac-room-header vac-app-border-b"},gc={class:"vac-room-wrapper"},_c={key:0,class:"vac-room-selection"},vc=["id"],bc=["onClick"],yc={class:"vac-selection-button-count"},xc={class:"vac-text-ellipsis"},wc={class:"vac-room-name vac-text-ellipsis"},kc={key:0,class:"vac-room-info vac-text-ellipsis"},Sc={key:1,class:"vac-room-info vac-text-ellipsis"},Mc={key:0,class:"vac-menu-options"},Ac={class:"vac-menu-list"},Rc=["onClick"];var Tc=Bn(hc,[["render",function(e,t,s,a,o,n){const r=qs("svg-icon"),i=zs("click-outside");return Na(),$a("div",fc,[Zs(e.$slots,"room-header",{},()=>[Ka("div",gc,[Ga(Wo,{name:"vac-slide-up"},{default:ss(()=>[s.messageSelectionEnabled?(Na(),$a("div",_c,[(Na(!0),$a(Oa,null,Ks(s.messageSelectionActions,e=>(Na(),$a("div",{id:e.name,key:e.name},[Ka("div",{class:"vac-selection-button",onClick:t=>n.messageSelectionActionHandler(e)},[Qa(Ve(e.title)+" ",1),Ka("span",yc,Ve(s.selectedMessagesTotal),1)],8,bc)],8,vc))),128)),Ka("div",{class:"vac-selection-cancel vac-item-clickable",onClick:t[0]||(t[0]=t=>e.$emit("cancel-message-selection"))},Ve(s.textMessages.CANCEL_SELECT_MESSAGE),1)])):Ja("",!0)]),_:1}),!s.messageSelectionEnabled&&o.messageSelectionAnimationEnded?(Na(),$a(Oa,{key:0},[s.singleRoom?Ja("",!0):(Na(),$a("div",{key:0,class:Ue(["vac-svg-button vac-toggle-button",{"vac-rotate-icon-init":!s.isMobile,"vac-rotate-icon":!s.showRoomsList&&!s.isMobile}]),onClick:t[1]||(t[1]=t=>e.$emit("toggle-rooms-list"))},[Zs(e.$slots,"toggle-icon",{},()=>[Ga(r,{name:"toggle"})])],2)),Ka("div",{class:Ue(["vac-info-wrapper",{"vac-item-clickable":s.roomInfoEnabled}]),onClick:t[2]||(t[2]=t=>e.$emit("room-info"))},[Zs(e.$slots,"room-header-avatar",{},()=>[s.room.avatar?(Na(),$a("div",{key:0,class:"vac-avatar",style:He({"background-image":`url('${s.room.avatar}')`})},null,4)):Ja("",!0)]),Zs(e.$slots,"room-header-info",{},()=>[Ka("div",xc,[Ka("div",wc,Ve(s.room.roomName),1),n.typingUsers?(Na(),$a("div",kc,Ve(n.typingUsers),1)):(Na(),$a("div",Sc,Ve(n.userStatus),1))])])],2),s.room.roomId?Zs(e.$slots,"room-options",{key:1},()=>[s.menuActions.length?(Na(),$a("div",{key:0,class:"vac-svg-button vac-room-options",onClick:t[3]||(t[3]=e=>o.menuOpened=!o.menuOpened)},[Zs(e.$slots,"menu-icon",{},()=>[Ga(r,{name:"menu"})])])):Ja("",!0),s.menuActions.length?(Na(),Ua(Wo,{key:1,name:"vac-slide-left"},{default:ss(()=>[o.menuOpened?$s((Na(),$a("div",Mc,[Ka("div",Ac,[(Na(!0),$a(Oa,null,Ks(s.menuActions,e=>(Na(),$a("div",{key:e.name},[Ka("div",{class:"vac-menu-item",onClick:t=>n.menuActionHandler(e)},Ve(e.title),9,Rc)]))),128))])])),[[i,n.closeMenu]]):Ja("",!0)]),_:1})):Ja("",!0)]):Ja("",!0)],64)):Ja("",!0)])])])}]]);function Ec(e){if("string"!=typeof e||!e)throw new Error("expected a non-empty string, got: "+e)}function Bc(e){if("number"!=typeof e)throw new Error("expected a number, got: "+e)}const Oc="eTag",Cc="url";function jc(e){return function(e,t){const s=new Set,a=[];for(const o of e){const e=t(o);s.has(e)||(s.add(e),a.push(o))}return a}(e,e=>e.unicode)}const Ic={},Lc={},Pc={};function Nc(e,t,s){s.onerror=()=>t(s.error),s.onblocked=()=>t(new Error("IDB blocked")),s.onsuccess=()=>e(s.result)}async function Hc(e){const t=await new Promise((t,s)=>{const a=indexedDB.open(e,1);Ic[e]=a,a.onupgradeneeded=e=>{e.oldVersion<1&&function(e){function t(t,s,a){const o=s?e.createObjectStore(t,{keyPath:s}):e.createObjectStore(t);if(a)for(const[e,[t,s]]of Object.entries(a))o.createIndex(e,t,{multiEntry:s});return o}t("keyvalue"),t("emoji","unicode",{tokens:["tokens",!0],"group-order":[["group","order"]],skinUnicodes:["skinUnicodes",!0]}),t("favorites",void 0,{count:[""]})}(a.result)},Nc(t,s,a)});return t.onclose=()=>Dc(e),t}function Fc(e,t,s,a){return new Promise((o,n)=>{const r=e.transaction(t,s,{durability:"relaxed"}),i="string"==typeof t?r.objectStore(t):t.map(e=>r.objectStore(e));let l;a(i,r,e=>{l=e}),r.oncomplete=()=>o(l),r.onerror=()=>n(r.error)})}function Dc(e){const t=Ic[e],s=t&&t.result;if(s){s.close();const t=Pc[e];if(t)for(const e of t)e()}delete Ic[e],delete Lc[e],delete Pc[e]}const $c=new Set([":D","XD",":'D","O:)",":X",":P",";P","XP",":L",":Z",":j","8D","XO","8)",":B",":O",":S",":'o","Dx","X(","D:",":C",">0)",":3","</3","<3","\\M/",":E","8#"]);function Uc(e){return e.split(/[\s_]+/).map(e=>!e.match(/\w/)||$c.has(e)?e.toLowerCase():e.replace(/[)(:,]/g,"").replace(/’/g,"'").toLowerCase()).filter(Boolean)}function qc(e){return e.filter(Boolean).map(e=>e.toLowerCase()).filter(e=>e.length>=2)}function Vc(e,t,s,a){e[t](s).onsuccess=e=>a&&a(e.target.result)}function zc(e,t,s){Vc(e,"get",t,s)}function Xc(e,t,s){Vc(e,"getAll",t,s)}function Yc(e){e.commit&&e.commit()}function Kc(e,t){const s=function(e,t){let s=e[0];for(let a=1;a<e.length;a++){const o=e[a];t(s)>t(o)&&(s=o)}return s}(e,e=>e.length),a=[];for(const o of s)e.some(e=>-1===e.findIndex(e=>t(e)===t(o)))||a.push(o);return a}async function Gc(e,t,s,a){try{const o=function(e){return e.map(({annotation:e,emoticon:t,group:s,order:a,shortcodes:o,skins:n,tags:r,emoji:i,version:l})=>{const c=[...new Set(qc([...(o||[]).map(Uc).flat(),...r.map(Uc).flat(),...Uc(e),t]))].sort(),d={annotation:e,group:s,order:a,tags:r,tokens:c,unicode:i,version:l};if(t&&(d.emoticon=t),o&&(d.shortcodes=o),n){d.skinTones=[],d.skinUnicodes=[],d.skinVersions=[];for(const{tone:e,emoji:t,version:s}of n)d.skinTones.push(e),d.skinUnicodes.push(t),d.skinVersions.push(s)}return d})}(t);await Fc(e,["emoji","keyvalue"],"readwrite",([e,t],n)=>{let r,i,l=0;function c(){2==++l&&function(){if(r===a&&i===s)return;e.clear();for(const t of o)e.put(t);t.put(a,Oc),t.put(s,Cc),Yc(n)}()}zc(t,Oc,e=>{r=e,c()}),zc(t,Cc,e=>{i=e,c()})})}finally{}}async function Zc(e,t){const s=qc(Uc(t));return s.length?Fc(e,"emoji","readonly",(e,t,a)=>{const o=[],n=()=>{const e=Kc(o,e=>e.unicode);a(e.sort((e,t)=>e.order<t.order?-1:1))};for(let t=0;t<s.length;t++){const a=s[t],r=t===s.length-1?IDBKeyRange.bound(a,a+"￿",!1,!0):IDBKeyRange.only(a);Xc(e.index("tokens"),r,e=>{o.push(e),o.length===s.length&&n()})}}):[]}async function Wc(e,t){const s=await Zc(e,t);if(!s.length){const s=e=>(e.shortcodes||[]).includes(t.toLowerCase());return await async function(e,t){return Fc(e,"emoji","readonly",(e,s,a)=>{let o;const n=()=>{e.getAll(o&&IDBKeyRange.lowerBound(o,!0),50).onsuccess=e=>{const s=e.target.result;for(const e of s)if(o=e.unicode,t(e))return a(e);if(s.length<50)return a();n()}};n()})}(e,s)||null}return s.filter(e=>(e.shortcodes||[]).map(e=>e.toLowerCase()).includes(t.toLowerCase()))[0]||null}function Qc(e,t,s){return Fc(e,t,"readonly",(e,t,a)=>zc(e,s,a))}const Jc=["name","url"];function ed(e){!function(e){const t=e&&Array.isArray(e),s=t&&e.length&&(!e[0]||Jc.some(t=>!(t in e[0])));if(!t||s)throw new Error("Custom emojis are in the wrong format")}(e);const t=(e,t)=>e.name.toLowerCase()<t.name.toLowerCase()?-1:1,s=e.sort(t),a=function(e,t){const s=new Map;for(const a of e){const e=t(a);for(const t of e){let e=s;for(let s=0;s<t.length;s++){const a=t.charAt(s);let o=e.get(a);o||(o=new Map,e.set(a,o)),e=o}let o=e.get("");o||(o=[],e.set("",o)),o.push(a)}}return(e,t)=>{let a=s;for(let t=0;t<e.length;t++){const s=e.charAt(t),o=a.get(s);if(!o)return[];a=o}if(t){return a.get("")||[]}const o=[],n=[a];for(;n.length;){const e=[...n.shift().entries()].sort((e,t)=>e[0]<t[0]?-1:1);for(const[t,s]of e)""===t?o.push(...s):n.push(s)}return o}}(e,e=>[...new Set((e.shortcodes||[]).map(e=>Uc(e)).flat())]),o=e=>a(e,!0),n=e=>a(e,!1),r=new Map,i=new Map;for(const t of e){i.set(t.name.toLowerCase(),t);for(const e of t.shortcodes||[])r.set(e.toLowerCase(),t)}return{all:s,search:e=>{const s=Uc(e);return Kc(s.map((e,t)=>(t<s.length-1?o:n)(e)),e=>e.name).sort(t)},byShortcode:e=>r.get(e.toLowerCase()),byName:e=>i.get(e.toLowerCase())}}function td(e){if(!e)return e;if(delete e.tokens,e.skinTones){const t=e.skinTones.length;e.skins=Array(t);for(let s=0;s<t;s++)e.skins[s]={tone:e.skinTones[s],unicode:e.skinUnicodes[s],version:e.skinVersions[s]};delete e.skinTones,delete e.skinUnicodes,delete e.skinVersions}return e}function sd(e){e||console.warn("emoji-picker-element is more efficient if the dataSource server exposes an ETag header.")}const ad=["annotation","emoji","group","order","tags","version"];function od(e,t){if(2!==Math.floor(e.status/100))throw new Error("Failed to fetch: "+t+":  "+e.status)}async function nd(e){const t=await fetch(e);od(t,e);const s=t.headers.get("etag");sd(s);const a=await t.json();return function(e){if(!e||!Array.isArray(e)||!e[0]||"object"!=typeof e[0]||ad.some(t=>!(t in e[0])))throw new Error("Emoji data is in the wrong format")}(a),[s,a]}async function rd(e){const t=function(e){for(var t=e.length,s=new ArrayBuffer(t),a=new Uint8Array(s),o=-1;++o<t;)a[o]=e.charCodeAt(o);return s}(JSON.stringify(e)),s=function(e){for(var t="",s=new Uint8Array(e),a=s.byteLength,o=-1;++o<a;)t+=String.fromCharCode(s[o]);return t}(await crypto.subtle.digest("SHA-1",t));return btoa(s)}async function id(e,t){let s,a=await async function(e){const t=await fetch(e,{method:"HEAD"});od(t,e);const s=t.headers.get("etag");return sd(s),s}(t);if(!a){const e=await nd(t);a=e[0],s=e[1],a||(a=await rd(s))}if(await async function(e,t,s){const[a,o]=await Promise.all([Oc,Cc].map(t=>Qc(e,"keyvalue",t)));return a===s&&o===t}(e,t,a));else{if(!s){s=(await nd(t))[1]}await Gc(e,s,t,a)}}class ld{constructor({dataSource:e="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",locale:t="en",customEmoji:s=[]}={}){this.dataSource=e,this.locale=t,this._dbName="emoji-picker-element-"+this.locale,this._db=void 0,this._lazyUpdate=void 0,this._custom=ed(s),this._clear=this._clear.bind(this),this._ready=this._init()}async _init(){const e=this._db=await(t=this._dbName,Lc[t]||(Lc[t]=Hc(t)),Lc[t]);var t;!function(e,t){let s=Pc[e];s||(s=Pc[e]=[]),s.push(t)}(this._dbName,this._clear);const s=this.dataSource;await async function(e){return!await Qc(e,"keyvalue",Cc)}(e)?await async function(e,t){let[s,a]=await nd(t);s||(s=await rd(a)),await Gc(e,a,t,s)}(e,s):this._lazyUpdate=id(e,s)}async ready(){const e=async()=>(this._ready||(this._ready=this._init()),this._ready);await e(),this._db||await e()}async getEmojiByGroup(e){return Bc(e),await this.ready(),jc(await async function(e,t){return Fc(e,"emoji","readonly",(e,s,a)=>{const o=IDBKeyRange.bound([t,0],[t+1,0],!1,!0);Xc(e.index("group-order"),o,a)})}(this._db,e)).map(td)}async getEmojiBySearchQuery(e){Ec(e),await this.ready();return[...this._custom.search(e),...jc(await Zc(this._db,e)).map(td)]}async getEmojiByShortcode(e){Ec(e),await this.ready();const t=this._custom.byShortcode(e);return t||td(await Wc(this._db,e))}async getEmojiByUnicodeOrName(e){Ec(e),await this.ready();const t=this._custom.byName(e);return t||td(await async function(e,t){return Fc(e,"emoji","readonly",(e,s,a)=>zc(e,t,s=>{if(s)return a(s);zc(e.index("skinUnicodes"),t,e=>a(e||null))}))}(this._db,e))}async getPreferredSkinTone(){return await this.ready(),await Qc(this._db,"keyvalue","skinTone")||0}async setPreferredSkinTone(e){return Bc(e),await this.ready(),t=this._db,s="skinTone",a=e,Fc(t,"keyvalue","readwrite",(e,t)=>{e.put(a,s),Yc(t)});var t,s,a}async incrementFavoriteEmojiCount(e){return Ec(e),await this.ready(),t=this._db,s=e,Fc(t,"favorites","readwrite",(e,t)=>zc(e,s,a=>{e.put((a||0)+1,s),Yc(t)}));var t,s}async getTopFavoriteEmoji(e){return Bc(e),await this.ready(),(await function(e,t,s){return 0===s?[]:Fc(e,["favorites","emoji"],"readonly",([e,a],o,n)=>{const r=[];e.index("count").openCursor(void 0,"prev").onsuccess=e=>{const o=e.target.result;if(!o)return n(r);function i(e){if(r.push(e),r.length===s)return n(r);o.continue()}const l=o.primaryKey,c=t.byName(l);if(c)return i(c);zc(a,l,e=>{if(e)return i(e);o.continue()})}})}(this._db,this._custom,e)).map(td)}set customEmoji(e){this._custom=ed(e)}get customEmoji(){return this._custom.all}async _shutdown(){await this.ready();try{await this._lazyUpdate}catch(e){}}_clear(){this._db=this._ready=this._lazyUpdate=void 0}async close(){await this._shutdown(),await Dc(this._dbName)}async delete(){var e;await this._shutdown(),await(e=this._dbName,new Promise((t,s)=>{Dc(e),Nc(t,s,indexedDB.deleteDatabase(e))}))}}function cd(){}function dd(e){return e()}function ud(){return Object.create(null)}function md(e){e.forEach(dd)}function pd(e){return"function"==typeof e}function hd(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let fd,gd;function _d(e,t){return fd||(fd=document.createElement("a")),fd.href=t,e===fd.href}function vd(e,t){e.appendChild(t)}function bd(e,t,s){e.insertBefore(t,s||null)}function yd(e){e.parentNode.removeChild(e)}function xd(e){return document.createElement(e)}function wd(e){return document.createTextNode(e)}function kd(e,t,s,a){return e.addEventListener(t,s,a),()=>e.removeEventListener(t,s,a)}function Sd(e,t,s){null==s?e.removeAttribute(t):e.getAttribute(t)!==s&&e.setAttribute(t,s)}function Md(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function Ad(e,t){e.value=null==t?"":t}function Rd(e,t,s,a){null===s?e.style.removeProperty(t):e.style.setProperty(t,s,a?"important":"")}function Td(e){gd=e}const Ed=[],Bd=[],Od=[],Cd=[],jd=Promise.resolve();let Id=!1;function Ld(){Id||(Id=!0,jd.then(Fd))}function Pd(e){Od.push(e)}const Nd=new Set;let Hd=0;function Fd(){const e=gd;do{for(;Hd<Ed.length;){const e=Ed[Hd];Hd++,Td(e),Dd(e.$$)}for(Td(null),Ed.length=0,Hd=0;Bd.length;)Bd.pop()();for(let e=0;e<Od.length;e+=1){const t=Od[e];Nd.has(t)||(Nd.add(t),t())}Od.length=0}while(Ed.length);for(;Cd.length;)Cd.pop()();Id=!1,Nd.clear(),Td(e)}function Dd(e){if(null!==e.fragment){e.update(),md(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Pd)}}const $d=new Set;const Ud="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function qd(e,t){e.d(1),t.delete(e.key)}function Vd(e,t,s,a,o,n,r,i,l,c,d,u){let m=e.length,p=n.length,h=m;const f={};for(;h--;)f[e[h].key]=h;const g=[],_=new Map,v=new Map;for(h=p;h--;){const e=u(o,n,h),i=s(e);let l=r.get(i);l?a&&l.p(e,t):(l=c(i,e),l.c()),_.set(i,g[h]=l),i in f&&v.set(i,Math.abs(h-f[i]))}const b=new Set,y=new Set;function x(e){!function(e,t){e&&e.i&&($d.delete(e),e.i(t))}(e,1),e.m(i,d),r.set(e.key,e),d=e.first,p--}for(;m&&p;){const t=g[p-1],s=e[m-1],a=t.key,o=s.key;t===s?(d=t.first,m--,p--):_.has(o)?!r.has(a)||b.has(a)?x(t):y.has(o)?m--:v.get(a)>v.get(o)?(y.add(a),x(t)):(b.add(o),m--):(l(s,r),m--)}for(;m--;){const t=e[m];_.has(t.key)||l(t,r)}for(;p;)x(g[p-1]);return g}function zd(e,t,s,a,o,n,r,i=[-1]){const l=gd;Td(e);const c=e.$$={fragment:null,ctx:null,props:n,update:cd,not_equal:o,bound:ud(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:ud(),dirty:i,skip_bound:!1,root:t.target||l.$$.root};r&&r(c.root);let d=!1;c.ctx=s?s(e,t.props||{},(t,s,...a)=>{const n=a.length?a[0]:s;return c.ctx&&o(c.ctx[t],c.ctx[t]=n)&&(!c.skip_bound&&c.bound[t]&&c.bound[t](n),d&&function(e,t){-1===e.$$.dirty[0]&&(Ed.push(e),Ld(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(e,t)),s}):[],c.update(),d=!0,md(c.before_update),c.fragment=!!a&&a(c.ctx),t.target&&(c.fragment&&c.fragment.c(),function(e,t,s,a){const{fragment:o,on_mount:n,on_destroy:r,after_update:i}=e.$$;o&&o.m(t,s),a||Pd(()=>{const t=n.map(dd).filter(pd);r?r.push(...t):md(t),e.$$.on_mount=[]}),i.forEach(Pd)}(e,t.target,void 0,void 0),Fd()),Td(l)}const Xd=[[-1,"✨","custom"],[0,"😀","smileys-emotion"],[1,"👋","people-body"],[3,"🐱","animals-nature"],[4,"🍎","food-drink"],[5,"🏠️","travel-places"],[6,"⚽","activities"],[7,"📝","objects"],[8,"⛔️","symbols"],[9,"🏁","flags"]].map(([e,t,s])=>({id:e,emoji:t,name:s})),Yd=Xd.slice(1),Kd=Xd[0],Gd="function"==typeof requestIdleCallback?requestIdleCallback:setTimeout;function Zd(e){return e.unicode.includes("‍")}const Wd={"🫠":14,"🥲":13.1,"🥻":12.1,"🥰":11,"🤩":5,"👱‍♀️":4,"🤣":3,"👁️‍🗨️":2,"😀":1,"😐️":.7,"😃":.6},Qd=["😊","😒","♥️","👍️","😍","😂","😭","☺️","😔","😩","😏","💕","🙌","😘"],Jd='"Twemoji Mozilla","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji","EmojiOne Color","Android Emoji",sans-serif',eu=(e,t)=>e<t?-1:e>t?1:0,tu=(e,t)=>{const s=document.createElement("canvas");s.width=s.height=1;const a=s.getContext("2d");return a.textBaseline="top",a.font="100px "+Jd,a.fillStyle=t,a.scale(.01,.01),a.fillText(e,0,0),a.getImageData(0,0,1,1).data};function su(e){const t=tu(e,"#000"),s=tu(e,"#fff");return t&&s&&((e,t)=>{const s=[...e].join(",");return s===[...t].join(",")&&!s.startsWith("0,0,0,")})(t,s)}const au=new Promise(e=>Gd(()=>e(function(){const e=Object.entries(Wd);try{for(const[t,s]of e)if(su(t))return s}catch(e){}return e[0][1]}()))),ou=new Map;function nu(e){e.preventDefault(),e.stopPropagation()}function ru(e,t,s){return(t+=e?-1:1)<0?t=s.length-1:t>=s.length&&(t=0),t}function iu(e,t){const s=new Set,a=[];for(const o of e){const e=t(o);s.has(e)||(s.add(e),a.push(o))}return a}const lu=requestAnimationFrame;let cu,du="function"==typeof ResizeObserver;function uu(e){{const t=document.createRange();return t.selectNode(e.firstChild),t.getBoundingClientRect().width}}const{Map:mu}=Ud;function pu(e,t,s){const a=e.slice();return a[63]=t[s],a[65]=s,a}function hu(e,t,s){const a=e.slice();return a[66]=t[s],a[65]=s,a}function fu(e,t,s){const a=e.slice();return a[63]=t[s],a[65]=s,a}function gu(e,t,s){const a=e.slice();return a[69]=t[s],a}function _u(e,t,s){const a=e.slice();return a[72]=t[s],a[65]=s,a}function vu(e,t){let s,a,o,n,r,i,l,c=t[72]+"";return{key:e,first:null,c(){s=xd("div"),a=wd(c),Sd(s,"id",o="skintone-"+t[65]),Sd(s,"class",n="emoji hide-focus "+(t[65]===t[20]?"active":"")),Sd(s,"aria-selected",r=t[65]===t[20]),Sd(s,"role","option"),Sd(s,"title",i=t[0].skinTones[t[65]]),Sd(s,"tabindex","-1"),Sd(s,"aria-label",l=t[0].skinTones[t[65]]),this.first=s},m(e,t){bd(e,s,t),vd(s,a)},p(e,d){t=e,512&d[0]&&c!==(c=t[72]+"")&&Md(a,c),512&d[0]&&o!==(o="skintone-"+t[65])&&Sd(s,"id",o),1049088&d[0]&&n!==(n="emoji hide-focus "+(t[65]===t[20]?"active":""))&&Sd(s,"class",n),1049088&d[0]&&r!==(r=t[65]===t[20])&&Sd(s,"aria-selected",r),513&d[0]&&i!==(i=t[0].skinTones[t[65]])&&Sd(s,"title",i),513&d[0]&&l!==(l=t[0].skinTones[t[65]])&&Sd(s,"aria-label",l)},d(e){e&&yd(s)}}}function bu(e,t){let s,a,o,n,r,i,l,c,d,u=t[69].emoji+"";function m(){return t[49](t[69])}return{key:e,first:null,c(){s=xd("button"),a=xd("div"),o=wd(u),Sd(a,"class","nav-emoji emoji"),Sd(s,"role","tab"),Sd(s,"class","nav-button"),Sd(s,"aria-controls",n="tab-"+t[69].id),Sd(s,"aria-label",r=t[0].categories[t[69].name]),Sd(s,"aria-selected",i=!t[4]&&t[13].id===t[69].id),Sd(s,"title",l=t[0].categories[t[69].name]),this.first=s},m(e,t){bd(e,s,t),vd(s,a),vd(a,o),c||(d=kd(s,"click",m),c=!0)},p(e,a){t=e,4096&a[0]&&u!==(u=t[69].emoji+"")&&Md(o,u),4096&a[0]&&n!==(n="tab-"+t[69].id)&&Sd(s,"aria-controls",n),4097&a[0]&&r!==(r=t[0].categories[t[69].name])&&Sd(s,"aria-label",r),12304&a[0]&&i!==(i=!t[4]&&t[13].id===t[69].id)&&Sd(s,"aria-selected",i),4097&a[0]&&l!==(l=t[0].categories[t[69].name])&&Sd(s,"title",l)},d(e){e&&yd(s),c=!1,d()}}}function yu(e){let t,s;return{c(){t=xd("img"),Sd(t,"class","custom-emoji"),_d(t.src,s=e[63].url)||Sd(t,"src",s),Sd(t,"alt",""),Sd(t,"loading","lazy")},m(e,s){bd(e,t,s)},p(e,a){32768&a[0]&&!_d(t.src,s=e[63].url)&&Sd(t,"src",s)},d(e){e&&yd(t)}}}function xu(e){let t,s=e[27](e[63],e[8])+"";return{c(){t=wd(s)},m(e,s){bd(e,t,s)},p(e,a){33024&a[0]&&s!==(s=e[27](e[63],e[8])+"")&&Md(t,s)},d(e){e&&yd(t)}}}function wu(e,t){let s,a,o,n,r,i,l;function c(e,t){return e[63].unicode?xu:yu}let d=c(t),u=d(t);return{key:e,first:null,c(){s=xd("button"),u.c(),Sd(s,"role",a=t[4]?"option":"menuitem"),Sd(s,"aria-selected",o=t[4]?t[65]==t[5]:""),Sd(s,"aria-label",n=t[28](t[63],t[8])),Sd(s,"title",r=t[63].title),Sd(s,"class",i="emoji "+(t[4]&&t[65]===t[5]?"active":"")),Sd(s,"id",l="emo-"+t[63].id),this.first=s},m(e,t){bd(e,s,t),u.m(s,null)},p(e,m){d===(d=c(t=e))&&u?u.p(t,m):(u.d(1),u=d(t),u&&(u.c(),u.m(s,null))),16&m[0]&&a!==(a=t[4]?"option":"menuitem")&&Sd(s,"role",a),32816&m[0]&&o!==(o=t[4]?t[65]==t[5]:"")&&Sd(s,"aria-selected",o),33024&m[0]&&n!==(n=t[28](t[63],t[8]))&&Sd(s,"aria-label",n),32768&m[0]&&r!==(r=t[63].title)&&Sd(s,"title",r),32816&m[0]&&i!==(i="emoji "+(t[4]&&t[65]===t[5]?"active":""))&&Sd(s,"class",i),32768&m[0]&&l!==(l="emo-"+t[63].id)&&Sd(s,"id",l)},d(e){e&&yd(s),u.d()}}}function ku(e,t){let s,a,o,n,r,i,l,c,d=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"",u=[],m=new mu,p=t[66].emojis;const h=e=>e[63].id;for(let e=0;e<p.length;e+=1){let s=fu(t,p,e),a=h(s);m.set(a,u[e]=wu(a,s))}return{key:e,first:null,c(){s=xd("div"),a=wd(d),r=xd("div");for(let e=0;e<u.length;e+=1)u[e].c();Sd(s,"id",o="menu-label-"+t[65]),Sd(s,"class",n="category "+(1===t[15].length&&""===t[15][0].category?"gone":"")),Sd(s,"aria-hidden","true"),Sd(r,"class","emoji-menu"),Sd(r,"role",i=t[4]?"listbox":"menu"),Sd(r,"aria-labelledby",l="menu-label-"+t[65]),Sd(r,"id",c=t[4]?"search-results":""),this.first=s},m(e,t){bd(e,s,t),vd(s,a),bd(e,r,t);for(let e=0;e<u.length;e+=1)u[e].m(r,null)},p(e,f){t=e,40977&f[0]&&d!==(d=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"")&&Md(a,d),32768&f[0]&&o!==(o="menu-label-"+t[65])&&Sd(s,"id",o),32768&f[0]&&n!==(n="category "+(1===t[15].length&&""===t[15][0].category?"gone":""))&&Sd(s,"class",n),402686256&f[0]&&(p=t[66].emojis,u=Vd(u,f,h,1,t,p,m,r,qd,wu,null,fu)),16&f[0]&&i!==(i=t[4]?"listbox":"menu")&&Sd(r,"role",i),32768&f[0]&&l!==(l="menu-label-"+t[65])&&Sd(r,"aria-labelledby",l),16&f[0]&&c!==(c=t[4]?"search-results":"")&&Sd(r,"id",c)},d(e){e&&yd(s),e&&yd(r);for(let e=0;e<u.length;e+=1)u[e].d()}}}function Su(e){let t,s;return{c(){t=xd("img"),Sd(t,"class","custom-emoji"),_d(t.src,s=e[63].url)||Sd(t,"src",s),Sd(t,"alt",""),Sd(t,"loading","lazy")},m(e,s){bd(e,t,s)},p(e,a){1024&a[0]&&!_d(t.src,s=e[63].url)&&Sd(t,"src",s)},d(e){e&&yd(t)}}}function Mu(e){let t,s=e[27](e[63],e[8])+"";return{c(){t=wd(s)},m(e,s){bd(e,t,s)},p(e,a){1280&a[0]&&s!==(s=e[27](e[63],e[8])+"")&&Md(t,s)},d(e){e&&yd(t)}}}function Au(e,t){let s,a,o,n;function r(e,t){return e[63].unicode?Mu:Su}let i=r(t),l=i(t);return{key:e,first:null,c(){s=xd("button"),l.c(),Sd(s,"role","menuitem"),Sd(s,"aria-label",a=t[28](t[63],t[8])),Sd(s,"title",o=t[63].title),Sd(s,"class","emoji"),Sd(s,"id",n="fav-"+t[63].id),this.first=s},m(e,t){bd(e,s,t),l.m(s,null)},p(e,c){i===(i=r(t=e))&&l?l.p(t,c):(l.d(1),l=i(t),l&&(l.c(),l.m(s,null))),1280&c[0]&&a!==(a=t[28](t[63],t[8]))&&Sd(s,"aria-label",a),1024&c[0]&&o!==(o=t[63].title)&&Sd(s,"title",o),1024&c[0]&&n!==(n="fav-"+t[63].id)&&Sd(s,"id",n)},d(e){e&&yd(s),l.d()}}}function Ru(e){let t,s,a,o,n,r,i,l,c,d,u,m,p,h,f,g,_,v,b,y,x,w,k,S,M,A,R,T,E,B,O,C,j,I,L,P,N,H,F,D,$,U,q,V,z=e[0].searchLabel+"",X=e[0].searchDescription+"",Y=e[0].skinToneDescription+"",K=[],G=new mu,Z=[],W=new mu,Q=[],J=new mu,ee=[],te=new mu,se=e[9];const ae=e=>e[72];for(let t=0;t<se.length;t+=1){let s=_u(e,se,t),a=ae(s);G.set(a,K[t]=vu(a,s))}let oe=e[12];const ne=e=>e[69].id;for(let t=0;t<oe.length;t+=1){let s=gu(e,oe,t),a=ne(s);W.set(a,Z[t]=bu(a,s))}let re=e[15];const ie=e=>e[66].category;for(let t=0;t<re.length;t+=1){let s=hu(e,re,t),a=ie(s);J.set(a,Q[t]=ku(a,s))}let le=e[10];const ce=e=>e[63].id;for(let t=0;t<le.length;t+=1){let s=pu(e,le,t),a=ce(s);te.set(a,ee[t]=Au(a,s))}return{c(){t=xd("section"),s=xd("div"),a=xd("div"),o=xd("div"),n=xd("input"),c=xd("label"),d=wd(z),u=xd("span"),m=wd(X),p=xd("div"),h=xd("button"),f=wd(e[21]),v=xd("span"),b=wd(Y),y=xd("div");for(let e=0;e<K.length;e+=1)K[e].c();M=xd("div");for(let e=0;e<Z.length;e+=1)Z[e].c();R=xd("div"),T=xd("div"),E=xd("div"),B=wd(e[18]),C=xd("div"),j=xd("div");for(let e=0;e<Q.length;e+=1)Q[e].c();H=xd("div");for(let e=0;e<ee.length;e+=1)ee[e].c();$=xd("button"),$.textContent="😀",Sd(s,"class","pad-top"),Sd(n,"id","search"),Sd(n,"class","search"),Sd(n,"type","search"),Sd(n,"role","combobox"),Sd(n,"enterkeyhint","search"),Sd(n,"placeholder",r=e[0].searchLabel),Sd(n,"autocapitalize","none"),Sd(n,"autocomplete","off"),Sd(n,"spellcheck","true"),Sd(n,"aria-expanded",i=!(!e[4]||!e[1].length)),Sd(n,"aria-controls","search-results"),Sd(n,"aria-describedby","search-description"),Sd(n,"aria-autocomplete","list"),Sd(n,"aria-activedescendant",l=e[26]?"emo-"+e[26]:""),Sd(c,"class","sr-only"),Sd(c,"for","search"),Sd(u,"id","search-description"),Sd(u,"class","sr-only"),Sd(o,"class","search-wrapper"),Sd(h,"id","skintone-button"),Sd(h,"class",g="emoji "+(e[6]?"hide-focus":"")),Sd(h,"aria-label",e[23]),Sd(h,"title",e[23]),Sd(h,"aria-describedby","skintone-description"),Sd(h,"aria-haspopup","listbox"),Sd(h,"aria-expanded",e[6]),Sd(h,"aria-controls","skintone-list"),Sd(p,"class",_="skintone-button-wrapper "+(e[19]?"expanded":"")),Sd(v,"id","skintone-description"),Sd(v,"class","sr-only"),Sd(y,"id","skintone-list"),Sd(y,"class",x="skintone-list "+(e[6]?"":"hidden no-animate")),Rd(y,"transform","translateY("+(e[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),Sd(y,"role","listbox"),Sd(y,"aria-label",w=e[0].skinTonesLabel),Sd(y,"aria-activedescendant",k="skintone-"+e[20]),Sd(y,"aria-hidden",S=!e[6]),Sd(a,"class","search-row"),Sd(M,"class","nav"),Sd(M,"role","tablist"),Rd(M,"grid-template-columns","repeat("+e[12].length+", 1fr)"),Sd(M,"aria-label",A=e[0].categoriesLabel),Sd(T,"class","indicator"),Rd(T,"transform","translateX("+(e[24]?-1:1)*e[11]*100+"%)"),Sd(R,"class","indicator-wrapper"),Sd(E,"class",O="message "+(e[18]?"":"gone")),Sd(E,"role","alert"),Sd(E,"aria-live","polite"),Sd(C,"class",I="tabpanel "+(!e[14]||e[18]?"gone":"")),Sd(C,"role",L=e[4]?"region":"tabpanel"),Sd(C,"aria-label",P=e[4]?e[0].searchResultsLabel:e[0].categories[e[13].name]),Sd(C,"id",N=e[4]?"":"tab-"+e[13].id),Sd(C,"tabindex","0"),Sd(H,"class",F="favorites emoji-menu "+(e[18]?"gone":"")),Sd(H,"role","menu"),Sd(H,"aria-label",D=e[0].favoritesLabel),Rd(H,"padding-inline-end",e[25]+"px"),Sd($,"aria-hidden","true"),Sd($,"tabindex","-1"),Sd($,"class","abs-pos hidden emoji"),Sd(t,"class","picker"),Sd(t,"aria-label",U=e[0].regionLabel),Sd(t,"style",e[22])},m(r,i){bd(r,t,i),vd(t,s),vd(t,a),vd(a,o),vd(o,n),Ad(n,e[2]),vd(o,c),vd(c,d),vd(o,u),vd(u,m),vd(a,p),vd(p,h),vd(h,f),vd(a,v),vd(v,b),vd(a,y);for(let e=0;e<K.length;e+=1)K[e].m(y,null);e[48](y),vd(t,M);for(let e=0;e<Z.length;e+=1)Z[e].m(M,null);vd(t,R),vd(R,T),vd(t,E),vd(E,B),vd(t,C),vd(C,j);for(let e=0;e<Q.length;e+=1)Q[e].m(j,null);e[50](C),vd(t,H);for(let e=0;e<ee.length;e+=1)ee[e].m(H,null);var l;vd(t,$),e[51]($),e[52](t),q||(V=[kd(n,"input",e[47]),kd(n,"keydown",e[30]),kd(h,"click",e[35]),kd(y,"focusout",e[38]),kd(y,"click",e[34]),kd(y,"keydown",e[36]),kd(y,"keyup",e[37]),kd(M,"keydown",e[32]),(l=e[29].call(null,j),l&&pd(l.destroy)?l.destroy:cd),kd(C,"click",e[33]),kd(H,"click",e[33])],q=!0)},p(e,s){1&s[0]&&r!==(r=e[0].searchLabel)&&Sd(n,"placeholder",r),18&s[0]&&i!==(i=!(!e[4]||!e[1].length))&&Sd(n,"aria-expanded",i),67108864&s[0]&&l!==(l=e[26]?"emo-"+e[26]:"")&&Sd(n,"aria-activedescendant",l),4&s[0]&&Ad(n,e[2]),1&s[0]&&z!==(z=e[0].searchLabel+"")&&Md(d,z),1&s[0]&&X!==(X=e[0].searchDescription+"")&&Md(m,X),2097152&s[0]&&Md(f,e[21]),64&s[0]&&g!==(g="emoji "+(e[6]?"hide-focus":""))&&Sd(h,"class",g),8388608&s[0]&&Sd(h,"aria-label",e[23]),8388608&s[0]&&Sd(h,"title",e[23]),64&s[0]&&Sd(h,"aria-expanded",e[6]),524288&s[0]&&_!==(_="skintone-button-wrapper "+(e[19]?"expanded":""))&&Sd(p,"class",_),1&s[0]&&Y!==(Y=e[0].skinToneDescription+"")&&Md(b,Y),1049089&s[0]&&(se=e[9],K=Vd(K,s,ae,1,e,se,G,y,qd,vu,null,_u)),64&s[0]&&x!==(x="skintone-list "+(e[6]?"":"hidden no-animate"))&&Sd(y,"class",x),64&s[0]&&Rd(y,"transform","translateY("+(e[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),1&s[0]&&w!==(w=e[0].skinTonesLabel)&&Sd(y,"aria-label",w),1048576&s[0]&&k!==(k="skintone-"+e[20])&&Sd(y,"aria-activedescendant",k),64&s[0]&&S!==(S=!e[6])&&Sd(y,"aria-hidden",S),12305&s[0]|1&s[1]&&(oe=e[12],Z=Vd(Z,s,ne,1,e,oe,W,M,qd,bu,null,gu)),4096&s[0]&&Rd(M,"grid-template-columns","repeat("+e[12].length+", 1fr)"),1&s[0]&&A!==(A=e[0].categoriesLabel)&&Sd(M,"aria-label",A),16779264&s[0]&&Rd(T,"transform","translateX("+(e[24]?-1:1)*e[11]*100+"%)"),262144&s[0]&&Md(B,e[18]),262144&s[0]&&O!==(O="message "+(e[18]?"":"gone"))&&Sd(E,"class",O),402694449&s[0]&&(re=e[15],Q=Vd(Q,s,ie,1,e,re,J,j,qd,ku,null,hu)),278528&s[0]&&I!==(I="tabpanel "+(!e[14]||e[18]?"gone":""))&&Sd(C,"class",I),16&s[0]&&L!==(L=e[4]?"region":"tabpanel")&&Sd(C,"role",L),8209&s[0]&&P!==(P=e[4]?e[0].searchResultsLabel:e[0].categories[e[13].name])&&Sd(C,"aria-label",P),8208&s[0]&&N!==(N=e[4]?"":"tab-"+e[13].id)&&Sd(C,"id",N),402654464&s[0]&&(le=e[10],ee=Vd(ee,s,ce,1,e,le,te,H,qd,Au,null,pu)),262144&s[0]&&F!==(F="favorites emoji-menu "+(e[18]?"gone":""))&&Sd(H,"class",F),1&s[0]&&D!==(D=e[0].favoritesLabel)&&Sd(H,"aria-label",D),33554432&s[0]&&Rd(H,"padding-inline-end",e[25]+"px"),1&s[0]&&U!==(U=e[0].regionLabel)&&Sd(t,"aria-label",U),4194304&s[0]&&Sd(t,"style",e[22])},i:cd,o:cd,d(s){s&&yd(t);for(let e=0;e<K.length;e+=1)K[e].d();e[48](null);for(let e=0;e<Z.length;e+=1)Z[e].d();for(let e=0;e<Q.length;e+=1)Q[e].d();e[50](null);for(let e=0;e<ee.length;e+=1)ee[e].d();e[51](null),e[52](null),q=!1,md(V)}}}function Tu(e,t,s){let a,o,n,r,i,l,c,d,u,m,{skinToneEmoji:p}=t,{i18n:h}=t,{database:f}=t,{customEmoji:g}=t,{customCategorySorting:_}=t,v=[],b=[],y="",x="",w=!1,k=-1,S=!1,M=!1,A=0,R=0,T="",E=[],B=[],O=8,C=!1,j=0,I=0,L=Yd,P=!1;const N=e=>{a.getRootNode().getElementById(e).focus()},H=(e,t)=>{a.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0,composed:!0}))},F=(e,t)=>t&&e.skins&&e.skins[t]||e.unicode,D=e=>/^skintone-/.test(e.id);function $(e){const t=a.getRootNode();!function(e,t,s){for(const a of e){const e=uu(s(a));void 0===cu&&(cu=uu(t));const o=e/1.8<cu;ou.set(a.unicode,o)}}(e,o,e=>t.getElementById("emo-"+e.id)),s(1,v=v)}function U(e){return!e.unicode||!Zd(e)||ou.get(e.unicode)}async function q(e){const t=await au;return e.filter(({version:e})=>!e||e<=t)}async function V(e){return function(e,t){const s=e=>{const s={};for(const a of e)"number"==typeof a.tone&&a.version<=t&&(s[a.tone]=a.unicode);return s};return e.map(({unicode:e,skins:t,shortcodes:a,url:o,name:n,category:r})=>({unicode:e,name:n,shortcodes:a,url:o,category:r,id:e||n,skins:t&&s(t),title:(a||[]).join(", ")}))}(e,await au)}function z(e){s(2,y=""),s(44,x=""),s(5,k=-1),s(11,I=L.findIndex(t=>t.id===e.id))}async function X(e){const t=await f.getEmojiByUnicodeOrName(e),s=[...v,...B].find(t=>t.id===e),a=s.unicode&&F(s,A);await f.incrementFavoriteEmojiCount(e),H("emoji-click",{emoji:t,skinTone:A,...a&&{unicode:a},...s.name&&{name:s.name}})}async function Y(e){const{target:t}=e;if(!D(t))return;nu(e);const a=parseInt(t.id.slice(9),10);s(8,A=a),s(6,S=!1),N("skintone-button"),H("skin-tone-change",{skinTone:a}),f.setPreferredSkinTone(a)}au.then(e=>{e||s(18,r=h.emojiUnsupportedMessage)});return e.$$set=e=>{"skinToneEmoji"in e&&s(40,p=e.skinToneEmoji),"i18n"in e&&s(0,h=e.i18n),"database"in e&&s(39,f=e.database),"customEmoji"in e&&s(41,g=e.customEmoji),"customCategorySorting"in e&&s(42,_=e.customCategorySorting)},e.$$.update=()=>{if(1280&e.$$.dirty[1]&&g&&f&&s(39,f.customEmoji=g,f),1&e.$$.dirty[0]|256&e.$$.dirty[1]){f&&async function(){let e=!1;const t=setTimeout(()=>{e=!0,s(18,r=h.loadingMessage)},1e3);try{await f.ready(),s(14,P=!0)}catch(e){console.error(e),s(18,r=h.networkErrorMessage)}finally{clearTimeout(t),e&&(e=!1,s(18,r=""))}}()}if(6144&e.$$.dirty[0]|1024&e.$$.dirty[1]&&(g&&g.length?s(12,L=[Kd,...Yd]):L!==Yd&&(I&&s(11,I--,I),s(12,L=Yd))),4&e.$$.dirty[0]&&Gd(()=>{s(44,x=(y||"").trim()),s(5,k=-1)}),6144&e.$$.dirty[0]&&s(13,u=L[I]),24576&e.$$.dirty[0]|8192&e.$$.dirty[1]){!async function(){if(P){if(x.length>=2){const e=x,t=await async function(e){return V(await q(await f.getEmojiBySearchQuery(e)))}(e);e===x&&(s(1,v=t),s(4,w=!0))}else if(u){const e=u.id,t=await async function(e){if(void 0===e)return[];const t=-1===e?g:await f.getEmojiByGroup(e);return V(await q(t))}(e);e===u.id&&(s(1,v=t),s(4,w=!1))}}else s(1,v=[]),s(4,w=!1)}()}if(4112&e.$$.dirty[0]&&s(22,c=`\n  --font-family: ${Jd};\n  --num-groups: ${L.length};\n  --indicator-opacity: ${w?0:1};\n  --num-skintones: 6;`),16384&e.$$.dirty[0]|256&e.$$.dirty[1]){!async function(){P&&s(8,A=await f.getPreferredSkinTone())}()}if(512&e.$$.dirty[1]&&s(9,E=Array(6).fill().map((e,t)=>function(e,t){if(0===t)return e;const s=e.indexOf("‍");return-1!==s?e.substring(0,s)+String.fromCodePoint(127995+t-1)+e.substring(s):(e.endsWith("️")&&(e=e.substring(0,e.length-1)),e+"\ud83c"+String.fromCodePoint(57339+t-1))}(p,t))),768&e.$$.dirty[0]&&s(21,l=E[A]),257&e.$$.dirty[0]&&s(23,T=h.skinToneLabel.replace("{skinTone}",h.skinTones[A])),16384&e.$$.dirty[0]|256&e.$$.dirty[1]){P&&async function(){s(45,d=(await Promise.all(Qd.map(e=>f.getEmojiByUnicodeOrName(e)))).filter(Boolean))}()}if(16384&e.$$.dirty[0]|49408&e.$$.dirty[1]){P&&d&&async function(){const e=await f.getTopFavoriteEmoji(O),t=await V(iu([...e,...d],e=>e.unicode||e.name).slice(0,O));s(10,B=t)}()}if(10&e.$$.dirty[0]){const e=v.filter(e=>e.unicode).filter(e=>Zd(e)&&!ou.has(e.unicode));e.length?lu(()=>$(e)):(s(1,v=v.filter(U)),lu(()=>{(n||{}).scrollTop=0}))}if(e.$$.dirty[0],e.$$.dirty[1],18&e.$$.dirty[0]|2048&e.$$.dirty[1]){s(15,b=function(){if(w)return[{category:"",emojis:v}];const e=new Map;for(const t of v){const s=t.category||"";let a=e.get(s);a||(a=[],e.set(s,a)),a.push(t)}return[...e.entries()].map(([e,t])=>({category:e,emojis:t})).sort((e,t)=>_(e.category,t.category))}())}34&e.$$.dirty[0]&&s(26,m=-1!==k&&v[k].id),192&e.$$.dirty[0]&&(S?i.addEventListener("transitionend",()=>{s(19,M=!0)},{once:!0}):s(19,M=!1))},[h,v,y,n,w,k,S,i,A,E,B,I,L,u,P,b,a,o,r,M,R,l,c,T,C,j,m,F,(e,t)=>{return(s=[e.name||F(e,t),...e.shortcodes||[]],iu(s,e=>e)).join(", ");var s},function(e){return function(e,t){let s;return du?(s=new ResizeObserver(e=>t(e[0].contentRect.width)),s.observe(e)):lu(()=>t(e.getBoundingClientRect().width)),{destroy(){s&&s.disconnect()}}}(e,t=>{{const o=getComputedStyle(a),n=parseInt(o.getPropertyValue("--num-columns"),10),r="rtl"===o.getPropertyValue("direction"),i=e.parentElement.getBoundingClientRect().width-t;s(46,O=n),s(25,j=i),s(24,C=r)}})},function(e){if(!w||!v.length)return;const t=t=>{nu(e),s(5,k=ru(t,k,v))};switch(e.key){case"ArrowDown":return t(!1);case"ArrowUp":return t(!0);case"Enter":if(-1!==k)return nu(e),X(v[k].id);v.length&&s(5,k=0)}},z,function(e){const{target:t,key:s}=e,a=t=>{t&&(nu(e),t.focus())};switch(s){case"ArrowLeft":return a(t.previousSibling);case"ArrowRight":return a(t.nextSibling);case"Home":return a(t.parentElement.firstChild);case"End":return a(t.parentElement.lastChild)}},async function(e){const{target:t}=e;if(!t.classList.contains("emoji"))return;nu(e),X(t.id.substring(4))},Y,async function(e){s(6,S=!S),s(20,R=A),S&&(nu(e),lu(()=>N("skintone-"+R)))},function(e){if(!S)return;const t=async t=>{nu(e),s(20,R=t),await(Ld(),jd),N("skintone-"+R)};switch(e.key){case"ArrowUp":return t(ru(!0,R,E));case"ArrowDown":return t(ru(!1,R,E));case"Home":return t(0);case"End":return t(E.length-1);case"Enter":return Y(e);case"Escape":return nu(e),s(6,S=!1),N("skintone-button")}},function(e){if(S)switch(e.key){case" ":return Y(e)}},async function(e){const{relatedTarget:t}=e;t&&D(t)||s(6,S=!1)},f,p,g,_,!0,x,d,O,function(){y=this.value,s(2,y)},function(e){Bd[e?"unshift":"push"](()=>{i=e,s(7,i)})},e=>z(e),function(e){Bd[e?"unshift":"push"](()=>{n=e,s(3,n)})},function(e){Bd[e?"unshift":"push"](()=>{o=e,s(17,o)})},function(e){Bd[e?"unshift":"push"](()=>{a=e,s(16,a)})}]}class Eu extends class{$destroy(){!function(e,t){const s=e.$$;null!==s.fragment&&(md(s.on_destroy),s.fragment&&s.fragment.d(t),s.on_destroy=s.fragment=null,s.ctx=[])}(this,1),this.$destroy=cd}$on(e,t){const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(t),()=>{const e=s.indexOf(t);-1!==e&&s.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}{constructor(e){super(),zd(this,e,Tu,Ru,hd,{skinToneEmoji:40,i18n:0,database:39,customEmoji:41,customCategorySorting:42},null,[-1,-1,-1])}}var Bu={categoriesLabel:"Categories",emojiUnsupportedMessage:"Your browser does not support color emoji.",favoritesLabel:"Favorites",loadingMessage:"Loading…",networkErrorMessage:"Could not load emoji.",regionLabel:"Emoji picker",searchDescription:"When search results are available, press up or down to select and enter to choose.",searchLabel:"Search",searchResultsLabel:"Search results",skinToneDescription:"When expanded, press up or down to select and enter to choose.",skinToneLabel:"Choose a skin tone (currently {skinTone})",skinTonesLabel:"Skin tones",skinTones:["Default","Light","Medium-Light","Medium","Medium-Dark","Dark"],categories:{custom:"Custom","smileys-emotion":"Smileys and emoticons","people-body":"People and body","animals-nature":"Animals and nature","food-drink":"Food and drink","travel-places":"Travel and places",activities:"Activities",objects:"Objects",symbols:"Symbols",flags:"Flags"}};const Ou=["customEmoji","customCategorySorting","database","dataSource","i18n","locale","skinToneEmoji"];class Cu extends HTMLElement{constructor(e){super(),this.attachShadow({mode:"open"});const t=document.createElement("style");t.textContent=":host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.custom-emoji,.emoji,button.emoji{height:var(--total-emoji-size);width:var(--total-emoji-size)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;line-height:1;overflow:hidden;font-family:var(--font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.custom-emoji{padding:var(--emoji-padding);object-fit:contain;pointer-events:none;background-repeat:no-repeat;background-position:center center;background-size:var(--emoji-size) var(--emoji-size)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}",this.shadowRoot.appendChild(t),this._ctx={locale:"en",dataSource:"https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",skinToneEmoji:"🖐️",customCategorySorting:eu,customEmoji:null,i18n:Bu,...e};for(const e of Ou)"database"!==e&&Object.prototype.hasOwnProperty.call(this,e)&&(this._ctx[e]=this[e],delete this[e]);this._dbFlush()}connectedCallback(){this._cmp=new Eu({target:this.shadowRoot,props:this._ctx})}disconnectedCallback(){this._cmp.$destroy(),this._cmp=void 0;const{database:e}=this._ctx;e&&e.close().catch(e=>console.error(e))}static get observedAttributes(){return["locale","data-source","skin-tone-emoji"]}attributeChangedCallback(e,t,s){this._set(e.replace(/-([a-z])/g,(e,t)=>t.toUpperCase()),s)}_set(e,t){this._ctx[e]=t,this._cmp&&this._cmp.$set({[e]:t}),["locale","dataSource"].includes(e)&&this._dbFlush()}_dbCreate(){const{locale:e,dataSource:t,database:s}=this._ctx;s&&s.locale===e&&s.dataSource===t||this._set("database",new ld({locale:e,dataSource:t}))}_dbFlush(){Promise.resolve().then(()=>this._dbCreate())}}const ju={};for(const e of Ou)ju[e]={get(){return"database"===e&&this._dbCreate(),this._ctx[e]},set(t){if("database"===e)throw new Error("database is read-only");this._set(e,t)}};function Iu(e,t){for(;e&&!e.querySelector(t);){const s=(e=e.parentNode).querySelector(t);if(s)return s}return null}Object.defineProperties(Cu.prototype,ju),customElements.get("emoji-picker")||customElements.define("emoji-picker",Cu);const Lu={name:"EmojiPickerContainer",components:{SvgIcon:Un},props:{emojiOpened:{type:Boolean,default:!1},emojiReaction:{type:Boolean,default:!1},positionTop:{type:Boolean,default:!1},positionRight:{type:Boolean,default:!1},messageId:{type:String,default:""},emojiDataSource:{type:String,default:void 0}},emits:["add-emoji","open-emoji"],data:()=>({emojiPickerHeight:320,emojiPickerTop:0,emojiPickerRight:""}),watch:{emojiOpened(e){e&&setTimeout(()=>{this.addCustomStyling(),this.$refs.emojiPicker.shadowRoot.addEventListener("emoji-click",({detail:e})=>{this.$emit("add-emoji",{unicode:e.unicode})})},0)}},methods:{addCustomStyling(){const e=document.createElement("style");e.textContent=".picker {\n\t\t\t\tborder: none;\n\t\t\t}.nav {\n\t\t\t\toverflow-x: auto;\n\t\t\t}.search-wrapper {\n\t\t\t\tpadding-right: 2px;\n\t\t\t\tpadding-left: 2px;\n\t\t\t}input.search {\n\t\t\t\theight: 32px;\n\t\t\t\tfont-size: 14px;\n\t\t\t\tborder-radius: 10rem;\n\t\t\t\tborder: var(--chat-border-style);\n\t\t\t\tpadding: 5px 10px;\n\t\t\t\toutline: none;\n\t\t\t\tbackground: var(--chat-bg-color-input);\n\t\t\t\tcolor: var(--chat-color);\n\t\t\t}",this.$refs.emojiPicker.shadowRoot.appendChild(e)},openEmoji(e){this.$emit("open-emoji",!this.emojiOpened),this.setEmojiPickerPosition(e.clientY,e.view.innerWidth,e.view.innerHeight)},setEmojiPickerPosition(e,t,s){const a=t<500||s<700,o=Iu(this.$el,"#room-footer");if(o)if(a)this.emojiPickerRight=t/2-(this.positionTop?200:150)+"px",this.emojiPickerTop=100,this.emojiPickerHeight=s-200;else{const t=o.getBoundingClientRect().top-e>this.emojiPickerHeight-50;this.emojiPickerTop=t?e+10:e-this.emojiPickerHeight-10,this.emojiPickerRight=this.positionTop?"0px":this.positionRight?"60px":""}else a&&(this.emojiPickerRight="-50px")}}},Pu={class:"vac-emoji-wrapper"};var Nu=Bn(Lu,[["render",function(e,t,s,a,o,n){const r=qs("svg-icon"),i=qs("emoji-picker");return Na(),$a("div",Pu,[Ka("div",{class:Ue(["vac-svg-button",{"vac-emoji-reaction":s.emojiReaction}]),onClick:t[0]||(t[0]=(...e)=>n.openEmoji&&n.openEmoji(...e))},[Zs(e.$slots,s.messageId?"emoji-picker-reaction-icon_"+s.messageId:"emoji-picker-icon",{},()=>[Ga(r,{name:"emoji",param:s.emojiReaction?"reaction":""},null,8,["param"])])],2),s.emojiOpened?(Na(),Ua(Wo,{key:0,name:"vac-slide-up",appear:""},{default:ss(()=>[Ka("div",{class:Ue(["vac-emoji-picker",{"vac-picker-reaction":s.emojiReaction}]),style:He({height:o.emojiPickerHeight+"px",top:s.positionTop?o.emojiPickerHeight:o.emojiPickerTop+"px",right:o.emojiPickerRight,display:o.emojiPickerTop||!s.emojiReaction?"initial":"none"})},[s.emojiOpened?(Na(),Ua(i,{key:0,ref:"emojiPicker","data-source":s.emojiDataSource},null,8,["data-source"])):Ja("",!0)],6)]),_:1})):Ja("",!0)])}]]);const Hu={class:"vac-room-file-container"},Fu=["src"],Du={class:"vac-text-ellipsis"},$u={key:0,class:"vac-text-ellipsis vac-text-extension"};const Uu={key:0,class:"vac-room-files-container"},qu={class:"vac-files-box"},Vu={class:"vac-icon-close"};var zu=Bn({name:"RoomFiles",components:{SvgIcon:Un,RoomFile:Bn({name:"RoomFiles",components:{Loader:Hn,SvgIcon:Un},props:{file:{type:Object,required:!0},index:{type:Number,required:!0}},emits:["remove-file"],computed:{isImage(){return ql(this.file)},isVideo(){return Vl(this.file)}}},[["render",function(e,t,s,a,o,n){const r=qs("loader"),i=qs("svg-icon");return Na(),$a("div",Hu,[Ga(r,{show:s.file.loading,type:"room-file"},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["show"]),Ka("div",{class:"vac-svg-button vac-icon-remove",onClick:t[0]||(t[0]=t=>e.$emit("remove-file",s.index))},[Zs(e.$slots,"image-close-icon",{},()=>[Ga(i,{name:"close",param:"image"})])]),n.isImage?(Na(),$a("div",{key:0,class:Ue(["vac-message-image",{"vac-blur-loading":s.file.loading}]),style:He({"background-image":`url('${s.file.localUrl||s.file.url}')`})},null,6)):n.isVideo?(Na(),$a("video",{key:1,controls:"",class:Ue({"vac-blur-loading":s.file.loading})},[Ka("source",{src:s.file.localUrl||s.file.url},null,8,Fu)],2)):(Na(),$a("div",{key:2,class:Ue(["vac-file-container",{"vac-blur-loading":s.file.loading}])},[Ka("div",null,[Zs(e.$slots,"file-icon",{},()=>[Ga(i,{name:"file"})])]),Ka("div",Du,Ve(s.file.name),1),s.file.extension?(Na(),$a("div",$u,Ve(s.file.extension),1)):Ja("",!0)],2))])}]])},props:{files:{type:Array,required:!0}},emits:["remove-file","reset-message"],computed:{}},[["render",function(e,t,s,a,o,n){const r=qs("room-file"),i=qs("svg-icon");return Na(),Ua(Wo,{name:"vac-slide-up"},{default:ss(()=>[s.files.length?(Na(),$a("div",Uu,[Ka("div",qu,[(Na(!0),$a(Oa,null,Ks(s.files,(s,a)=>(Na(),$a("div",{key:a},[Ga(r,{file:s,index:a,onRemoveFile:t[0]||(t[0]=t=>e.$emit("remove-file",t))},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["file","index"])]))),128))]),Ka("div",Vu,[Ka("div",{class:"vac-svg-button",onClick:t[1]||(t[1]=t=>e.$emit("reset-message"))},[Zs(e.$slots,"files-close-icon",{},()=>[Ga(i,{name:"close-outline"})])])])])):Ja("",!0)]),_:3})}]]);const Xu={props:{percentage:{type:Number,default:0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","change-linehead"],data:()=>({isMouseDown:!1}),methods:{onMouseDown(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!0;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)},onMouseUp(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!1,document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove);const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},onMouseMove(e){if(this.messageSelectionEnabled)return;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},calculateLineHeadPosition(e,t){const s=t.getBoundingClientRect().width,a=t.getBoundingClientRect().left;let o=(e.clientX-a)/s;return o=o<0?0:o,o=o>1?1:o,o}}},Yu={class:"vac-player-progress"},Ku={class:"vac-line-container"};const Gu={name:"AudioPlayer",components:{SvgIcon:Un,AudioControl:Bn(Xu,[["render",function(e,t,s,a,o,n){return Na(),$a("div",{ref:"progress",class:"vac-player-bar",onMousedown:t[0]||(t[0]=(...e)=>n.onMouseDown&&n.onMouseDown(...e)),onMouseover:t[1]||(t[1]=t=>e.$emit("hover-audio-progress",!0)),onMouseout:t[2]||(t[2]=t=>e.$emit("hover-audio-progress",!1))},[Ka("div",Yu,[Ka("div",Ku,[Ka("div",{class:"vac-line-progress",style:He({width:s.percentage+"%"})},null,4),Ka("div",{class:Ue(["vac-line-dot",{"vac-line-dot__active":o.isMouseDown}]),style:He({left:s.percentage+"%"})},null,6)])])],544)}]])},props:{messageId:{type:[String,Number],default:null},src:{type:String,default:null},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","update-progress-time"],data(){return{isPlaying:!1,duration:this.convertTimeMMSS(0),playedTime:this.convertTimeMMSS(0),progress:0}},computed:{playerUniqId(){return"audio-player"+this.messageId},audioSource(){return this.src?this.src:(this.resetProgress(),null)}},mounted(){this.player=this.$el.querySelector("#"+this.playerUniqId),this.player.addEventListener("ended",()=>{this.isPlaying=!1}),this.player.addEventListener("loadeddata",()=>{this.resetProgress(),this.duration=this.convertTimeMMSS(this.player.duration),this.updateProgressTime()}),this.player.addEventListener("timeupdate",this.onTimeUpdate)},methods:{convertTimeMMSS:e=>new Date(1e3*e).toISOString().substr(14,5),playback(){!this.messageSelectionEnabled&&this.audioSource&&(this.isPlaying?this.player.pause():setTimeout(()=>this.player.play()),this.isPlaying=!this.isPlaying)},resetProgress(){this.isPlaying&&this.player.pause(),this.duration=this.convertTimeMMSS(0),this.playedTime=this.convertTimeMMSS(0),this.progress=0,this.isPlaying=!1,this.updateProgressTime()},onTimeUpdate(){this.playedTime=this.convertTimeMMSS(this.player.currentTime),this.progress=this.player.currentTime/this.player.duration*100,this.updateProgressTime()},onUpdateProgress(e){e&&(this.player.currentTime=e*this.player.duration)},updateProgressTime(){this.$emit("update-progress-time",this.progress>1?this.playedTime:this.duration)}}},Zu={class:"vac-audio-player"},Wu=["id","src"];var Qu=Bn(Gu,[["render",function(e,t,s,a,o,n){const r=qs("svg-icon"),i=qs("audio-control");return Na(),$a("div",null,[Ka("div",Zu,[Ka("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=(...e)=>n.playback&&n.playback(...e))},[o.isPlaying?Zs(e.$slots,"audio-pause-icon_"+s.messageId,{key:0},()=>[Ga(r,{name:"audio-pause"})]):Zs(e.$slots,"audio-play-icon_"+s.messageId,{key:1},()=>[Ga(r,{name:"audio-play"})])]),Ga(i,{percentage:o.progress,"message-selection-enabled":s.messageSelectionEnabled,onChangeLinehead:n.onUpdateProgress,onHoverAudioProgress:t[1]||(t[1]=t=>e.$emit("hover-audio-progress",t))},null,8,["percentage","message-selection-enabled","onChangeLinehead"]),Ka("audio",{id:n.playerUniqId,src:n.audioSource},null,8,Wu)])])}]]);const Ju={key:0,class:"vac-reply-container"},em={class:"vac-reply-box"},tm={class:"vac-reply-info"},sm={class:"vac-reply-username"},am={class:"vac-reply-content"},om=["src"],nm={key:1,controls:"",class:"vac-image-reply"},rm=["src"],im={key:3,class:"vac-image-reply vac-file-container"},lm={class:"vac-text-ellipsis"},cm={key:0,class:"vac-text-ellipsis vac-text-extension"},dm={class:"vac-icon-reply"};var um=Bn({name:"RoomMessageReply",components:{SvgIcon:Un,FormatMessage:jl,AudioPlayer:Qu},props:{room:{type:Object,required:!0},messageReply:{type:Object,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0}},emits:["reset-message"],computed:{firstFile(){var e,t;return(null==(t=null==(e=this.messageReply)?void 0:e.files)?void 0:t.length)?this.messageReply.files[0]:{}},isImage(){return ql(this.firstFile)},isVideo(){return Vl(this.firstFile)},isAudio(){return Xl(this.firstFile)},isOtherFile(){var e,t;return(null==(t=null==(e=this.messageReply)?void 0:e.files)?void 0:t.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},[["render",function(e,t,s,a,o,n){const r=qs("format-message"),i=qs("audio-player"),l=qs("svg-icon");return Na(),Ua(Wo,{name:"vac-slide-up"},{default:ss(()=>[s.messageReply?(Na(),$a("div",Ju,[Ka("div",em,[Ka("div",tm,[Ka("div",sm,Ve(s.messageReply.username),1),Ka("div",am,[Ga(r,{"message-id":s.messageReply._id,content:s.messageReply.content,users:s.room.users,"text-formatting":s.textFormatting,"link-options":s.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])]),n.isImage?(Na(),$a("img",{key:0,src:n.firstFile.url,class:"vac-image-reply"},null,8,om)):n.isVideo?(Na(),$a("video",nm,[Ka("source",{src:n.firstFile.url},null,8,rm)])):n.isAudio?(Na(),Ua(i,{key:2,src:n.firstFile.url,"message-selection-enabled":!1,class:"vac-audio-reply"},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["src"])):n.isOtherFile?(Na(),$a("div",im,[Ka("div",null,[Zs(e.$slots,"file-icon",{},()=>[Ga(l,{name:"file"})])]),Ka("div",lm,Ve(n.firstFile.name),1),n.firstFile.extension?(Na(),$a("div",cm,Ve(n.firstFile.extension),1)):Ja("",!0)])):Ja("",!0)]),Ka("div",dm,[Ka("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=t=>e.$emit("reset-message"))},[Zs(e.$slots,"reply-close-icon",{},()=>[Ga(l,{name:"close-outline"})])])])])):Ja("",!0)]),_:3})}]]);const mm={name:"RoomUsersTag",props:{filteredUsersTag:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-user-tag","activate-item"],data:()=>({activeItem:null}),watch:{filteredUsersTag(e,t){t.length&&e.length===t.length||(this.activeItem=0)},selectItem(e){e&&this.$emit("select-user-tag",this.filteredUsersTag[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredUsersTag.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},pm={key:0,class:"vac-tags-container"},hm=["onMouseover","onClick"],fm={class:"vac-tags-info"},gm={class:"vac-tags-username"};var _m=Bn(mm,[["render",function(e,t,s,a,o,n){return Na(),Ua(Wo,{name:"vac-slide-up"},{default:ss(()=>[s.filteredUsersTag.length?(Na(),$a("div",pm,[(Na(!0),$a(Oa,null,Ks(s.filteredUsersTag,(t,s)=>(Na(),$a("div",{key:t._id,class:Ue(["vac-tags-box",{"vac-tags-box-active":s===o.activeItem}]),onMouseover:e=>o.activeItem=s,onClick:s=>e.$emit("select-user-tag",t)},[Ka("div",fm,[t.avatar?(Na(),$a("div",{key:0,class:"vac-avatar vac-tags-avatar",style:He({"background-image":`url('${t.avatar}')`})},null,4)):Ja("",!0),Ka("div",gm,Ve(t.username),1)])],42,hm))),128))])):Ja("",!0)]),_:1})}]]);const vm={name:"RoomEmojis",props:{filteredEmojis:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-emoji","activate-item"],data:()=>({activeItem:null}),watch:{filteredEmojis(e,t){t.length&&e.length===t.length||(this.activeItem=0)},selectItem(e){e&&this.$emit("select-emoji",this.filteredEmojis[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredEmojis.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},bm={key:0,class:"vac-emojis-container"},ym=["onMouseover","onClick"];var xm=Bn(vm,[["render",function(e,t,s,a,o,n){return Na(),Ua(Wo,{name:"vac-slide-up"},{default:ss(()=>[s.filteredEmojis.length?(Na(),$a("div",bm,[(Na(!0),$a(Oa,null,Ks(s.filteredEmojis,(t,s)=>(Na(),$a("div",{key:t,class:Ue(["vac-emoji-element",{"vac-emoji-element-active":s===o.activeItem}]),onMouseover:e=>o.activeItem=s,onClick:s=>e.$emit("select-emoji",t)},Ve(t),43,ym))),128))])):Ja("",!0)]),_:1})}]]);const wm={name:"RoomTemplatesText",props:{filteredTemplatesText:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-template-text","activate-item"],data:()=>({activeItem:null}),watch:{filteredTemplatesText(e,t){t.length&&e.length===t.length||(this.activeItem=0)},selectItem(e){e&&this.$emit("select-template-text",this.filteredTemplatesText[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredTemplatesText.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},km={key:0,class:"vac-template-container vac-app-box-shadow"},Sm=["onMouseover","onClick"],Mm={class:"vac-template-info"},Am={class:"vac-template-tag"},Rm={class:"vac-template-text"};var Tm=Bn(wm,[["render",function(e,t,s,a,o,n){return Na(),Ua(Wo,{name:"vac-slide-up"},{default:ss(()=>[s.filteredTemplatesText.length?(Na(),$a("div",km,[(Na(!0),$a(Oa,null,Ks(s.filteredTemplatesText,(t,s)=>(Na(),$a("div",{key:s,class:Ue(["vac-template-box",{"vac-template-active":s===o.activeItem}]),onMouseover:e=>o.activeItem=s,onClick:s=>e.$emit("select-template-text",t)},[Ka("div",Mm,[Ka("div",Am," /"+Ve(t.tag),1),Ka("div",Rm,Ve(t.text),1)])],42,Sm))),128))])):Ja("",!0)]),_:1})}]]);function Em(e){return new Int16Array(e)}function Bm(e){return new Int32Array(e)}function Om(e){return new Float32Array(e)}var Cm={fill:function(e,t,s,a){if(2==arguments.length)for(var o=0;o<e.length;o++)e[o]=arguments[1];else for(o=t;o<s;o++)e[o]=a}},jm={arraycopy:function(e,t,s,a,o){for(var n=t+o;t<n;)s[a++]=e[t++]},out:{}};jm.out.println=function(e){console.log(e)},jm.out.printf=function(){console.log.apply(console,arguments)};var Im={};function Lm(e){this.ordinal=e}Im.SQRT2=1.4142135623730951,Im.FAST_LOG10=function(e){return Math.log10(e)},Im.FAST_LOG10_X=function(e,t){return Math.log10(e)*t},Lm.short_block_allowed=new Lm(0),Lm.short_block_coupled=new Lm(1),Lm.short_block_dispensed=new Lm(2),Lm.short_block_forced=new Lm(3);var Pm={};function Nm(e){this.ordinal=e}Pm.MAX_VALUE=34028235e31,Nm.vbr_off=new Nm(0),Nm.vbr_mt=new Nm(1),Nm.vbr_rh=new Nm(2),Nm.vbr_abr=new Nm(3),Nm.vbr_mtrh=new Nm(4),Nm.vbr_default=Nm.vbr_mtrh;var Hm={System:jm,VbrMode:Nm,Float:Pm,ShortBlock:Lm,Util:Im,Arrays:Cm,new_array_n:function e(t){if(1==t.length)return new Array(t[0]);var s=t[0];t=t.slice(1);for(var a=[],o=0;o<s;o++)a.push(e(t));return a},new_byte:function(e){return new Int8Array(e)},new_double:function(e){return new Float64Array(e)},new_float:Om,new_float_n:function e(t){if(1==t.length)return Om(t[0]);var s=t[0];t=t.slice(1);for(var a=[],o=0;o<s;o++)a.push(e(t));return a},new_int:Bm,new_int_n:function e(t){if(1==t.length)return Bm(t[0]);var s=t[0];t=t.slice(1);for(var a=[],o=0;o<s;o++)a.push(e(t));return a},new_short:Em,new_short_n:function e(t){if(1==t.length)return Em(t[0]);var s=t[0];t=t.slice(1);for(var a=[],o=0;o<s;o++)a.push(e(t));return a},assert:function(e){}},Fm=Hm.System,Dm=Hm.Util,$m=Hm.Arrays,Um=Hm.new_float;function qm(){var e=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*Dm.SQRT2*.5/2384e-9,.017876148*Dm.SQRT2*.5/2384e-9,.003134727*Dm.SQRT2*.5/2384e-9,.002457142*Dm.SQRT2*.5/2384e-9,971317e-9*Dm.SQRT2*.5/2384e-9,218868e-9*Dm.SQRT2*.5/2384e-9,101566e-9*Dm.SQRT2*.5/2384e-9,13828e-9*Dm.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],t=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],s=t[ap.SHORT_TYPE],a=t[ap.SHORT_TYPE],o=t[ap.SHORT_TYPE],n=t[ap.SHORT_TYPE],r=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function i(t,s,a){for(var o,n,r,i=10,l=s+238-14-286,c=-15;c<0;c++){var d,u,m;d=e[i+-10],u=t[l+-224]*d,m=t[s+224]*d,d=e[i+-9],u+=t[l+-160]*d,m+=t[s+160]*d,d=e[i+-8],u+=t[l+-96]*d,m+=t[s+96]*d,d=e[i+-7],u+=t[l+-32]*d,m+=t[s+32]*d,d=e[i+-6],u+=t[l+32]*d,m+=t[s+-32]*d,d=e[i+-5],u+=t[l+96]*d,m+=t[s+-96]*d,d=e[i+-4],u+=t[l+160]*d,m+=t[s+-160]*d,d=e[i+-3],u+=t[l+224]*d,m+=t[s+-224]*d,d=e[i+-2],u+=t[s+-256]*d,m-=t[l+256]*d,d=e[i+-1],u+=t[s+-192]*d,m-=t[l+192]*d,d=e[i+0],u+=t[s+-128]*d,m-=t[l+128]*d,d=e[i+1],u+=t[s+-64]*d,m-=t[l+64]*d,d=e[i+2],u+=t[s+0]*d,m-=t[l+0]*d,d=e[i+3],u+=t[s+64]*d,m-=t[l+-64]*d,d=e[i+4],u+=t[s+128]*d,m-=t[l+-128]*d,d=e[i+5],u+=t[s+192]*d,d=(m-=t[l+-192]*d)-(u*=e[i+6]),a[30+2*c]=m+u,a[31+2*c]=e[i+7]*d,i+=18,s--,l++}m=t[s+-16]*e[i+-10],u=t[s+-32]*e[i+-2],m+=(t[s+-48]-t[s+16])*e[i+-9],u+=t[s+-96]*e[i+-1],m+=(t[s+-80]+t[s+48])*e[i+-8],u+=t[s+-160]*e[i+0],m+=(t[s+-112]-t[s+80])*e[i+-7],u+=t[s+-224]*e[i+1],m+=(t[s+-144]+t[s+112])*e[i+-6],u-=t[s+32]*e[i+2],m+=(t[s+-176]-t[s+144])*e[i+-5],u-=t[s+96]*e[i+3],m+=(t[s+-208]+t[s+176])*e[i+-4],u-=t[s+160]*e[i+4],m+=(t[s+-240]-t[s+208])*e[i+-3],o=(u-=t[s+224])-m,n=u+m,m=a[14],u=a[15]-m,a[31]=n+m,a[30]=o+u,a[15]=o-u,a[14]=n-m,r=a[28]-a[0],a[0]+=a[28],a[28]=r*e[i+-36+7],r=a[29]-a[1],a[1]+=a[29],a[29]=r*e[i+-36+7],r=a[26]-a[2],a[2]+=a[26],a[26]=r*e[i+-72+7],r=a[27]-a[3],a[3]+=a[27],a[27]=r*e[i+-72+7],r=a[24]-a[4],a[4]+=a[24],a[24]=r*e[i+-108+7],r=a[25]-a[5],a[5]+=a[25],a[25]=r*e[i+-108+7],r=a[22]-a[6],a[6]+=a[22],a[22]=r*Dm.SQRT2,r=a[23]-a[7],a[7]+=a[23],a[23]=r*Dm.SQRT2-a[7],a[7]-=a[6],a[22]-=a[7],a[23]-=a[22],r=a[6],a[6]=a[31]-r,a[31]=a[31]+r,r=a[7],a[7]=a[30]-r,a[30]=a[30]+r,r=a[22],a[22]=a[15]-r,a[15]=a[15]+r,r=a[23],a[23]=a[14]-r,a[14]=a[14]+r,r=a[20]-a[8],a[8]+=a[20],a[20]=r*e[i+-180+7],r=a[21]-a[9],a[9]+=a[21],a[21]=r*e[i+-180+7],r=a[18]-a[10],a[10]+=a[18],a[18]=r*e[i+-216+7],r=a[19]-a[11],a[11]+=a[19],a[19]=r*e[i+-216+7],r=a[16]-a[12],a[12]+=a[16],a[16]=r*e[i+-252+7],r=a[17]-a[13],a[13]+=a[17],a[17]=r*e[i+-252+7],r=-a[20]+a[24],a[20]+=a[24],a[24]=r*e[i+-216+7],r=-a[21]+a[25],a[21]+=a[25],a[25]=r*e[i+-216+7],r=a[4]-a[8],a[4]+=a[8],a[8]=r*e[i+-216+7],r=a[5]-a[9],a[5]+=a[9],a[9]=r*e[i+-216+7],r=a[0]-a[12],a[0]+=a[12],a[12]=r*e[i+-72+7],r=a[1]-a[13],a[1]+=a[13],a[13]=r*e[i+-72+7],r=a[16]-a[28],a[16]+=a[28],a[28]=r*e[i+-72+7],r=-a[17]+a[29],a[17]+=a[29],a[29]=r*e[i+-72+7],r=Dm.SQRT2*(a[2]-a[10]),a[2]+=a[10],a[10]=r,r=Dm.SQRT2*(a[3]-a[11]),a[3]+=a[11],a[11]=r,r=Dm.SQRT2*(-a[18]+a[26]),a[18]+=a[26],a[26]=r-a[18],r=Dm.SQRT2*(-a[19]+a[27]),a[19]+=a[27],a[27]=r-a[19],r=a[2],a[19]-=a[3],a[3]-=r,a[2]=a[31]-r,a[31]+=r,r=a[3],a[11]-=a[19],a[18]-=r,a[3]=a[30]-r,a[30]+=r,r=a[18],a[27]-=a[11],a[19]-=r,a[18]=a[15]-r,a[15]+=r,r=a[19],a[10]-=r,a[19]=a[14]-r,a[14]+=r,r=a[10],a[11]-=r,a[10]=a[23]-r,a[23]+=r,r=a[11],a[26]-=r,a[11]=a[22]-r,a[22]+=r,r=a[26],a[27]-=r,a[26]=a[7]-r,a[7]+=r,r=a[27],a[27]=a[6]-r,a[6]+=r,r=Dm.SQRT2*(a[0]-a[4]),a[0]+=a[4],a[4]=r,r=Dm.SQRT2*(a[1]-a[5]),a[1]+=a[5],a[5]=r,r=Dm.SQRT2*(a[16]-a[20]),a[16]+=a[20],a[20]=r,r=Dm.SQRT2*(a[17]-a[21]),a[17]+=a[21],a[21]=r,r=-Dm.SQRT2*(a[8]-a[12]),a[8]+=a[12],a[12]=r-a[8],r=-Dm.SQRT2*(a[9]-a[13]),a[9]+=a[13],a[13]=r-a[9],r=-Dm.SQRT2*(a[25]-a[29]),a[25]+=a[29],a[29]=r-a[25],r=-Dm.SQRT2*(a[24]+a[28]),a[24]-=a[28],a[28]=r-a[24],r=a[24]-a[16],a[24]=r,r=a[20]-r,a[20]=r,r=a[28]-r,a[28]=r,r=a[25]-a[17],a[25]=r,r=a[21]-r,a[21]=r,r=a[29]-r,a[29]=r,r=a[17]-a[1],a[17]=r,r=a[9]-r,a[9]=r,r=a[25]-r,a[25]=r,r=a[5]-r,a[5]=r,r=a[21]-r,a[21]=r,r=a[13]-r,a[13]=r,r=a[29]-r,a[29]=r,r=a[1]-a[0],a[1]=r,r=a[16]-r,a[16]=r,r=a[17]-r,a[17]=r,r=a[8]-r,a[8]=r,r=a[9]-r,a[9]=r,r=a[24]-r,a[24]=r,r=a[25]-r,a[25]=r,r=a[4]-r,a[4]=r,r=a[5]-r,a[5]=r,r=a[20]-r,a[20]=r,r=a[21]-r,a[21]=r,r=a[12]-r,a[12]=r,r=a[13]-r,a[13]=r,r=a[28]-r,a[28]=r,r=a[29]-r,a[29]=r,r=a[0],a[0]+=a[31],a[31]-=r,r=a[1],a[1]+=a[30],a[30]-=r,r=a[16],a[16]+=a[15],a[15]-=r,r=a[17],a[17]+=a[14],a[14]-=r,r=a[8],a[8]+=a[23],a[23]-=r,r=a[9],a[9]+=a[22],a[22]-=r,r=a[24],a[24]+=a[7],a[7]-=r,r=a[25],a[25]+=a[6],a[6]-=r,r=a[4],a[4]+=a[27],a[27]-=r,r=a[5],a[5]+=a[26],a[26]-=r,r=a[20],a[20]+=a[11],a[11]-=r,r=a[21],a[21]+=a[10],a[10]-=r,r=a[12],a[12]+=a[19],a[19]-=r,r=a[13],a[13]+=a[18],a[18]-=r,r=a[28],a[28]+=a[3],a[3]-=r,r=a[29],a[29]+=a[2],a[2]-=r}function l(e,s){for(var a=0;a<3;a++){var o,n,r,i,l,c;n=(i=e[s+6]*t[ap.SHORT_TYPE][0]-e[s+15])+(o=e[s+0]*t[ap.SHORT_TYPE][2]-e[s+9]),r=i-o,l=(i=e[s+15]*t[ap.SHORT_TYPE][0]+e[s+6])+(o=e[s+9]*t[ap.SHORT_TYPE][2]+e[s+0]),c=-i+o,o=2069978111953089e-26*(e[s+3]*t[ap.SHORT_TYPE][1]-e[s+12]),i=2069978111953089e-26*(e[s+12]*t[ap.SHORT_TYPE][1]+e[s+3]),e[s+0]=190752519173728e-25*n+o,e[s+15]=190752519173728e-25*-l+i,r=.8660254037844387*r*1907525191737281e-26,l=.5*l*1907525191737281e-26+i,e[s+3]=r-l,e[s+6]=r+l,n=.5*n*1907525191737281e-26-o,c=.8660254037844387*c*1907525191737281e-26,e[s+9]=n+c,e[s+12]=n-c,s++}}this.mdct_sub48=function(e,c,d){for(var u,m,p,h,f,g,_,v,b,y,x,w,k,S,M,A,R,T,E,B,O,C=c,j=286,I=0;I<e.channels_out;I++){for(var L=0;L<e.mode_gr;L++){for(var P,N=e.l3_side.tt[L][I],H=N.xr,F=0,D=e.sb_sample[I][1-L],$=0,U=0;U<9;U++)for(i(C,j,D[$]),i(C,j+32,D[$+1]),$+=2,j+=64,P=1;P<32;P+=2)D[$-1][P]*=-1;for(P=0;P<32;P++,F+=18){var q=N.block_type,V=e.sb_sample[I][L],z=e.sb_sample[I][1-L];if(0!=N.mixed_block_flag&&P<2&&(q=0),e.amp_filter[P]<1e-12)$m.fill(H,F+0,F+18,0);else{if(e.amp_filter[P]<1)for(U=0;U<18;U++)z[U][r[P]]*=e.amp_filter[P];if(q==ap.SHORT_TYPE){for(U=-3;U<0;U++){var X=t[ap.SHORT_TYPE][U+3];H[F+3*U+9]=V[9+U][r[P]]*X-V[8-U][r[P]],H[F+3*U+18]=V[14-U][r[P]]*X+V[15+U][r[P]],H[F+3*U+10]=V[15+U][r[P]]*X-V[14-U][r[P]],H[F+3*U+19]=z[2-U][r[P]]*X+z[3+U][r[P]],H[F+3*U+11]=z[3+U][r[P]]*X-z[2-U][r[P]],H[F+3*U+20]=z[8-U][r[P]]*X+z[9+U][r[P]]}l(H,F)}else{var Y=Um(18);for(U=-9;U<0;U++){var K,G;K=t[q][U+27]*z[U+9][r[P]]+t[q][U+36]*z[8-U][r[P]],G=t[q][U+9]*V[U+9][r[P]]-t[q][U+18]*V[8-U][r[P]],Y[U+9]=K-G*s[3+U+9],Y[U+18]=K*s[3+U+9]+G}u=H,m=F,h=void 0,f=void 0,g=void 0,_=void 0,v=void 0,b=void 0,y=void 0,x=void 0,w=void 0,k=void 0,S=void 0,M=void 0,A=void 0,R=void 0,T=void 0,E=void 0,B=void 0,O=void 0,g=(p=Y)[17]-p[9],v=p[15]-p[11],b=p[14]-p[12],y=p[0]+p[8],x=p[1]+p[7],w=p[2]+p[6],k=p[3]+p[5],u[m+17]=y+w-k-(x-p[4]),f=(y+w-k)*a[19]+(x-p[4]),h=(g-v-b)*a[18],u[m+5]=h+f,u[m+6]=h-f,_=(p[16]-p[10])*a[18],x=x*a[19]+p[4],h=g*a[12]+_+v*a[13]+b*a[14],f=-y*a[16]+x-w*a[17]+k*a[15],u[m+1]=h+f,u[m+2]=h-f,h=g*a[13]-_-v*a[14]+b*a[12],f=-y*a[17]+x-w*a[15]+k*a[16],u[m+9]=h+f,u[m+10]=h-f,h=g*a[14]-_+v*a[12]-b*a[13],f=y*a[15]-x+w*a[16]-k*a[17],u[m+13]=h+f,u[m+14]=h-f,S=p[8]-p[0],A=p[6]-p[2],R=p[5]-p[3],T=p[17]+p[9],E=p[16]+p[10],B=p[15]+p[11],O=p[14]+p[12],u[m+0]=T+B+O+(E+p[13]),h=(T+B+O)*a[19]-(E+p[13]),f=(S-A+R)*a[18],u[m+11]=h+f,u[m+12]=h-f,M=(p[7]-p[1])*a[18],E=p[13]-E*a[19],h=T*a[15]-E+B*a[16]+O*a[17],f=S*a[14]+M+A*a[12]+R*a[13],u[m+3]=h+f,u[m+4]=h-f,h=-T*a[17]+E-B*a[15]-O*a[16],f=S*a[13]+M-A*a[14]-R*a[12],u[m+7]=h+f,u[m+8]=h-f,h=-T*a[16]+E-B*a[17]-O*a[15],f=S*a[12]-M+A*a[13]-R*a[14],u[m+15]=h+f,u[m+16]=h-f}}if(q!=ap.SHORT_TYPE&&0!=P)for(U=7;U>=0;--U){var Z,W;Z=H[F+U]*o[20+U]+H[F+-1-U]*n[28+U],W=H[F+U]*n[28+U]-H[F+-1-U]*o[20+U],H[F+-1-U]=Z,H[F+U]=W}}}if(C=d,j=286,1==e.mode_gr)for(var Q=0;Q<18;Q++)Fm.arraycopy(e.sb_sample[I][1][Q],0,e.sb_sample[I][0][Q],0,32)}}}var Vm=Hm.System,zm=Hm.new_float,Xm=Hm.new_float_n;function Ym(){this.l=zm(ap.SBMAX_l),this.s=Xm([ap.SBMAX_s,3]);var e=this;this.assign=function(t){Vm.arraycopy(t.l,0,e.l,0,ap.SBMAX_l);for(var s=0;s<ap.SBMAX_s;s++)for(var a=0;a<3;a++)e.s[s][a]=t.s[s][a]}}function Km(){this.thm=new Ym,this.en=new Ym}function Gm(e){var t=e;this.ordinal=function(){return t}}Gm.STEREO=new Gm(0),Gm.JOINT_STEREO=new Gm(1),Gm.DUAL_CHANNEL=new Gm(2),Gm.MONO=new Gm(3),Gm.NOT_SET=new Gm(4);var Zm=Hm.System,Wm=Hm.VbrMode,Qm=Hm.new_array_n,Jm=Hm.new_float,ep=Hm.new_float_n,tp=Hm.new_int,sp=Hm.assert;function ap(){var e=ap.FFTOFFSET,t=ap.MPG_MD_MS_LR,s=null;this.psy=null;var a=null,o=null,n=null;this.setModules=function(e,t,r,i){s=e,this.psy=t,a=t,o=i,n=r};var r=new qm;this.lame_encode_mp3_frame=function(i,l,c,d,u,m){var p,h=Qm([2,2]);h[0][0]=new Km,h[0][1]=new Km,h[1][0]=new Km,h[1][1]=new Km;var f,g=Qm([2,2]);g[0][0]=new Km,g[0][1]=new Km,g[1][0]=new Km,g[1][1]=new Km;var _,v,b,y=[null,null],x=i.internal_flags,w=ep([2,4]),k=[.5,.5],S=[[0,0],[0,0]],M=[[0,0],[0,0]];if(y[0]=l,y[1]=c,0==x.lame_encode_frame_init&&function(e,t){var s,a,o=e.internal_flags;if(0==o.lame_encode_frame_init){var n,i,l=Jm(2014),c=Jm(2014);for(o.lame_encode_frame_init=1,n=0,i=0;n<286+576*(1+o.mode_gr);++n)n<576*o.mode_gr?(l[n]=0,2==o.channels_out&&(c[n]=0)):(l[n]=t[0][i],2==o.channels_out&&(c[n]=t[1][i]),++i);for(a=0;a<o.mode_gr;a++)for(s=0;s<o.channels_out;s++)o.l3_side.tt[a][s].block_type=ap.SHORT_TYPE;r.mdct_sub48(o,l,c),sp(o.mf_size>=ap.BLKSIZE+e.framesize-ap.FFTOFFSET),sp(o.mf_size>=512+e.framesize-32)}}(i,y),x.padding=0,(x.slot_lag-=x.frac_SpF)<0&&(x.slot_lag+=i.out_samplerate,x.padding=1),0!=x.psymodel){var A=[null,null],R=0,T=tp(2);for(b=0;b<x.mode_gr;b++){for(v=0;v<x.channels_out;v++)A[v]=y[v],R=576+576*b-ap.FFTOFFSET;if(0!=(i.VBR==Wm.vbr_mtrh||i.VBR==Wm.vbr_mt?a.L3psycho_anal_vbr(i,A,R,b,h,g,S[b],M[b],w[b],T):a.L3psycho_anal_ns(i,A,R,b,h,g,S[b],M[b],w[b],T)))return-4;for(i.mode==Gm.JOINT_STEREO&&(k[b]=w[b][2]+w[b][3],k[b]>0&&(k[b]=w[b][3]/k[b])),v=0;v<x.channels_out;v++){var E=x.l3_side.tt[b][v];E.block_type=T[v],E.mixed_block_flag=0}}}else for(b=0;b<x.mode_gr;b++)for(v=0;v<x.channels_out;v++)x.l3_side.tt[b][v].block_type=ap.NORM_TYPE,x.l3_side.tt[b][v].mixed_block_flag=0,M[b][v]=S[b][v]=700;if(function(e){var t,s;if(0!=e.ATH.useAdjust)if(s=e.loudness_sq[0][0],t=e.loudness_sq[1][0],2==e.channels_out?(s+=e.loudness_sq[0][1],t+=e.loudness_sq[1][1]):(s+=s,t+=t),2==e.mode_gr&&(s=Math.max(s,t)),s*=.5,(s*=e.ATH.aaSensitivityP)>.03125)e.ATH.adjust>=1?e.ATH.adjust=1:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=1;else{var a=31.98*s+625e-6;e.ATH.adjust>=a?(e.ATH.adjust*=.075*a+.925,e.ATH.adjust<a&&(e.ATH.adjust=a)):e.ATH.adjustLimit>=a?e.ATH.adjust=a:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=a}else e.ATH.adjust=1}(x),r.mdct_sub48(x,y[0],y[1]),x.mode_ext=ap.MPG_MD_LR_LR,i.force_ms)x.mode_ext=ap.MPG_MD_MS_LR;else if(i.mode==Gm.JOINT_STEREO){var B=0,O=0;for(b=0;b<x.mode_gr;b++)for(v=0;v<x.channels_out;v++)B+=M[b][v],O+=S[b][v];if(B<=1*O){var C=x.l3_side.tt[0],j=x.l3_side.tt[x.mode_gr-1];C[0].block_type==C[1].block_type&&j[0].block_type==j[1].block_type&&(x.mode_ext=ap.MPG_MD_MS_LR)}}if(x.mode_ext==t?(f=g,_=M):(f=h,_=S),i.analysis&&null!=x.pinfo)for(b=0;b<x.mode_gr;b++)for(v=0;v<x.channels_out;v++)x.pinfo.ms_ratio[b]=x.ms_ratio[b],x.pinfo.ms_ener_ratio[b]=k[b],x.pinfo.blocktype[b][v]=x.l3_side.tt[b][v].block_type,x.pinfo.pe[b][v]=_[b][v],Zm.arraycopy(x.l3_side.tt[b][v].xr,0,x.pinfo.xr[b][v],0,576),x.mode_ext==t&&(x.pinfo.ers[b][v]=x.pinfo.ers[b][v+2],Zm.arraycopy(x.pinfo.energy[b][v+2],0,x.pinfo.energy[b][v],0,x.pinfo.energy[b][v].length));if(i.VBR==Wm.vbr_off||i.VBR==Wm.vbr_abr){var I,L;for(I=0;I<18;I++)x.nsPsy.pefirbuf[I]=x.nsPsy.pefirbuf[I+1];for(L=0,b=0;b<x.mode_gr;b++)for(v=0;v<x.channels_out;v++)L+=_[b][v];for(x.nsPsy.pefirbuf[18]=L,L=x.nsPsy.pefirbuf[9],I=0;I<9;I++)L+=(x.nsPsy.pefirbuf[I]+x.nsPsy.pefirbuf[18-I])*ap.fircoef[I];for(L=3350*x.mode_gr*x.channels_out/L,b=0;b<x.mode_gr;b++)for(v=0;v<x.channels_out;v++)_[b][v]*=L}if(x.iteration_loop.iteration_loop(i,_,k,f),s.format_bitstream(i),p=s.copy_buffer(x,d,u,m,1),i.bWriteVbrTag&&o.addVbrFrame(i),i.analysis&&null!=x.pinfo){for(v=0;v<x.channels_out;v++){var P;for(P=0;P<e;P++)x.pinfo.pcmdata[v][P]=x.pinfo.pcmdata[v][P+i.framesize];for(P=e;P<1600;P++)x.pinfo.pcmdata[v][P]=y[v][P-e]}n.set_frame_pinfo(i,f)}return function(e){var t,s;for(sp(e.bitrate_index>=0&&e.bitrate_index<16),sp(e.mode_ext>=0&&e.mode_ext<4),e.bitrate_stereoMode_Hist[e.bitrate_index][4]++,e.bitrate_stereoMode_Hist[15][4]++,2==e.channels_out&&(e.bitrate_stereoMode_Hist[e.bitrate_index][e.mode_ext]++,e.bitrate_stereoMode_Hist[15][e.mode_ext]++),t=0;t<e.mode_gr;++t)for(s=0;s<e.channels_out;++s){var a=0|e.l3_side.tt[t][s].block_type;0!=e.l3_side.tt[t][s].mixed_block_flag&&(a=4),e.bitrate_blockType_Hist[e.bitrate_index][a]++,e.bitrate_blockType_Hist[e.bitrate_index][5]++,e.bitrate_blockType_Hist[15][a]++,e.bitrate_blockType_Hist[15][5]++}}(x),p}}ap.ENCDELAY=576,ap.POSTDELAY=1152,ap.MDCTDELAY=48,ap.FFTOFFSET=224+ap.MDCTDELAY,ap.DECDELAY=528,ap.SBLIMIT=32,ap.CBANDS=64,ap.SBPSY_l=21,ap.SBPSY_s=12,ap.SBMAX_l=22,ap.SBMAX_s=13,ap.PSFB21=6,ap.PSFB12=6,ap.BLKSIZE=1024,ap.HBLKSIZE=ap.BLKSIZE/2+1,ap.BLKSIZE_s=256,ap.HBLKSIZE_s=ap.BLKSIZE_s/2+1,ap.NORM_TYPE=0,ap.START_TYPE=1,ap.SHORT_TYPE=2,ap.STOP_TYPE=3,ap.MPG_MD_LR_LR=0,ap.MPG_MD_LR_I=1,ap.MPG_MD_MS_LR=2,ap.MPG_MD_MS_I=3,ap.fircoef=[-.1039435,-.1892065,5*-.0432472,-.155915,3898045e-23,.0467745*5,.50455,.756825,.187098*5];var op=Hm.Util,np=Hm.new_float;function rp(){var e=np(ap.BLKSIZE),t=np(ap.BLKSIZE_s/2),s=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function a(e,t,a){var o,n,r,i=0,l=t+(a<<=1);o=4;do{var c,d,u,m,p,h,f;f=o>>1,h=(p=o<<1)+(m=o),o=p<<1,r=(n=t)+f;do{w=e[n+0]-e[n+m],x=e[n+0]+e[n+m],A=e[n+p]-e[n+h],S=e[n+p]+e[n+h],e[n+p]=x-S,e[n+0]=x+S,e[n+h]=w-A,e[n+m]=w+A,w=e[r+0]-e[r+m],x=e[r+0]+e[r+m],A=op.SQRT2*e[r+h],S=op.SQRT2*e[r+p],e[r+p]=x-S,e[r+0]=x+S,e[r+h]=w-A,e[r+m]=w+A,r+=o,n+=o}while(n<l);for(d=s[i+0],c=s[i+1],u=1;u<f;u++){var g,_;g=1-2*c*c,_=2*c*d,n=t+u,r=t+m-u;do{var v,b,y,x,w,k,S,M,A,R;b=_*e[n+m]-g*e[r+m],v=g*e[n+m]+_*e[r+m],w=e[n+0]-v,x=e[n+0]+v,k=e[r+0]-b,y=e[r+0]+b,b=_*e[n+h]-g*e[r+h],v=g*e[n+h]+_*e[r+h],A=e[n+p]-v,S=e[n+p]+v,R=e[r+p]-b,M=e[r+p]+b,b=c*S-d*R,v=d*S+c*R,e[n+p]=x-v,e[n+0]=x+v,e[r+h]=k-b,e[r+m]=k+b,b=d*M-c*A,v=c*M+d*A,e[r+p]=y-v,e[r+0]=y+v,e[n+h]=w-b,e[n+m]=w+b,r+=o,n+=o}while(n<l);d=(g=d)*s[i+0]-c*s[i+1],c=g*s[i+1]+c*s[i+0]}i+=2}while(o<a)}var o=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(e,s,n,r,i){for(var l=0;l<3;l++){var c=ap.BLKSIZE_s/2,d=65535&192*(l+1),u=ap.BLKSIZE_s/8-1;do{var m,p,h,f,g,_=255&o[u<<2];p=(m=t[_]*r[n][i+_+d])-(g=t[127-_]*r[n][i+_+d+128]),m+=g,f=(h=t[_+64]*r[n][i+_+d+64])-(g=t[63-_]*r[n][i+_+d+192]),h+=g,c-=4,s[l][c+0]=m+h,s[l][c+2]=m-h,s[l][c+1]=p+f,s[l][c+3]=p-f,p=(m=t[_+1]*r[n][i+_+d+1])-(g=t[126-_]*r[n][i+_+d+129]),m+=g,f=(h=t[_+65]*r[n][i+_+d+65])-(g=t[62-_]*r[n][i+_+d+193]),h+=g,s[l][c+ap.BLKSIZE_s/2+0]=m+h,s[l][c+ap.BLKSIZE_s/2+2]=m-h,s[l][c+ap.BLKSIZE_s/2+1]=p+f,s[l][c+ap.BLKSIZE_s/2+3]=p-f}while(--u>=0);a(s[l],c,ap.BLKSIZE_s/2)}},this.fft_long=function(t,s,n,r,i){var l=ap.BLKSIZE/8-1,c=ap.BLKSIZE/2;do{var d,u,m,p,h,f=255&o[l];u=(d=e[f]*r[n][i+f])-(h=e[f+512]*r[n][i+f+512]),d+=h,p=(m=e[f+256]*r[n][i+f+256])-(h=e[f+768]*r[n][i+f+768]),m+=h,s[(c-=4)+0]=d+m,s[c+2]=d-m,s[c+1]=u+p,s[c+3]=u-p,u=(d=e[f+1]*r[n][i+f+1])-(h=e[f+513]*r[n][i+f+513]),d+=h,p=(m=e[f+257]*r[n][i+f+257])-(h=e[f+769]*r[n][i+f+769]),m+=h,s[c+ap.BLKSIZE/2+0]=d+m,s[c+ap.BLKSIZE/2+2]=d-m,s[c+ap.BLKSIZE/2+1]=u+p,s[c+ap.BLKSIZE/2+3]=u-p}while(--l>=0);a(s,c,ap.BLKSIZE/2)},this.init_fft=function(s){for(var a=0;a<ap.BLKSIZE;a++)e[a]=.42-.5*Math.cos(2*Math.PI*(a+.5)/ap.BLKSIZE)+.08*Math.cos(4*Math.PI*(a+.5)/ap.BLKSIZE);for(a=0;a<ap.BLKSIZE_s/2;a++)t[a]=.5*(1-Math.cos(2*Math.PI*(a+.5)/ap.BLKSIZE_s))}}var ip=Hm.VbrMode,lp=Hm.Float,cp=Hm.ShortBlock,dp=Hm.Util,up=Hm.Arrays,mp=Hm.new_float,pp=Hm.new_float_n,hp=Hm.new_int,fp=Hm.assert;function gp(){var e=new rp,t=2.302585092994046,s=1/217621504/(ap.BLKSIZE/2);function a(e,t){for(var a=0,o=0;o<ap.BLKSIZE/2;++o)a+=e[o]*t.ATH.eql_w[o];return a*=s}function o(t,s,o,n,r,i,l,c,d,u,m){var p=t.internal_flags;if(d<2)e.fft_long(p,n[r],d,u,m),e.fft_short(p,i[l],d,u,m);else if(2==d){for(var h=ap.BLKSIZE-1;h>=0;--h){var f=n[r+0][h],g=n[r+1][h];n[r+0][h]=(f+g)*dp.SQRT2*.5,n[r+1][h]=(f-g)*dp.SQRT2*.5}for(var _=2;_>=0;--_)for(h=ap.BLKSIZE_s-1;h>=0;--h){f=i[l+0][_][h],g=i[l+1][_][h];i[l+0][_][h]=(f+g)*dp.SQRT2*.5,i[l+1][_][h]=(f-g)*dp.SQRT2*.5}}s[0]=n[r+0][0],s[0]*=s[0];for(h=ap.BLKSIZE/2-1;h>=0;--h){var v=n[r+0][ap.BLKSIZE/2-h],b=n[r+0][ap.BLKSIZE/2+h];s[ap.BLKSIZE/2-h]=.5*(v*v+b*b)}for(_=2;_>=0;--_){o[_][0]=i[l+0][_][0],o[_][0]*=o[_][0];for(h=ap.BLKSIZE_s/2-1;h>=0;--h){v=i[l+0][_][ap.BLKSIZE_s/2-h],b=i[l+0][_][ap.BLKSIZE_s/2+h];o[_][ap.BLKSIZE_s/2-h]=.5*(v*v+b*b)}}var y=0;for(h=11;h<ap.HBLKSIZE;h++)y+=s[h];if(p.tot_ener[d]=y,t.analysis){for(h=0;h<ap.HBLKSIZE;h++)p.pinfo.energy[c][d][h]=p.pinfo.energy_save[d][h],p.pinfo.energy_save[d][h]=s[h];p.pinfo.pe[c][d]=p.pe[d]}2==t.athaa_loudapprox&&d<2&&(p.loudness_sq[c][d]=p.loudness_sq_save[d],p.loudness_sq_save[d]=a(s,p))}var n,r,i,l=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];var c=[3.3246*3.3246,3.23837*3.23837,9.9500500969,9.0247369744,8.1854926609,7.0440875649,2.46209*2.46209,2.284*2.284,4.4892710641,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,2.4621061921,2.1508568964,1.37074*1.37074,1.31036*1.31036,1.5691069696,1.4555939904,1.16203*1.16203,1.2715945225,1.09428*1.09428,1.0659*1.0659,1.0779838276,1.0382591025,1],d=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],u=[5.5396212496,2.29259*2.29259,4.9868695969,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,2.2499700001,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.2339655056,1.0779838276];function m(e,t,s,a,o,l){var m;if(t>e){if(!(t<e*r))return e+t;m=t/e}else{if(e>=t*r)return e+t;m=e/t}if(e+=t,a+3<=6){if(m>=n)return e;var p=0|dp.FAST_LOG10_X(m,16);return e*d[p]}var h,f;p=0|dp.FAST_LOG10_X(m,16);return t=0!=l?o.ATH.cb_s[s]*o.ATH.adjust:o.ATH.cb_l[s]*o.ATH.adjust,e<i*t?e>t?(h=1,p<=13&&(h=u[p]),f=dp.FAST_LOG10_X(e/t,10/15),e*((c[p]-h)*f+h)):p>13?e:e*u[p]:e*c[p]}var p=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1];function h(e,t,s){var a;if(e<0&&(e=0),t<0&&(t=0),e<=0)return t;if(t<=0)return e;if(a=t>e?t/e:e/t,s>=-2&&s<=2){if(a>=n)return e+t;var o=0|dp.FAST_LOG10_X(a,16);return(e+t)*p[o]}return a<r?e+t:(e<t&&(e=t),e)}function f(e,t,s,a,o){var n,r,i=0,l=0;for(n=r=0;n<ap.SBMAX_s;++r,++n){for(var c=e.bo_s[n],d=e.npart_s,u=c<d?c:d;r<u;)fp(t[r]>=0),fp(s[r]>=0),i+=t[r],l+=s[r],r++;if(e.en[a].s[n][o]=i,e.thm[a].s[n][o]=l,r>=d){++n;break}fp(t[r]>=0),fp(s[r]>=0);var m=e.PSY.bo_s_weight[n],p=1-m;i=m*t[r],l=m*s[r],e.en[a].s[n][o]+=i,e.thm[a].s[n][o]+=l,i=p*t[r],l=p*s[r]}for(;n<ap.SBMAX_s;++n)e.en[a].s[n][o]=0,e.thm[a].s[n][o]=0}function g(e,t,s,a){var o,n,r=0,i=0;for(o=n=0;o<ap.SBMAX_l;++n,++o){for(var l=e.bo_l[o],c=e.npart_l,d=l<c?l:c;n<d;)fp(t[n]>=0),fp(s[n]>=0),r+=t[n],i+=s[n],n++;if(e.en[a].l[o]=r,e.thm[a].l[o]=i,n>=c){++o;break}fp(t[n]>=0),fp(s[n]>=0);var u=e.PSY.bo_l_weight[o],m=1-u;r=u*t[n],i=u*s[n],e.en[a].l[o]+=r,e.thm[a].l[o]+=i,r=m*t[n],i=m*s[n]}for(;o<ap.SBMAX_l;++o)e.en[a].l[o]=0,e.thm[a].l[o]=0}function _(e,t,s,a,o,n){var r,i,l=e.internal_flags;for(i=r=0;i<l.npart_s;++i){for(var c=0,d=l.numlines_s[i],u=0;u<d;++u,++r){c+=t[n][r]}s[i]=c}for(fp(i==l.npart_s),r=i=0;i<l.npart_s;i++){var m=l.s3ind_s[i][0],p=l.s3_ss[r++]*s[m];for(++m;m<=l.s3ind_s[i][1];)p+=l.s3_ss[r]*s[m],++r,++m;var h=2*l.nb_s1[o][i];if(a[i]=Math.min(p,h),l.blocktype_old[1&o]==ap.SHORT_TYPE){h=16*l.nb_s2[o][i];var f=a[i];a[i]=Math.min(h,f)}l.nb_s2[o][i]=l.nb_s1[o][i],l.nb_s1[o][i]=p,fp(a[i]>=0)}for(;i<=ap.CBANDS;++i)s[i]=0,a[i]=0}function v(e,t,s){return s>=1?e:s<=0?t:t>0?Math.pow(e/t,s)*t:0}var b=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function y(e,s){for(var a=309.07,o=0;o<ap.SBMAX_s-1;o++)for(var n=0;n<3;n++){var r=e.thm.s[o][n];if(r>0){var i=r*s,l=e.en.s[o][n];l>i&&(a+=l>1e10*i?b[o]*(10*t):b[o]*dp.FAST_LOG10(l/i))}}return a}var x=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function w(e,s){for(var a=281.0575,o=0;o<ap.SBMAX_l-1;o++){var n=e.thm.l[o];if(n>0){var r=n*s,i=e.en.l[o];i>r&&(a+=i>1e10*r?x[o]*(10*t):x[o]*dp.FAST_LOG10(i/r))}}return a}function k(e,t,s,a,o){var n,r;for(n=r=0;n<e.npart_l;++n){var i,l=0,c=0;for(i=0;i<e.numlines_l[n];++i,++r){var d=t[r];l+=d,c<d&&(c=d)}s[n]=l,a[n]=c,o[n]=l*e.rnumlines_l[n],fp(e.rnumlines_l[n]>=0),fp(s[n]>=0),fp(a[n]>=0),fp(o[n]>=0)}}function S(e,t,s,a){var o=l.length-1,n=0,r=s[n]+s[n+1];r>0?((i=t[n])<t[n+1]&&(i=t[n+1]),fp(e.numlines_l[n]+e.numlines_l[n+1]-1>0),(c=0|(r=20*(2*i-r)/(r*(e.numlines_l[n]+e.numlines_l[n+1]-1))))>o&&(c=o),a[n]=c):a[n]=0;for(n=1;n<e.npart_l-1;n++){var i,c;if((r=s[n-1]+s[n]+s[n+1])>0)(i=t[n-1])<t[n]&&(i=t[n]),i<t[n+1]&&(i=t[n+1]),fp(e.numlines_l[n-1]+e.numlines_l[n]+e.numlines_l[n+1]-1>0),(c=0|(r=20*(3*i-r)/(r*(e.numlines_l[n-1]+e.numlines_l[n]+e.numlines_l[n+1]-1))))>o&&(c=o),a[n]=c;else a[n]=0}(fp(n==e.npart_l-1),(r=s[n-1]+s[n])>0)?((i=t[n-1])<t[n]&&(i=t[n]),fp(e.numlines_l[n-1]+e.numlines_l[n]-1>0),(c=0|(r=20*(2*i-r)/(r*(e.numlines_l[n-1]+e.numlines_l[n]-1))))>o&&(c=o),a[n]=c):a[n]=0;fp(n==e.npart_l-1)}var M=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function A(t,s,a,o,n,r,i,l){var c=t.internal_flags;if(o<2)e.fft_long(c,i[l],o,s,a);else if(2==o)for(var d=ap.BLKSIZE-1;d>=0;--d){var u=i[l+0][d],m=i[l+1][d];i[l+0][d]=(u+m)*dp.SQRT2*.5,i[l+1][d]=(u-m)*dp.SQRT2*.5}r[0]=i[l+0][0],r[0]*=r[0];for(d=ap.BLKSIZE/2-1;d>=0;--d){var p=i[l+0][ap.BLKSIZE/2-d],h=i[l+0][ap.BLKSIZE/2+d];r[ap.BLKSIZE/2-d]=.5*(p*p+h*h)}var f=0;for(d=11;d<ap.HBLKSIZE;d++)f+=r[d];if(c.tot_ener[o]=f,t.analysis){for(d=0;d<ap.HBLKSIZE;d++)c.pinfo.energy[n][o][d]=c.pinfo.energy_save[o][d],c.pinfo.energy_save[o][d]=r[d];c.pinfo.pe[n][o]=c.pe[o]}}function R(t,s,a,o,n,r,i,l){var c=t.internal_flags;if(0==n&&o<2&&e.fft_short(c,i[l],o,s,a),2==o)for(var d=ap.BLKSIZE_s-1;d>=0;--d){var u=i[l+0][n][d],m=i[l+1][n][d];i[l+0][n][d]=(u+m)*dp.SQRT2*.5,i[l+1][n][d]=(u-m)*dp.SQRT2*.5}r[n][0]=i[l+0][n][0],r[n][0]*=r[n][0];for(d=ap.BLKSIZE_s/2-1;d>=0;--d){var p=i[l+0][n][ap.BLKSIZE_s/2-d],h=i[l+0][n][ap.BLKSIZE_s/2+d];r[n][ap.BLKSIZE_s/2-d]=.5*(p*p+h*h)}}function T(e,t,s,o){var n=e.internal_flags;2==e.athaa_loudapprox&&s<2&&(n.loudness_sq[t][s]=n.loudness_sq_save[s],n.loudness_sq_save[s]=a(o,n))}this.L3psycho_anal_ns=function(e,t,s,a,n,r,i,c,d,u){var p,h,b,x,A,R,T,E,B,O,C=e.internal_flags,j=pp([2,ap.BLKSIZE]),I=pp([2,3,ap.BLKSIZE_s]),L=mp(ap.CBANDS+1),P=mp(ap.CBANDS+1),N=mp(ap.CBANDS+2),H=hp(2),F=hp(2),D=pp([2,576]),$=hp(ap.CBANDS+2),U=hp(ap.CBANDS+2);for(up.fill(U,0),p=C.channels_out,e.mode==Gm.JOINT_STEREO&&(p=4),B=e.VBR==ip.vbr_off?0==C.ResvMax?0:C.ResvSize/C.ResvMax*.5:e.VBR==ip.vbr_rh||e.VBR==ip.vbr_mtrh||e.VBR==ip.vbr_mt?.6:1,h=0;h<C.channels_out;h++){var q=t[h],V=s+576-350-21+192;for(x=0;x<576;x++){var z,X;for(z=q[V+x+10],X=0,A=0;A<9;A+=2)z+=M[A]*(q[V+x+A]+q[V+x+21-A]),X+=M[A+1]*(q[V+x+A+1]+q[V+x+21-A-1]);D[h][x]=z+X}n[a][h].en.assign(C.en[h]),n[a][h].thm.assign(C.thm[h]),p>2&&(r[a][h].en.assign(C.en[h+2]),r[a][h].thm.assign(C.thm[h+2]))}for(h=0;h<p;h++){var Y,K=mp(12),G=[0,0,0,0],Z=mp(12),W=1,Q=mp(ap.CBANDS),J=mp(ap.CBANDS),ee=[0,0,0,0],te=mp(ap.HBLKSIZE),se=pp([3,ap.HBLKSIZE_s]);for(fp(C.npart_s<=ap.CBANDS),fp(C.npart_l<=ap.CBANDS),x=0;x<3;x++)K[x]=C.nsPsy.last_en_subshort[h][x+6],fp(C.nsPsy.last_en_subshort[h][x+4]>0),Z[x]=K[x]/C.nsPsy.last_en_subshort[h][x+4],G[0]+=K[x];if(2==h)for(x=0;x<576;x++){var ae,oe;ae=D[0][x],oe=D[1][x],D[0][x]=ae+oe,D[1][x]=ae-oe}var ne=D[1&h],re=0;for(x=0;x<9;x++){for(var ie=re+64,le=1;re<ie;re++)le<Math.abs(ne[re])&&(le=Math.abs(ne[re]));C.nsPsy.last_en_subshort[h][x]=K[x+3]=le,G[1+x/3]+=le,le>K[x+3-2]?(fp(K[x+3-2]>0),le/=K[x+3-2]):le=K[x+3-2]>10*le?K[x+3-2]/(10*le):0,Z[x+3]=le}if(e.analysis){var ce=Z[0];for(x=1;x<12;x++)ce<Z[x]&&(ce=Z[x]);C.pinfo.ers[a][h]=C.pinfo.ers_save[h],C.pinfo.ers_save[h]=ce}for(Y=3==h?C.nsPsy.attackthre_s:C.nsPsy.attackthre,x=0;x<12;x++)0==ee[x/3]&&Z[x]>Y&&(ee[x/3]=x%3+1);for(x=1;x<4;x++){var de;G[x-1]>G[x]?(fp(G[x]>0),de=G[x-1]/G[x]):(fp(G[x-1]>0),de=G[x]/G[x-1]),de<1.7&&(ee[x]=0,1==x&&(ee[0]=0))}for(0!=ee[0]&&0!=C.nsPsy.lastAttacks[h]&&(ee[0]=0),3!=C.nsPsy.lastAttacks[h]&&ee[0]+ee[1]+ee[2]+ee[3]==0||(W=0,0!=ee[1]&&0!=ee[0]&&(ee[1]=0),0!=ee[2]&&0!=ee[1]&&(ee[2]=0),0!=ee[3]&&0!=ee[2]&&(ee[3]=0)),h<2?F[h]=W:0==W&&(F[0]=F[1]=0),d[h]=C.tot_ener[h],o(e,te,se,j,1&h,I,1&h,a,h,t,s),k(C,te,L,Q,J),S(C,Q,J,$),E=0;E<3;E++){var ue,me;for(_(e,se,P,N,h,E),f(C,P,N,h,E),T=0;T<ap.SBMAX_s;T++){if(me=C.thm[h].s[T][E],me*=.8,ee[E]>=2||1==ee[E+1]){var pe=0!=E?E-1:2;le=v(C.thm[h].s[T][pe],me,.6*B);me=Math.min(me,le)}if(1==ee[E]){pe=0!=E?E-1:2,le=v(C.thm[h].s[T][pe],me,.3*B);me=Math.min(me,le)}else if(0!=E&&3==ee[E-1]||0==E&&3==C.nsPsy.lastAttacks[h]){pe=2!=E?E+1:0,le=v(C.thm[h].s[T][pe],me,.3*B);me=Math.min(me,le)}ue=K[3*E+3]+K[3*E+4]+K[3*E+5],6*K[3*E+5]<ue&&(me*=.5,6*K[3*E+4]<ue&&(me*=.5)),C.thm[h].s[T][E]=me}}for(C.nsPsy.lastAttacks[h]=ee[2],R=0,b=0;b<C.npart_l;b++){for(var he=C.s3ind[b][0],fe=L[he]*l[$[he]],ge=C.s3_ll[R++]*fe;++he<=C.s3ind[b][1];)fe=L[he]*l[$[he]],ge=m(ge,C.s3_ll[R++]*fe,he,he-b,C,0);ge*=.158489319246111,C.blocktype_old[1&h]==ap.SHORT_TYPE?N[b]=ge:N[b]=v(Math.min(ge,Math.min(2*C.nb_1[h][b],16*C.nb_2[h][b])),ge,B),C.nb_2[h][b]=C.nb_1[h][b],C.nb_1[h][b]=ge}for(;b<=ap.CBANDS;++b)L[b]=0,N[b]=0;g(C,L,N,h)}(e.mode!=Gm.STEREO&&e.mode!=Gm.JOINT_STEREO||e.interChRatio>0&&function(e,t){var s=e.internal_flags;if(s.channels_out>1){for(var a=0;a<ap.SBMAX_l;a++){var o=s.thm[0].l[a],n=s.thm[1].l[a];s.thm[0].l[a]+=n*t,s.thm[1].l[a]+=o*t}for(a=0;a<ap.SBMAX_s;a++)for(var r=0;r<3;r++){o=s.thm[0].s[a][r],n=s.thm[1].s[a][r];s.thm[0].s[a][r]+=n*t,s.thm[1].s[a][r]+=o*t}}}(e,e.interChRatio),e.mode==Gm.JOINT_STEREO)&&(!function(e){for(var t=0;t<ap.SBMAX_l;t++)if(!(e.thm[0].l[t]>1.58*e.thm[1].l[t]||e.thm[1].l[t]>1.58*e.thm[0].l[t])){var s=e.mld_l[t]*e.en[3].l[t],a=Math.max(e.thm[2].l[t],Math.min(e.thm[3].l[t],s));s=e.mld_l[t]*e.en[2].l[t];var o=Math.max(e.thm[3].l[t],Math.min(e.thm[2].l[t],s));e.thm[2].l[t]=a,e.thm[3].l[t]=o}for(t=0;t<ap.SBMAX_s;t++)for(var n=0;n<3;n++)if(!(e.thm[0].s[t][n]>1.58*e.thm[1].s[t][n]||e.thm[1].s[t][n]>1.58*e.thm[0].s[t][n])){s=e.mld_s[t]*e.en[3].s[t][n],a=Math.max(e.thm[2].s[t][n],Math.min(e.thm[3].s[t][n],s));s=e.mld_s[t]*e.en[2].s[t][n];o=Math.max(e.thm[3].s[t][n],Math.min(e.thm[2].s[t][n],s));e.thm[2].s[t][n]=a,e.thm[3].s[t][n]=o}}(C),O=e.msfix,Math.abs(O)>0&&function(e,t,s){var a=t,o=Math.pow(10,s);t*=2,a*=2;for(var n=0;n<ap.SBMAX_l;n++){if(d=e.ATH.cb_l[e.bm_l[n]]*o,(i=Math.min(Math.max(e.thm[0].l[n],d),Math.max(e.thm[1].l[n],d)))*t<(l=Math.max(e.thm[2].l[n],d))+(c=Math.max(e.thm[3].l[n],d)))l*=u=i*a/(l+c),c*=u;e.thm[2].l[n]=Math.min(l,e.thm[2].l[n]),e.thm[3].l[n]=Math.min(c,e.thm[3].l[n])}for(o*=ap.BLKSIZE_s/ap.BLKSIZE,n=0;n<ap.SBMAX_s;n++)for(var r=0;r<3;r++){var i,l,c,d,u;if(d=e.ATH.cb_s[e.bm_s[n]]*o,(i=Math.min(Math.max(e.thm[0].s[n][r],d),Math.max(e.thm[1].s[n][r],d)))*t<(l=Math.max(e.thm[2].s[n][r],d))+(c=Math.max(e.thm[3].s[n][r],d)))l*=u=i*t/(l+c),c*=u;e.thm[2].s[n][r]=Math.min(e.thm[2].s[n][r],l),e.thm[3].s[n][r]=Math.min(e.thm[3].s[n][r],c)}}(C,O,e.ATHlower*C.ATH.adjust));for(function(e,t,s,a){var o=e.internal_flags;e.short_blocks!=cp.short_block_coupled||0!=t[0]&&0!=t[1]||(t[0]=t[1]=0);for(var n=0;n<o.channels_out;n++)a[n]=ap.NORM_TYPE,e.short_blocks==cp.short_block_dispensed&&(t[n]=1),e.short_blocks==cp.short_block_forced&&(t[n]=0),0!=t[n]?(fp(o.blocktype_old[n]!=ap.START_TYPE),o.blocktype_old[n]==ap.SHORT_TYPE&&(a[n]=ap.STOP_TYPE)):(a[n]=ap.SHORT_TYPE,o.blocktype_old[n]==ap.NORM_TYPE&&(o.blocktype_old[n]=ap.START_TYPE),o.blocktype_old[n]==ap.STOP_TYPE&&(o.blocktype_old[n]=ap.SHORT_TYPE)),s[n]=o.blocktype_old[n],o.blocktype_old[n]=a[n]}(e,F,u,H),h=0;h<p;h++){var _e,ve,be,ye=0;h>1?(_e=c,ye=-2,ve=ap.NORM_TYPE,u[0]!=ap.SHORT_TYPE&&u[1]!=ap.SHORT_TYPE||(ve=ap.SHORT_TYPE),be=r[a][h-2]):(_e=i,ye=0,ve=u[h],be=n[a][h]),ve==ap.SHORT_TYPE?_e[ye+h]=y(be,C.masking_lower):_e[ye+h]=w(be,C.masking_lower),e.analysis&&(C.pinfo.pe[a][h]=_e[ye+h])}return 0};var E=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function B(e,t,s){if(0==s)for(var a=0;a<e.npart_s;a++)e.nb_s2[t][a]=e.nb_s1[t][a],e.nb_s1[t][a]=0}function O(e,t){for(var s=0;s<e.npart_l;s++)e.nb_2[t][s]=e.nb_1[t][s],e.nb_1[t][s]=0}function C(e,t,s,a,o,n){var r,i,c,d=e.internal_flags,u=new float[ap.CBANDS],m=mp(ap.CBANDS),p=new int[ap.CBANDS];for(c=i=0;c<d.npart_s;++c){var f=0,g=0,_=d.numlines_s[c];for(r=0;r<_;++r,++i){var v=t[n][i];f+=v,g<v&&(g=v)}s[c]=f,u[c]=g,m[c]=f/_,fp(m[c]>=0)}for(fp(c==d.npart_s);c<ap.CBANDS;++c)u[c]=0,m[c]=0;for(function(e,t,s,a){var o=l.length-1,n=0,r=s[n]+s[n+1];for(r>0?((i=t[n])<t[n+1]&&(i=t[n+1]),fp(e.numlines_s[n]+e.numlines_s[n+1]-1>0),(c=0|(r=20*(2*i-r)/(r*(e.numlines_s[n]+e.numlines_s[n+1]-1))))>o&&(c=o),a[n]=c):a[n]=0,n=1;n<e.npart_s-1;n++){var i,c;if(r=s[n-1]+s[n]+s[n+1],fp(n+1<e.npart_s),r>0)(i=t[n-1])<t[n]&&(i=t[n]),i<t[n+1]&&(i=t[n+1]),fp(e.numlines_s[n-1]+e.numlines_s[n]+e.numlines_s[n+1]-1>0),(c=0|(r=20*(3*i-r)/(r*(e.numlines_s[n-1]+e.numlines_s[n]+e.numlines_s[n+1]-1))))>o&&(c=o),a[n]=c;else a[n]=0}fp(n==e.npart_s-1),(r=s[n-1]+s[n])>0?((i=t[n-1])<t[n]&&(i=t[n]),fp(e.numlines_s[n-1]+e.numlines_s[n]-1>0),(c=0|(r=20*(2*i-r)/(r*(e.numlines_s[n-1]+e.numlines_s[n]-1))))>o&&(c=o),a[n]=c):a[n]=0,fp(n==e.npart_s-1)}(d,u,m,p),i=c=0;c<d.npart_s;c++){var b,y,x,w,k,S=d.s3ind_s[c][0],M=d.s3ind_s[c][1];for(b=p[S],y=1,w=d.s3_ss[i]*s[S]*l[p[S]],++i,++S;S<=M;)b+=p[S],y+=1,w=h(w,x=d.s3_ss[i]*s[S]*l[p[S]],S-c),++i,++S;w*=k=.5*l[b=(1+2*b)/(2*y)],a[c]=w,d.nb_s2[o][c]=d.nb_s1[o][c],d.nb_s1[o][c]=w,x=u[c],x*=d.minval_s[c],x*=k,a[c]>x&&(a[c]=x),d.masking_lower>1&&(a[c]*=d.masking_lower),a[c]>s[c]&&(a[c]=s[c]),d.masking_lower<1&&(a[c]*=d.masking_lower),fp(a[c]>=0)}for(;c<ap.CBANDS;++c)s[c]=0,a[c]=0}function j(e,t,s,a,o){var n,r=mp(ap.CBANDS),i=mp(ap.CBANDS),c=hp(ap.CBANDS+2);k(e,t,s,r,i),S(e,r,i,c);var d=0;for(n=0;n<e.npart_l;n++){var u,m,p,f=e.s3ind[n][0],g=e.s3ind[n][1],_=0,v=0;for(_=c[f],v+=1,m=e.s3_ll[d]*s[f]*l[c[f]],++d,++f;f<=g;)_+=c[f],v+=1,m=h(m,u=e.s3_ll[d]*s[f]*l[c[f]],f-n),++d,++f;if(m*=p=.5*l[_=(1+2*_)/(2*v)],e.blocktype_old[1&o]==ap.SHORT_TYPE){var b=2*e.nb_1[o][n];a[n]=b>0?Math.min(m,b):Math.min(m,.3*s[n])}else{var y=16*e.nb_2[o][n],x=2*e.nb_1[o][n];y<=0&&(y=m),x<=0&&(x=m),b=e.blocktype_old[1&o]==ap.NORM_TYPE?Math.min(x,y):x,a[n]=Math.min(m,b)}e.nb_2[o][n]=e.nb_1[o][n],e.nb_1[o][n]=m,u=r[n],u*=e.minval_l[n],u*=p,a[n]>u&&(a[n]=u),e.masking_lower>1&&(a[n]*=e.masking_lower),a[n]>s[n]&&(a[n]=s[n]),e.masking_lower<1&&(a[n]*=e.masking_lower),fp(a[n]>=0)}for(;n<ap.CBANDS;++n)s[n]=0,a[n]=0}function I(e,t,s,a,o,n,r){for(var i,l,c=2*n,d=n>0?Math.pow(10,o):1,u=0;u<r;++u){var m=e[2][u],p=e[3][u],h=t[0][u],f=t[1][u],g=t[2][u],_=t[3][u];if(h<=1.58*f&&f<=1.58*h){var v=s[u]*p,b=s[u]*m;l=Math.max(g,Math.min(_,v)),i=Math.max(_,Math.min(g,b))}else l=g,i=_;if(n>0){var y,x,w=a[u]*d;if(y=Math.min(Math.max(h,w),Math.max(f,w)),(x=(g=Math.max(l,w))+(_=Math.max(i,w)))>0&&y*c<x){var k=y*c/x;g*=k,_*=k}l=Math.min(g,l),i=Math.min(_,i)}l>m&&(l=m),i>p&&(i=p),t[2][u]=l,t[3][u]=i}}function L(e,t){var s;return(s=e>=0?27*-e:e*t)<=-72?0:Math.exp(.2302585093*s)}function P(e){var t,s,a=0;for(a=0;L(a,e)>1e-20;a-=1);for(o=a,n=0;Math.abs(n-o)>1e-12;)L(a=(n+o)/2,e)>0?n=a:o=a;t=o;var o,n;a=0;for(a=0;L(a,e)>1e-20;a+=1);for(o=0,n=a;Math.abs(n-o)>1e-12;)L(a=(n+o)/2,e)>0?o=a:n=a;s=n;var r,i=0,l=1e3;for(r=0;r<=l;++r){i+=L(a=t+r*(s-t)/l,e)}return 1001/(i*(s-t))}function N(e){return e<0&&(e=0),e*=.001,13*Math.atan(.76*e)+3.5*Math.atan(e*e/56.25)}function H(e,t,s,a,o,n,r,i,l,c,d,u){var m,p=mp(ap.CBANDS+1),h=i/(u>15?1152:384),f=hp(ap.HBLKSIZE);i/=l;var g=0,_=0;for(m=0;m<ap.CBANDS;m++){var v;for(R=N(i*g),p[m]=i*g,v=g;N(i*v)-R<.34&&v<=l/2;v++);for(e[m]=v-g,_=m+1;g<v;)f[g++]=m;if(g>l/2){g=l/2,++m;break}}p[m]=i*g;for(var b=0;b<u;b++){var y,x,w,k,S;w=c[b],k=c[b+1],(y=0|Math.floor(.5+d*(w-.5)))<0&&(y=0),(x=0|Math.floor(.5+d*(k-.5)))>l/2&&(x=l/2),s[b]=(f[y]+f[x])/2,t[b]=f[x];var M=h*k;r[b]=(M-p[t[b]])/(p[t[b]+1]-p[t[b]]),r[b]<0?r[b]=0:r[b]>1&&(r[b]=1),S=N(i*c[b]*d),S=Math.min(S,15.5)/15.5,n[b]=Math.pow(10,1.25*(1-Math.cos(Math.PI*S))-2.5)}g=0;for(var A=0;A<_;A++){var R,T,E=e[A];R=N(i*g),T=N(i*(g+E-1)),a[A]=.5*(R+T),R=N(i*(g-.5)),T=N(i*(g+E-.5)),o[A]=T-R,g+=E}return _}function F(e,t,s,a,o,n){var r,i,l,c,d,u,m=pp([ap.CBANDS,ap.CBANDS]),p=0;if(n)for(var h=0;h<t;h++)for(r=0;r<t;r++){var f=(i=s[h]-s[r],l=void 0,c=void 0,d=void 0,u=void 0,l=i,c=(l*=l>=0?3:1.5)>=.5&&l<=2.5?8*((u=l-.5)*u-2*u):0,((d=15.811389+7.5*(l+=.474)-17.5*Math.sqrt(1+l*l))<=-60?0:(l=Math.exp(.2302585093*(c+d)),l/=.6609193))*a[r]);m[h][r]=f*o[h]}else for(r=0;r<t;r++){var g=15+Math.min(21/s[r],12),_=P(g);for(h=0;h<t;h++){f=_*L(s[h]-s[r],g)*a[r];m[h][r]=f*o[h]}}for(h=0;h<t;h++){for(r=0;r<t&&!(m[h][r]>0);r++);for(e[h][0]=r,r=t-1;r>0&&!(m[h][r]>0);r--);e[h][1]=r,p+=e[h][1]-e[h][0]+1}var v=mp(p),b=0;for(h=0;h<t;h++)for(r=e[h][0];r<=e[h][1];r++)v[b++]=m[h][r];return v}function D(e){var t=N(e);return t=Math.min(t,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*t))-2.5)}function $(e,t){return e<-.3&&(e=3410),e/=1e3,e=Math.max(.1,e),3.64*Math.pow(e,-.8)-6.8*Math.exp(-.6*Math.pow(e-3.4,2))+6*Math.exp(-.15*Math.pow(e-8.7,2))+.001*(.6+.04*t)*Math.pow(e,4)}this.L3psycho_anal_vbr=function(e,t,s,a,o,n,r,i,l,c){var d=e.internal_flags,u=mp(ap.HBLKSIZE),m=pp([3,ap.HBLKSIZE_s]),p=pp([2,ap.BLKSIZE]),h=pp([2,3,ap.BLKSIZE_s]),_=pp([4,ap.CBANDS]),b=pp([4,ap.CBANDS]),x=pp([4,3]),k=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],S=hp(2),M=e.mode==Gm.JOINT_STEREO?4:d.channels_out;!function(e,t,s,a,o,n,r,i,l,c){for(var d=pp([2,576]),u=e.internal_flags,m=u.channels_out,p=e.mode==Gm.JOINT_STEREO?4:m,h=0;h<m;h++){firbuf=t[h];for(var f=s+576-350-21+192,g=0;g<576;g++){var _,v;_=firbuf[f+g+10],v=0;for(var b=0;b<9;b+=2)_+=E[b]*(firbuf[f+g+b]+firbuf[f+g+21-b]),v+=E[b+1]*(firbuf[f+g+b+1]+firbuf[f+g+21-b-1]);d[h][g]=_+v}o[a][h].en.assign(u.en[h]),o[a][h].thm.assign(u.thm[h]),p>2&&(n[a][h].en.assign(u.en[h+2]),n[a][h].thm.assign(u.thm[h+2]))}for(h=0;h<p;h++){var y=mp(12),x=mp(12),w=[0,0,0,0],k=d[1&h],S=0,M=3==h?u.nsPsy.attackthre_s:u.nsPsy.attackthre,A=1;if(2==h)for(g=0,b=576;b>0;++g,--b){var R=d[0][g],T=d[1][g];d[0][g]=R+T,d[1][g]=R-T}for(g=0;g<3;g++)x[g]=u.nsPsy.last_en_subshort[h][g+6],fp(u.nsPsy.last_en_subshort[h][g+4]>0),y[g]=x[g]/u.nsPsy.last_en_subshort[h][g+4],w[0]+=x[g];for(g=0;g<9;g++){for(var B=S+64,O=1;S<B;S++)O<Math.abs(k[S])&&(O=Math.abs(k[S]));u.nsPsy.last_en_subshort[h][g]=x[g+3]=O,w[1+g/3]+=O,O>x[g+3-2]?(fp(x[g+3-2]>0),O/=x[g+3-2]):O=x[g+3-2]>10*O?x[g+3-2]/(10*O):0,y[g+3]=O}for(g=0;g<3;++g){var C=x[3*g+3]+x[3*g+4]+x[3*g+5],j=1;6*x[3*g+5]<C&&(j*=.5,6*x[3*g+4]<C&&(j*=.5)),i[h][g]=j}if(e.analysis){var I=y[0];for(g=1;g<12;g++)I<y[g]&&(I=y[g]);u.pinfo.ers[a][h]=u.pinfo.ers_save[h],u.pinfo.ers_save[h]=I}for(g=0;g<12;g++)0==l[h][g/3]&&y[g]>M&&(l[h][g/3]=g%3+1);for(g=1;g<4;g++){var L=w[g-1],P=w[g];Math.max(L,P)<4e4&&L<1.7*P&&P<1.7*L&&(1==g&&l[h][0]<=l[h][g]&&(l[h][0]=0),l[h][g]=0)}l[h][0]<=u.nsPsy.lastAttacks[h]&&(l[h][0]=0),3!=u.nsPsy.lastAttacks[h]&&l[h][0]+l[h][1]+l[h][2]+l[h][3]==0||(A=0,0!=l[h][1]&&0!=l[h][0]&&(l[h][1]=0),0!=l[h][2]&&0!=l[h][1]&&(l[h][2]=0),0!=l[h][3]&&0!=l[h][2]&&(l[h][3]=0)),h<2?c[h]=A:0==A&&(c[0]=c[1]=0),r[h]=u.tot_ener[h]}}(e,t,s,a,o,n,l,x,k,S),function(e,t){var s=e.internal_flags;e.short_blocks!=cp.short_block_coupled||0!=t[0]&&0!=t[1]||(t[0]=t[1]=0);for(var a=0;a<s.channels_out;a++)e.short_blocks==cp.short_block_dispensed&&(t[a]=1),e.short_blocks==cp.short_block_forced&&(t[a]=0)}(e,S);for(var L=0;L<M;L++){A(e,t,s,L,a,u,p,N=1&L),T(e,a,L,u),0!=S[N]?j(d,u,_[L],b[L],L):O(d,L)}S[0]+S[1]==2&&e.mode==Gm.JOINT_STEREO&&I(_,b,d.mld_cb_l,d.ATH.cb_l,e.ATHlower*d.ATH.adjust,e.msfix,d.npart_l);for(L=0;L<M;L++){0!=S[N=1&L]&&g(d,_[L],b[L],L)}for(var P=0;P<3;P++){for(L=0;L<M;++L){0!=S[N=1&L]?B(d,L,P):(R(e,t,s,L,P,m,h,N),C(e,m,_[L],b[L],L,P))}S[0]+S[1]==0&&e.mode==Gm.JOINT_STEREO&&I(_,b,d.mld_cb_s,d.ATH.cb_s,e.ATHlower*d.ATH.adjust,e.msfix,d.npart_s);for(L=0;L<M;++L){0==S[N=1&L]&&f(d,_[L],b[L],L,P)}}for(L=0;L<M;L++){var N;if(0==S[N=1&L])for(var H=0;H<ap.SBMAX_s;H++){var F=mp(3);for(P=0;P<3;P++){var D=d.thm[L].s[H][P];if(D*=.8,k[L][P]>=2||1==k[L][P+1]){var $=0!=P?P-1:2,U=v(d.thm[L].s[H][$],D,.36);D=Math.min(D,U)}else if(1==k[L][P]){$=0!=P?P-1:2,U=v(d.thm[L].s[H][$],D,.18);D=Math.min(D,U)}else if(0!=P&&3==k[L][P-1]||0==P&&3==d.nsPsy.lastAttacks[L]){$=2!=P?P+1:0,U=v(d.thm[L].s[H][$],D,.18);D=Math.min(D,U)}D*=x[L][P],F[P]=D}for(P=0;P<3;P++)d.thm[L].s[H][P]=F[P]}}for(L=0;L<M;L++)d.nsPsy.lastAttacks[L]=k[L][2];!function(e,t,s){for(var a=e.internal_flags,o=0;o<a.channels_out;o++){var n=ap.NORM_TYPE;0!=t[o]?(fp(a.blocktype_old[o]!=ap.START_TYPE),a.blocktype_old[o]==ap.SHORT_TYPE&&(n=ap.STOP_TYPE)):(n=ap.SHORT_TYPE,a.blocktype_old[o]==ap.NORM_TYPE&&(a.blocktype_old[o]=ap.START_TYPE),a.blocktype_old[o]==ap.STOP_TYPE&&(a.blocktype_old[o]=ap.SHORT_TYPE)),s[o]=a.blocktype_old[o],a.blocktype_old[o]=n}}(e,S,c);for(L=0;L<M;L++){var q,V,z,X;L>1?(q=i,V=-2,z=ap.NORM_TYPE,c[0]!=ap.SHORT_TYPE&&c[1]!=ap.SHORT_TYPE||(z=ap.SHORT_TYPE),X=n[a][L-2]):(q=r,V=0,z=c[L],X=o[a][L]),z==ap.SHORT_TYPE?q[V+L]=y(X,d.masking_lower):q[V+L]=w(X,d.masking_lower),e.analysis&&(d.pinfo.pe[a][L]=q[V+L])}return 0},this.psymodel_init=function(s){var a,o=s.internal_flags,l=!0,c=13,d=0,u=0,m=-8.25,p=-4.5,h=mp(ap.CBANDS),f=mp(ap.CBANDS),g=mp(ap.CBANDS),_=s.out_samplerate;switch(s.experimentalZ){default:case 0:l=!0;break;case 1:l=!(s.VBR==ip.vbr_mtrh||s.VBR==ip.vbr_mt);break;case 2:l=!1;break;case 3:c=8,d=-1.75,u=-.0125,m=-8.25,p=-2.25}for(o.ms_ener_ratio_old=.25,o.blocktype_old[0]=o.blocktype_old[1]=ap.NORM_TYPE,a=0;a<4;++a){for(var v=0;v<ap.CBANDS;++v)o.nb_1[a][v]=1e20,o.nb_2[a][v]=1e20,o.nb_s1[a][v]=o.nb_s2[a][v]=1;for(var b=0;b<ap.SBMAX_l;b++)o.en[a].l[b]=1e20,o.thm[a].l[b]=1e20;for(v=0;v<3;++v){for(b=0;b<ap.SBMAX_s;b++)o.en[a].s[b][v]=1e20,o.thm[a].s[b][v]=1e20;o.nsPsy.lastAttacks[a]=0}for(v=0;v<9;v++)o.nsPsy.last_en_subshort[a][v]=10}for(o.loudness_sq_save[0]=o.loudness_sq_save[1]=0,o.npart_l=H(o.numlines_l,o.bo_l,o.bm_l,h,f,o.mld_l,o.PSY.bo_l_weight,_,ap.BLKSIZE,o.scalefac_band.l,ap.BLKSIZE/1152,ap.SBMAX_l),fp(o.npart_l<ap.CBANDS),a=0;a<o.npart_l;a++){var y=d;h[a]>=c&&(y=u*(h[a]-c)/(24-c)+d*(24-h[a])/(24-c)),g[a]=Math.pow(10,y/10),o.numlines_l[a]>0?o.rnumlines_l[a]=1/o.numlines_l[a]:o.rnumlines_l[a]=0}o.s3_ll=F(o.s3ind,o.npart_l,h,f,g,l);var x;v=0;for(a=0;a<o.npart_l;a++){S=lp.MAX_VALUE;for(var w=0;w<o.numlines_l[a];w++,v++){var k=_*v/(1e3*ap.BLKSIZE);M=this.ATHformula(1e3*k,s)-20,M=Math.pow(10,.1*M),S>(M*=o.numlines_l[a])&&(S=M)}o.ATH.cb_l[a]=S,(S=20*h[a]/10-20)>6&&(S=100),S<-15&&(S=-15),S-=8,o.minval_l[a]=Math.pow(10,S/10)*o.numlines_l[a]}for(o.npart_s=H(o.numlines_s,o.bo_s,o.bm_s,h,f,o.mld_s,o.PSY.bo_s_weight,_,ap.BLKSIZE_s,o.scalefac_band.s,ap.BLKSIZE_s/384,ap.SBMAX_s),fp(o.npart_s<ap.CBANDS),v=0,a=0;a<o.npart_s;a++){var S;y=m;h[a]>=c&&(y=p*(h[a]-c)/(24-c)+m*(24-h[a])/(24-c)),g[a]=Math.pow(10,y/10),S=lp.MAX_VALUE;for(w=0;w<o.numlines_s[a];w++,v++){var M;k=_*v/(1e3*ap.BLKSIZE_s);M=this.ATHformula(1e3*k,s)-20,M=Math.pow(10,.1*M),S>(M*=o.numlines_s[a])&&(S=M)}o.ATH.cb_s[a]=S,S=7*h[a]/12-7,h[a]>12&&(S*=1+3.1*Math.log(1+S)),h[a]<12&&(S*=1+2.3*Math.log(1-S)),S<-15&&(S=-15),S-=8,o.minval_s[a]=Math.pow(10,S/10)*o.numlines_s[a]}o.s3_ss=F(o.s3ind_s,o.npart_s,h,f,g,l),n=Math.pow(10,9/16),r=Math.pow(10,1.5),i=Math.pow(10,1.5),e.init_fft(o),o.decay=Math.exp(-1*t/(.01*_/192)),x=3.5,0!=(2&s.exp_nspsytune)&&(x=1),Math.abs(s.msfix)>0&&(x=s.msfix),s.msfix=x;for(var A=0;A<o.npart_l;A++)o.s3ind[A][1]>o.npart_l-1&&(o.s3ind[A][1]=o.npart_l-1);var R=576*o.mode_gr/_;if(o.ATH.decay=Math.pow(10,-1.2*R),o.ATH.adjust=.01,o.ATH.adjustLimit=1,fp(o.bo_l[ap.SBMAX_l-1]<=o.npart_l),fp(o.bo_s[ap.SBMAX_s-1]<=o.npart_s),-1!=s.ATHtype){var T=s.out_samplerate/ap.BLKSIZE,E=0;for(k=0,a=0;a<ap.BLKSIZE/2;++a)k+=T,o.ATH.eql_w[a]=1/Math.pow(10,this.ATHformula(k,s)/10),E+=o.ATH.eql_w[a];for(E=1/E,a=ap.BLKSIZE/2;--a>=0;)o.ATH.eql_w[a]*=E}for(A=v=0;A<o.npart_s;++A)for(a=0;a<o.numlines_s[A];++a)++v;for(A=v=0;A<o.npart_l;++A)for(a=0;a<o.numlines_l[A];++a)++v;for(v=0,a=0;a<o.npart_l;a++){k=_*(v+o.numlines_l[a]/2)/(1*ap.BLKSIZE);o.mld_cb_l[a]=D(k),v+=o.numlines_l[a]}for(;a<ap.CBANDS;++a)o.mld_cb_l[a]=1;for(v=0,a=0;a<o.npart_s;a++){k=_*(v+o.numlines_s[a]/2)/(1*ap.BLKSIZE_s);o.mld_cb_s[a]=D(k),v+=o.numlines_s[a]}for(;a<ap.CBANDS;++a)o.mld_cb_s[a]=1;return 0},this.ATHformula=function(e,t){var s;switch(t.ATHtype){case 0:s=$(e,9);break;case 1:s=$(e,-1);break;case 2:s=$(e,0);break;case 3:s=$(e,1)+6;break;case 4:s=$(e,t.ATHcurve);break;default:s=$(e,0)}return s}}function _p(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=Gm.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}var vp={};vp.SFBMAX=3*ap.SBMAX_s;var bp=Hm.new_float,yp=Hm.new_int;function xp(){this.xr=bp(576),this.l3_enc=yp(576),this.scalefac=yp(vp.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=yp(3),this.subblock_gain=yp(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=yp(vp.SFBMAX),this.window=yp(vp.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=yp(4),this.max_nonzero_coeff=0;var e=this;function t(e){return new Int32Array(e)}this.assign=function(s){var a;e.xr=(a=s.xr,new Float32Array(a)),e.l3_enc=t(s.l3_enc),e.scalefac=t(s.scalefac),e.xrpow_max=s.xrpow_max,e.part2_3_length=s.part2_3_length,e.big_values=s.big_values,e.count1=s.count1,e.global_gain=s.global_gain,e.scalefac_compress=s.scalefac_compress,e.block_type=s.block_type,e.mixed_block_flag=s.mixed_block_flag,e.table_select=t(s.table_select),e.subblock_gain=t(s.subblock_gain),e.region0_count=s.region0_count,e.region1_count=s.region1_count,e.preflag=s.preflag,e.scalefac_scale=s.scalefac_scale,e.count1table_select=s.count1table_select,e.part2_length=s.part2_length,e.sfb_lmax=s.sfb_lmax,e.sfb_smin=s.sfb_smin,e.psy_lmax=s.psy_lmax,e.sfbmax=s.sfbmax,e.psymax=s.psymax,e.sfbdivide=s.sfbdivide,e.width=t(s.width),e.window=t(s.window),e.count1bits=s.count1bits,e.sfb_partition_table=s.sfb_partition_table.slice(0),e.slen=t(s.slen),e.max_nonzero_coeff=s.max_nonzero_coeff}}var wp=Hm.new_int;function kp(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[wp(4),wp(4)];for(var e=0;e<2;e++)for(var t=0;t<2;t++)this.tt[e][t]=new xp}var Sp=Hm.System,Mp=Hm.new_int;function Ap(e,t,s,a){this.l=Mp(1+ap.SBMAX_l),this.s=Mp(1+ap.SBMAX_s),this.psfb21=Mp(1+ap.PSFB21),this.psfb12=Mp(1+ap.PSFB12);var o=this.l,n=this.s;4==arguments.length&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],Sp.arraycopy(this.arrL,0,o,0,Math.min(this.arrL.length,this.l.length)),Sp.arraycopy(this.arrS,0,n,0,Math.min(this.arrS.length,this.s.length)),Sp.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),Sp.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}var Rp=Hm.new_float,Tp=Hm.new_float_n,Ep=Hm.new_int;function Bp(){this.last_en_subshort=Tp([4,9]),this.lastAttacks=Ep(4),this.pefirbuf=Rp(19),this.longfact=Rp(ap.SBMAX_l),this.shortfact=Rp(ap.SBMAX_s),this.attackthre=0,this.attackthre_s=0}function Op(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}var Cp=Hm.new_byte,jp=Hm.new_double,Ip=Hm.new_float,Lp=Hm.new_float_n,Pp=Hm.new_int,Np=Hm.new_int_n;function Hp(){function e(){this.write_timing=0,this.ptr=0,this.buf=Cp(40)}this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=Lp([2,Hp.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new kp,this.ms_ratio=Ip(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=Pp(2),this.CurrentStep=Pp(2),this.masking_lower=0,this.bv_scf=Pp(576),this.pseudohalf=Pp(vp.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*Hp.BPC+1),this.itime=jp(2),this.sideinfo_len=0,this.sb_sample=Lp([2,2,18,ap.SBLIMIT]),this.amp_filter=Ip(32),this.header=new Array(Hp.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new Ap,this.minval_l=Ip(ap.CBANDS),this.minval_s=Ip(ap.CBANDS),this.nb_1=Lp([4,ap.CBANDS]),this.nb_2=Lp([4,ap.CBANDS]),this.nb_s1=Lp([4,ap.CBANDS]),this.nb_s2=Lp([4,ap.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=Ip(4),this.loudness_sq=Lp([2,2]),this.loudness_sq_save=Ip(2),this.mld_l=Ip(ap.SBMAX_l),this.mld_s=Ip(ap.SBMAX_s),this.bm_l=Pp(ap.SBMAX_l),this.bo_l=Pp(ap.SBMAX_l),this.bm_s=Pp(ap.SBMAX_s),this.bo_s=Pp(ap.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=Np([ap.CBANDS,2]),this.s3ind_s=Np([ap.CBANDS,2]),this.numlines_s=Pp(ap.CBANDS),this.numlines_l=Pp(ap.CBANDS),this.rnumlines_l=Ip(ap.CBANDS),this.mld_cb_l=Ip(ap.CBANDS),this.mld_cb_s=Ip(ap.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=Ip(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=Pp(2),this.nsPsy=new Bp,this.VBR_seek_table=new Op,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=Np([16,5]),this.bitrate_blockType_Hist=Np([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var t=0;t<this.en.length;t++)this.en[t]=new Ym;for(t=0;t<this.thm.length;t++)this.thm[t]=new Ym;for(t=0;t<this.header.length;t++)this.header[t]=new e}Hp.MFSIZE=3456+ap.ENCDELAY-ap.MDCTDELAY,Hp.MAX_HEADER_BUF=256,Hp.MAX_BITS_PER_CHANNEL=4095,Hp.MAX_BITS_PER_GRANULE=7680,Hp.BPC=320;var Fp=Hm.new_float;function Dp(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=Fp(ap.SBMAX_l),this.s=Fp(ap.SBMAX_s),this.psfb21=Fp(ap.PSFB21),this.psfb12=Fp(ap.PSFB12),this.cb_l=Fp(ap.CBANDS),this.cb_s=Fp(ap.CBANDS),this.eql_w=Fp(ap.BLKSIZE/2)}var $p=Hm.System,Up=Hm.Arrays;function qp(){var e=qp.RMS_WINDOW_TIME_NUMERATOR,t=qp.RMS_WINDOW_TIME_DENOMINATOR,s=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],a=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function o(e,t,s,a,o,n){for(;0!=o--;)s[a]=1e-10+e[t+0]*n[0]-s[a-1]*n[1]+e[t-1]*n[2]-s[a-2]*n[3]+e[t-2]*n[4]-s[a-3]*n[5]+e[t-3]*n[6]-s[a-4]*n[7]+e[t-4]*n[8]-s[a-5]*n[9]+e[t-5]*n[10]-s[a-6]*n[11]+e[t-6]*n[12]-s[a-7]*n[13]+e[t-7]*n[14]-s[a-8]*n[15]+e[t-8]*n[16]-s[a-9]*n[17]+e[t-9]*n[18]-s[a-10]*n[19]+e[t-10]*n[20],++a,++t}function n(e,t,s,a,o,n){for(;0!=o--;)s[a]=e[t+0]*n[0]-s[a-1]*n[1]+e[t-1]*n[2]-s[a-2]*n[3]+e[t-2]*n[4],++a,++t}function r(e){return e*e}this.InitGainAnalysis=function(s,a){return function(s,a){for(var o=0;o<MAX_ORDER;o++)s.linprebuf[o]=s.lstepbuf[o]=s.loutbuf[o]=s.rinprebuf[o]=s.rstepbuf[o]=s.routbuf[o]=0;switch(0|a){case 48e3:s.reqindex=0;break;case 44100:s.reqindex=1;break;case 32e3:s.reqindex=2;break;case 24e3:s.reqindex=3;break;case 22050:s.reqindex=4;break;case 16e3:s.reqindex=5;break;case 12e3:s.reqindex=6;break;case 11025:s.reqindex=7;break;case 8e3:s.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return s.sampleWindow=0|(a*e+t-1)/t,s.lsum=0,s.rsum=0,s.totsamp=0,Up.ill(s.A,0),INIT_GAIN_ANALYSIS_OK}(s,a)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(s.linpre=MAX_ORDER,s.rinpre=MAX_ORDER,s.lstep=MAX_ORDER,s.rstep=MAX_ORDER,s.lout=MAX_ORDER,s.rout=MAX_ORDER,Up.fill(s.B,0),INIT_GAIN_ANALYSIS_OK)},this.AnalyzeSamples=function(e,t,i,l,c,d,u){var m,p,h,f,g,_,v;if(0==d)return GAIN_ANALYSIS_OK;switch(v=0,g=d,u){case 1:l=t,c=i;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(d<MAX_ORDER?($p.arraycopy(t,i,e.linprebuf,MAX_ORDER,d),$p.arraycopy(l,c,e.rinprebuf,MAX_ORDER,d)):($p.arraycopy(t,i,e.linprebuf,MAX_ORDER,MAX_ORDER),$p.arraycopy(l,c,e.rinprebuf,MAX_ORDER,MAX_ORDER));g>0;){_=g>e.sampleWindow-e.totsamp?e.sampleWindow-e.totsamp:g,v<MAX_ORDER?(m=e.linpre+v,p=e.linprebuf,h=e.rinpre+v,f=e.rinprebuf,_>MAX_ORDER-v&&(_=MAX_ORDER-v)):(m=i+v,p=t,h=c+v,f=l),o(p,m,e.lstepbuf,e.lstep+e.totsamp,_,s[e.reqindex]),o(f,h,e.rstepbuf,e.rstep+e.totsamp,_,s[e.reqindex]),n(e.lstepbuf,e.lstep+e.totsamp,e.loutbuf,e.lout+e.totsamp,_,a[e.reqindex]),n(e.rstepbuf,e.rstep+e.totsamp,e.routbuf,e.rout+e.totsamp,_,a[e.reqindex]),m=e.lout+e.totsamp,p=e.loutbuf,h=e.rout+e.totsamp,f=e.routbuf;for(var b=_%8;0!=b--;)e.lsum+=r(p[m++]),e.rsum+=r(f[h++]);for(b=_/8;0!=b--;)e.lsum+=r(p[m+0])+r(p[m+1])+r(p[m+2])+r(p[m+3])+r(p[m+4])+r(p[m+5])+r(p[m+6])+r(p[m+7]),m+=8,e.rsum+=r(f[h+0])+r(f[h+1])+r(f[h+2])+r(f[h+3])+r(f[h+4])+r(f[h+5])+r(f[h+6])+r(f[h+7]),h+=8;if(g-=_,v+=_,e.totsamp+=_,e.totsamp==e.sampleWindow){var y=10*qp.STEPS_per_dB*Math.log10((e.lsum+e.rsum)/e.totsamp*.5+1e-37),x=y<=0?0:0|y;x>=e.A.length&&(x=e.A.length-1),e.A[x]++,e.lsum=e.rsum=0,$p.arraycopy(e.loutbuf,e.totsamp,e.loutbuf,0,MAX_ORDER),$p.arraycopy(e.routbuf,e.totsamp,e.routbuf,0,MAX_ORDER),$p.arraycopy(e.lstepbuf,e.totsamp,e.lstepbuf,0,MAX_ORDER),$p.arraycopy(e.rstepbuf,e.totsamp,e.rstepbuf,0,MAX_ORDER),e.totsamp=0}if(e.totsamp>e.sampleWindow)return GAIN_ANALYSIS_ERROR}return d<MAX_ORDER?($p.arraycopy(e.linprebuf,d,e.linprebuf,0,MAX_ORDER-d),$p.arraycopy(e.rinprebuf,d,e.rinprebuf,0,MAX_ORDER-d),$p.arraycopy(t,i,e.linprebuf,MAX_ORDER-d,d),$p.arraycopy(l,c,e.rinprebuf,MAX_ORDER-d,d)):($p.arraycopy(t,i+d-MAX_ORDER,e.linprebuf,0,MAX_ORDER),$p.arraycopy(l,c+d-MAX_ORDER,e.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK},this.GetTitleGain=function(e){for(var t=function(e,t){var s,a=0;for(s=0;s<t;s++)a+=e[s];if(0==a)return GAIN_NOT_ENOUGH_SAMPLES;var o=0|Math.ceil(a*(1-.95));for(s=t;s-- >0&&!((o-=e[s])<=0););return 64.82-s/qp.STEPS_per_dB}(e.A,e.A.length),s=0;s<e.A.length;s++)e.B[s]+=e.A[s],e.A[s]=0;for(s=0;s<MAX_ORDER;s++)e.linprebuf[s]=e.lstepbuf[s]=e.loutbuf[s]=e.rinprebuf[s]=e.rstepbuf[s]=e.routbuf[s]=0;return e.totsamp=0,e.lsum=e.rsum=0,t}}qp.STEPS_per_dB=100,qp.MAX_dB=120,qp.GAIN_NOT_ENOUGH_SAMPLES=-24601,qp.GAIN_ANALYSIS_ERROR=0,qp.GAIN_ANALYSIS_OK=1,qp.INIT_GAIN_ANALYSIS_ERROR=0,qp.INIT_GAIN_ANALYSIS_OK=1,qp.YULE_ORDER=10,qp.MAX_ORDER=qp.YULE_ORDER,qp.MAX_SAMP_FREQ=48e3,qp.RMS_WINDOW_TIME_NUMERATOR=1,qp.RMS_WINDOW_TIME_DENOMINATOR=20,qp.MAX_SAMPLES_PER_WINDOW=qp.MAX_SAMP_FREQ*qp.RMS_WINDOW_TIME_NUMERATOR/qp.RMS_WINDOW_TIME_DENOMINATOR+1;var Vp=Hm.new_float,zp=Hm.new_int;function Xp(){this.linprebuf=Vp(NaN),this.linpre=0,this.lstepbuf=Vp(NaN),this.lstep=0,this.loutbuf=Vp(NaN),this.lout=0,this.rinprebuf=Vp(NaN),this.rinpre=0,this.rstepbuf=Vp(NaN),this.rstep=0,this.routbuf=Vp(NaN),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=zp(0),this.B=zp(0)}function Yp(e){this.bits=e}var Kp=Hm.new_float,Gp=Hm.new_int,Zp=Hm.assert;function Wp(e){var t=e;this.quantize=t,this.iteration_loop=function(e,t,s,a){var o,n=e.internal_flags,r=Kp(vp.SFBMAX),i=Kp(576),l=Gp(2),c=0,d=n.l3_side,u=new Yp(c);this.quantize.rv.ResvFrameBegin(e,u),c=u.bits;for(var m=0;m<n.mode_gr;m++){o=this.quantize.qupvt.on_pe(e,t,l,c,m,m),n.mode_ext==ap.MPG_MD_MS_LR&&(this.quantize.ms_convert(n.l3_side,m),this.quantize.qupvt.reduce_side(l,s[m],c,o));for(var p=0;p<n.channels_out;p++){var h,f,g=d.tt[m][p];g.block_type!=ap.SHORT_TYPE?(h=0,f=n.PSY.mask_adjust-h):(h=0,f=n.PSY.mask_adjust_short-h),n.masking_lower=Math.pow(10,.1*f),this.quantize.init_outer_loop(n,g),this.quantize.init_xrpow(n,g,i)&&(this.quantize.qupvt.calc_xmin(e,a[m][p],g,r),this.quantize.outer_loop(e,g,r,i,p,l[p])),this.quantize.iteration_finish_one(n,m,p),Zp(g.part2_3_length<=Hp.MAX_BITS_PER_CHANNEL),Zp(g.part2_3_length<=l[p])}}this.quantize.rv.ResvFrameEnd(n,c)}}function Qp(e,t,s,a){this.xlen=e,this.linmax=t,this.table=s,this.hlen=a}var Jp={t1HB:[1,1,1,0],t2HB:[1,2,1,3,1,1,3,2,0],t3HB:[3,2,1,1,1,1,3,2,0],t5HB:[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],t6HB:[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],t7HB:[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],t8HB:[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],t9HB:[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],t10HB:[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],t11HB:[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],t12HB:[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],t13HB:[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],t15HB:[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],t16HB:[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],t24HB:[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],t32HB:[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],t33HB:[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],t1l:[1,4,3,5],t2l:[1,4,7,4,5,7,6,7,8],t3l:[2,3,7,4,4,7,6,7,8],t5l:[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],t6l:[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],t7l:[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],t8l:[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],t9l:[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],t10l:[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],t11l:[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],t12l:[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],t13l:[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],t15l:[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],t16_5l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],t16l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],t24l:[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],t32l:[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],t33l:[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8]};Jp.ht=[new Qp(0,0,null,null),new Qp(2,0,Jp.t1HB,Jp.t1l),new Qp(3,0,Jp.t2HB,Jp.t2l),new Qp(3,0,Jp.t3HB,Jp.t3l),new Qp(0,0,null,null),new Qp(4,0,Jp.t5HB,Jp.t5l),new Qp(4,0,Jp.t6HB,Jp.t6l),new Qp(6,0,Jp.t7HB,Jp.t7l),new Qp(6,0,Jp.t8HB,Jp.t8l),new Qp(6,0,Jp.t9HB,Jp.t9l),new Qp(8,0,Jp.t10HB,Jp.t10l),new Qp(8,0,Jp.t11HB,Jp.t11l),new Qp(8,0,Jp.t12HB,Jp.t12l),new Qp(16,0,Jp.t13HB,Jp.t13l),new Qp(0,0,null,Jp.t16_5l),new Qp(16,0,Jp.t15HB,Jp.t15l),new Qp(1,1,Jp.t16HB,Jp.t16l),new Qp(2,3,Jp.t16HB,Jp.t16l),new Qp(3,7,Jp.t16HB,Jp.t16l),new Qp(4,15,Jp.t16HB,Jp.t16l),new Qp(6,63,Jp.t16HB,Jp.t16l),new Qp(8,255,Jp.t16HB,Jp.t16l),new Qp(10,1023,Jp.t16HB,Jp.t16l),new Qp(13,8191,Jp.t16HB,Jp.t16l),new Qp(4,15,Jp.t24HB,Jp.t24l),new Qp(5,31,Jp.t24HB,Jp.t24l),new Qp(6,63,Jp.t24HB,Jp.t24l),new Qp(7,127,Jp.t24HB,Jp.t24l),new Qp(8,255,Jp.t24HB,Jp.t24l),new Qp(9,511,Jp.t24HB,Jp.t24l),new Qp(11,2047,Jp.t24HB,Jp.t24l),new Qp(13,8191,Jp.t24HB,Jp.t24l),new Qp(0,0,Jp.t32HB,Jp.t32l),new Qp(0,0,Jp.t33HB,Jp.t33l)],Jp.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],Jp.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],Jp.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],Jp.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],Jp.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],Jp.scfsi_band=[0,6,11,16,21];var eh=Hm.VbrMode,th=Hm.Float,sh=Hm.Util,ah=Hm.new_float,oh=Hm.new_int,nh=Hm.assert;function rh(){var e=null,t=null,s=null;this.setModules=function(a,o,n){e=a,t=o,s=n},this.IPOW20=function(e){return l[e]};var a=rh.IXMAX_VAL+2,o=rh.Q_MAX,n=rh.Q_MAX2;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var r=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=r,this.sfBandIndex=[new Ap([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ap([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ap([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ap([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ap([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ap([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ap([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ap([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ap([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0,8,16,24,36,52,72,96,124,160,162,164,166,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var i=ah(o+n+1),l=ah(o),c=ah(a),d=ah(a);function u(e,t){var a=s.ATHformula(t,e);return a-=100,a=Math.pow(10,a/10+e.ATHlower)}function m(e){this.s=e}this.adj43=d,this.iteration_init=function(t){var s,r=t.internal_flags,m=r.l3_side;if(0==r.iteration_init_init){for(r.iteration_init_init=1,m.main_data_begin=0,function(e){for(var t=e.internal_flags.ATH.l,s=e.internal_flags.ATH.psfb21,a=e.internal_flags.ATH.s,o=e.internal_flags.ATH.psfb12,n=e.internal_flags,r=e.out_samplerate,i=0;i<ap.SBMAX_l;i++){var l=n.scalefac_band.l[i],c=n.scalefac_band.l[i+1];t[i]=th.MAX_VALUE;for(var d=l;d<c;d++){var m=u(e,d*r/1152);t[i]=Math.min(t[i],m)}}for(i=0;i<ap.PSFB21;i++){l=n.scalefac_band.psfb21[i],c=n.scalefac_band.psfb21[i+1];s[i]=th.MAX_VALUE;for(d=l;d<c;d++){m=u(e,d*r/1152);s[i]=Math.min(s[i],m)}}for(i=0;i<ap.SBMAX_s;i++){l=n.scalefac_band.s[i],c=n.scalefac_band.s[i+1];a[i]=th.MAX_VALUE;for(d=l;d<c;d++){m=u(e,d*r/384);a[i]=Math.min(a[i],m)}a[i]*=n.scalefac_band.s[i+1]-n.scalefac_band.s[i]}for(i=0;i<ap.PSFB12;i++){l=n.scalefac_band.psfb12[i],c=n.scalefac_band.psfb12[i+1];o[i]=th.MAX_VALUE;for(d=l;d<c;d++){m=u(e,d*r/384);o[i]=Math.min(o[i],m)}o[i]*=n.scalefac_band.s[13]-n.scalefac_band.s[12]}if(e.noATH){for(i=0;i<ap.SBMAX_l;i++)t[i]=1e-20;for(i=0;i<ap.PSFB21;i++)s[i]=1e-20;for(i=0;i<ap.SBMAX_s;i++)a[i]=1e-20;for(i=0;i<ap.PSFB12;i++)o[i]=1e-20}n.ATH.floor=10*Math.log10(u(e,-1))}(t),c[0]=0,s=1;s<a;s++)c[s]=Math.pow(s,4/3);for(s=0;s<a-1;s++)d[s]=s+1-Math.pow(.5*(c[s]+c[s+1]),.75);for(d[s]=.5,s=0;s<o;s++)l[s]=Math.pow(2,-.1875*(s-210));for(s=0;s<=o+n;s++)i[s]=Math.pow(2,.25*(s-210-n));var p,h,f,g;for(e.huffman_init(r),(s=t.exp_nspsytune>>2&63)>=32&&(s-=64),p=Math.pow(10,s/4/10),(s=t.exp_nspsytune>>8&63)>=32&&(s-=64),h=Math.pow(10,s/4/10),(s=t.exp_nspsytune>>14&63)>=32&&(s-=64),f=Math.pow(10,s/4/10),(s=t.exp_nspsytune>>20&63)>=32&&(s-=64),g=f*Math.pow(10,s/4/10),s=0;s<ap.SBMAX_l;s++){_=s<=6?p:s<=13?h:s<=20?f:g,r.nsPsy.longfact[s]=_}for(s=0;s<ap.SBMAX_s;s++){var _;_=s<=5?p:s<=10?h:s<=11?f:g,r.nsPsy.shortfact[s]=_}}},this.on_pe=function(e,s,a,o,n,r){var i,l,c=e.internal_flags,d=0,u=oh(2),m=new Yp(d),p=t.ResvMaxBits(e,o,m,r),h=(d=m.bits)+p;for(h>Hp.MAX_BITS_PER_GRANULE&&(h=Hp.MAX_BITS_PER_GRANULE),i=0,l=0;l<c.channels_out;++l)a[l]=Math.min(Hp.MAX_BITS_PER_CHANNEL,d/c.channels_out),u[l]=0|a[l]*s[n][l]/700-a[l],u[l]>3*o/4&&(u[l]=3*o/4),u[l]<0&&(u[l]=0),u[l]+a[l]>Hp.MAX_BITS_PER_CHANNEL&&(u[l]=Math.max(0,Hp.MAX_BITS_PER_CHANNEL-a[l])),i+=u[l];if(i>p)for(l=0;l<c.channels_out;++l)u[l]=p*u[l]/i;for(l=0;l<c.channels_out;++l)a[l]+=u[l],p-=u[l];for(i=0,l=0;l<c.channels_out;++l)i+=a[l];if(i>Hp.MAX_BITS_PER_GRANULE){for(l=0;l<c.channels_out;++l)a[l]*=Hp.MAX_BITS_PER_GRANULE,a[l]/=i,a[l]}return h},this.reduce_side=function(e,t,s,a){nh(e[0]+e[1]<=Hp.MAX_BITS_PER_GRANULE);var o=.33*(.5-t)/.5;o<0&&(o=0),o>.5&&(o=.5);var n=0|.5*o*(e[0]+e[1]);n>Hp.MAX_BITS_PER_CHANNEL-e[0]&&(n=Hp.MAX_BITS_PER_CHANNEL-e[0]),n<0&&(n=0),e[1]>=125&&(e[1]-n>125?(e[0]<s&&(e[0]+=n),e[1]-=n):(e[0]+=e[1]-125,e[1]=125)),(n=e[0]+e[1])>a&&(e[0]=a*e[0]/n,e[1]=a*e[1]/n),nh(e[0]<=Hp.MAX_BITS_PER_CHANNEL),nh(e[1]<=Hp.MAX_BITS_PER_CHANNEL),nh(e[0]+e[1]<=Hp.MAX_BITS_PER_GRANULE)},this.athAdjust=function(e,t,s){var a=90.30873362,o=sh.FAST_LOG10_X(t,10),n=e*e,r=0;return o-=s,n>1e-20&&(r=1+sh.FAST_LOG10_X(n,10/a)),r<0&&(r=0),o*=r,o+=s+a-94.82444863,Math.pow(10,.1*o)},this.calc_xmin=function(e,t,s,a){var o,n=0,r=e.internal_flags,i=0,l=0,c=r.ATH,d=s.xr,u=e.VBR==eh.vbr_mtrh?1:0,m=r.masking_lower;for(e.VBR!=eh.vbr_mtrh&&e.VBR!=eh.vbr_mt||(m=1),o=0;o<s.psy_lmax;o++){y=(b=e.VBR==eh.vbr_rh||e.VBR==eh.vbr_mtrh?athAdjust(c.adjust,c.l[o],c.floor):c.adjust*c.l[o])/(g=s.width[o]),x=2220446049250313e-31,M=g>>1,S=0;do{S+=A=d[i]*d[i],x+=A<y?A:y,S+=R=d[++i]*d[i],x+=R<y?R:y,i++}while(--M>0);if(S>b&&l++,o==ap.SBPSY_l)x<(k=b*r.nsPsy.longfact[o])&&(x=k);if(0!=u&&(b=x),!e.ATHonly)if((w=t.en.l[o])>0)k=S*t.thm.l[o]*m/w,0!=u&&(k*=r.nsPsy.longfact[o]),b<k&&(b=k);a[n++]=0!=u?b:b*r.nsPsy.longfact[o]}var p=575;if(s.block_type!=ap.SHORT_TYPE)for(var h=576;0!=h--&&vh.EQ(d[h],0);)p=h;s.max_nonzero_coeff=p;for(var f=s.sfb_smin;o<s.psymax;f++,o+=3){var g,_,v;for(v=e.VBR==eh.vbr_rh||e.VBR==eh.vbr_mtrh?athAdjust(c.adjust,c.s[f],c.floor):c.adjust*c.s[f],g=s.width[o],_=0;_<3;_++){var b,y,x,w,k,S=0,M=g>>1;y=v/g,x=2220446049250313e-31;do{var A,R;S+=A=d[i]*d[i],x+=A<y?A:y,S+=R=d[++i]*d[i],x+=R<y?R:y,i++}while(--M>0);if(S>v&&l++,f==ap.SBPSY_s)x<(k=v*r.nsPsy.shortfact[f])&&(x=k);if(b=0!=u?x:v,!e.ATHonly&&!e.ATHshort)if((w=t.en.s[f][_])>0)k=S*t.thm.s[f][_]*m/w,0!=u&&(k*=r.nsPsy.shortfact[f]),b<k&&(b=k);a[n++]=0!=u?b:b*r.nsPsy.shortfact[f]}e.useTemporal&&(a[n-3]>a[n-3+1]&&(a[n-3+1]+=(a[n-3]-a[n-3+1])*r.decay),a[n-3+1]>a[n-3+2]&&(a[n-3+2]+=(a[n-3+1]-a[n-3+2])*r.decay))}return l},this.calc_noise_core=function(e,t,s,a){var o=0,n=t.s,r=e.l3_enc;if(n>e.count1)for(;0!=s--;){l=e.xr[n],n++,o+=l*l,l=e.xr[n],n++,o+=l*l}else if(n>e.big_values){var i=ah(2);for(i[0]=0,i[1]=a;0!=s--;){l=Math.abs(e.xr[n])-i[r[n]],n++,o+=l*l,l=Math.abs(e.xr[n])-i[r[n]],n++,o+=l*l}}else for(;0!=s--;){var l;l=Math.abs(e.xr[n])-c[r[n]]*a,n++,o+=l*l,l=Math.abs(e.xr[n])-c[r[n]]*a,n++,o+=l*l}return t.s=n,o},this.calc_noise=function(e,t,s,a,o){var n,l,c=0,d=0,u=0,p=0,h=0,f=-20,g=0,_=e.scalefac,v=0;for(a.over_SSD=0,n=0;n<e.psymax;n++){var b,y=e.global_gain-(_[v++]+(0!=e.preflag?r[n]:0)<<e.scalefac_scale+1)-8*e.subblock_gain[e.window[n]],x=0;if(null!=o&&o.step[n]==y)x=o.noise[n],g+=e.width[n],s[c++]=x/t[d++],x=o.noise_log[n];else{var w,k=i[y+rh.Q_MAX2];if(l=e.width[n]>>1,g+e.width[n]>e.max_nonzero_coeff)l=(w=e.max_nonzero_coeff-g+1)>0?w>>1:0;var S=new m(g);x=this.calc_noise_core(e,S,l,k),g=S.s,null!=o&&(o.step[n]=y,o.noise[n]=x),x=s[c++]=x/t[d++],x=sh.FAST_LOG10(Math.max(x,1e-20)),null!=o&&(o.noise_log[n]=x)}if(null!=o&&(o.global_gain=e.global_gain),h+=x,x>0)b=Math.max(0|10*x+.5,1),a.over_SSD+=b*b,u++,p+=x;f=Math.max(f,x)}return a.over_count=u,a.tot_noise=h,a.over_noise=p,a.max_noise=f,u},this.set_pinfo=function(e,t,s,a,o){var n,i,l,c,d,u=e.internal_flags,m=0==t.scalefac_scale?.5:1,p=t.scalefac,h=ah(L3Side.SFBMAX),f=ah(L3Side.SFBMAX),g=new CalcNoiseResult;calc_xmin(e,s,t,h),calc_noise(t,h,f,g,null);var _=0;for(i=t.sfb_lmax,t.block_type!=ap.SHORT_TYPE&&0==t.mixed_block_flag&&(i=22),n=0;n<i;n++){var v=u.scalefac_band.l[n],b=(y=u.scalefac_band.l[n+1])-v;for(c=0;_<y;_++)c+=t.xr[_]*t.xr[_];c/=b,d=1e15,u.pinfo.en[a][o][n]=d*c,u.pinfo.xfsf[a][o][n]=d*h[n]*f[n]/b,s.en.l[n]>0&&!e.ATHonly?c/=s.en.l[n]:c=0,u.pinfo.thr[a][o][n]=d*Math.max(c*s.thm.l[n],u.ATH.l[n]),u.pinfo.LAMEsfb[a][o][n]=0,0!=t.preflag&&n>=11&&(u.pinfo.LAMEsfb[a][o][n]=-m*r[n]),n<ap.SBPSY_l&&(nh(p[n]>=0),u.pinfo.LAMEsfb[a][o][n]-=m*p[n])}if(t.block_type==ap.SHORT_TYPE)for(i=n,n=t.sfb_smin;n<ap.SBMAX_s;n++){v=u.scalefac_band.s[n],b=(y=u.scalefac_band.s[n+1])-v;for(var y,x=0;x<3;x++){for(c=0,l=v;l<y;l++)c+=t.xr[_]*t.xr[_],_++;c=Math.max(c/b,1e-20),d=1e15,u.pinfo.en_s[a][o][3*n+x]=d*c,u.pinfo.xfsf_s[a][o][3*n+x]=d*h[i]*f[i]/b,s.en.s[n][x]>0?c/=s.en.s[n][x]:c=0,(e.ATHonly||e.ATHshort)&&(c=0),u.pinfo.thr_s[a][o][3*n+x]=d*Math.max(c*s.thm.s[n][x],u.ATH.s[n]),u.pinfo.LAMEsfb_s[a][o][3*n+x]=-2*t.subblock_gain[x],n<ap.SBPSY_s&&(u.pinfo.LAMEsfb_s[a][o][3*n+x]-=m*p[i]),i++}}u.pinfo.LAMEqss[a][o]=t.global_gain,u.pinfo.LAMEmainbits[a][o]=t.part2_3_length+t.part2_length,u.pinfo.LAMEsfbits[a][o]=t.part2_length,u.pinfo.over[a][o]=g.over_count,u.pinfo.max_noise[a][o]=10*g.max_noise,u.pinfo.over_noise[a][o]=10*g.over_noise,u.pinfo.tot_noise[a][o]=10*g.tot_noise,u.pinfo.over_SSD[a][o]=g.over_SSD}}rh.Q_MAX=257,rh.Q_MAX2=116,rh.LARGE_BITS=1e5,rh.IXMAX_VAL=8206;var ih=Hm.System,lh=Hm.Arrays,ch=Hm.new_int,dh=Hm.assert;function uh(){var e=null;function t(e){this.bits=0|e}this.qupvt=null,this.setModules=function(t){this.qupvt=t,e=t};var s=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function a(e,t,s,a,o,n){var r=.5946/t;for(e>>=1;0!=e--;)o[n++]=r>s[a++]?0:1,o[n++]=r>s[a++]?0:1}function o(t,s,a,o,n,r){var i=(t>>=1)%2;for(t>>=1;0!=t--;){var l,c,d,u,m,p,h,f;l=a[o++]*s,c=a[o++]*s,m=0|l,d=a[o++]*s,p=0|c,u=a[o++]*s,h=0|d,l+=e.adj43[m],f=0|u,c+=e.adj43[p],n[r++]=0|l,d+=e.adj43[h],n[r++]=0|c,u+=e.adj43[f],n[r++]=0|d,n[r++]=0|u}0!=i&&(m=0|(l=a[o++]*s),p=0|(c=a[o++]*s),l+=e.adj43[m],c+=e.adj43[p],n[r++]=0|l,n[r++]=0|c)}var n=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function r(e,t,s,a){var o=function(e,t,s){var a=0,o=0;do{var n=e[t++],r=e[t++];a<n&&(a=n),o<r&&(o=r)}while(t<s);return a<o&&(a=o),a}(e,t,s);switch(o){case 0:return o;case 1:return function(e,t,s,a){var o=0,n=Jp.ht[1].hlen;do{var r=2*e[t+0]+e[t+1];t+=2,o+=n[r]}while(t<s);return a.bits+=o,1}(e,t,s,a);case 2:case 3:return function(e,t,s,a,o){var n,r,i=0,l=Jp.ht[a].xlen;r=2==a?Jp.table23:Jp.table56;do{var c=e[t+0]*l+e[t+1];t+=2,i+=r[c]}while(t<s);return n=65535&i,(i>>=16)>n&&(i=n,a++),o.bits+=i,a}(e,t,s,n[o-1],a);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return function(e,t,s,a,o){var n=0,r=0,i=0,l=Jp.ht[a].xlen,c=Jp.ht[a].hlen,d=Jp.ht[a+1].hlen,u=Jp.ht[a+2].hlen;do{var m=e[t+0]*l+e[t+1];t+=2,n+=c[m],r+=d[m],i+=u[m]}while(t<s);var p=a;return n>r&&(n=r,p++),n>i&&(n=i,p=a+2),o.bits+=n,p}(e,t,s,n[o-1],a);default:if(o>rh.IXMAX_VAL)return a.bits=rh.LARGE_BITS,-1;var r,i;for(o-=15,r=24;r<32&&!(Jp.ht[r].linmax>=o);r++);for(i=r-8;i<24&&!(Jp.ht[i].linmax>=o);i++);return function(e,t,s,a,o,n){var r,i=65536*Jp.ht[a].xlen+Jp.ht[o].xlen,l=0;do{var c=e[t++],d=e[t++];0!=c&&(c>14&&(c=15,l+=i),c*=16),0!=d&&(d>14&&(d=15,l+=i),c+=d),l+=Jp.largetbl[c]}while(t<s);return r=65535&l,(l>>=16)>r&&(l=r,a=o),n.bits+=l,a}(e,t,s,i,r,a)}}function i(e,s,a,o,n,i,l,c){for(var d=s.big_values,u=2;u<ap.SBMAX_l+1;u++){var m=e.scalefac_band.l[u];if(m>=d)break;var p=n[u-2]+s.count1bits;if(a.part2_3_length<=p)break;var h=new t(p),f=r(o,m,d,h);p=h.bits,a.part2_3_length<=p||(a.assign(s),a.part2_3_length=p,a.region0_count=i[u-2],a.region1_count=u-2-i[u-2],a.table_select[0]=l[u-2],a.table_select[1]=c[u-2],a.table_select[2]=f)}}this.noquant_count_bits=function(e,s,a){var o=s.l3_enc,n=Math.min(576,s.max_nonzero_coeff+2>>1<<1);for(null!=a&&(a.sfb_count1=0);n>1&&0==(o[n-1]|o[n-2]);n-=2);s.count1=n;for(var i=0,l=0;n>3;n-=4){var c;if((2147483647&(o[n-1]|o[n-2]|o[n-3]|o[n-4]))>1)break;c=2*(2*(2*o[n-4]+o[n-3])+o[n-2])+o[n-1],i+=Jp.t32l[c],l+=Jp.t33l[c]}var d=i;if(s.count1table_select=0,i>l&&(d=l,s.count1table_select=1),s.count1bits=d,s.big_values=n,0==n)return d;if(s.block_type==ap.SHORT_TYPE)(i=3*e.scalefac_band.s[3])>s.big_values&&(i=s.big_values),l=s.big_values;else if(s.block_type==ap.NORM_TYPE){if(i=s.region0_count=e.bv_scf[n-2],l=s.region1_count=e.bv_scf[n-1],l=e.scalefac_band.l[i+l+2],i=e.scalefac_band.l[i+1],l<n){var u=new t(d);s.table_select[2]=r(o,l,n,u),d=u.bits}}else s.region0_count=7,s.region1_count=ap.SBMAX_l-1-7-1,(i=e.scalefac_band.l[8])>(l=n)&&(i=l);if(i=Math.min(i,n),l=Math.min(l,n),i>0){u=new t(d);s.table_select[0]=r(o,0,i,u),d=u.bits}if(i<l){u=new t(d);s.table_select[1]=r(o,i,l,u),d=u.bits}if(2==e.use_best_huffman&&(s.part2_3_length=d,best_huffman_divide(e,s),d=s.part2_3_length),null!=a&&s.block_type==ap.NORM_TYPE){for(var m=0;e.scalefac_band.l[m]<s.big_values;)m++;a.sfb_count1=m}return d},this.count_bits=function(t,s,n,r){var i=n.l3_enc,l=rh.IXMAX_VAL/e.IPOW20(n.global_gain);if(n.xrpow_max>l)return rh.LARGE_BITS;if(function(t,s,n,r,i){var l,c,d,u=0,m=0,p=0,h=0,f=s,g=0,_=f,v=0,b=t,y=0;for(d=null!=i&&r.global_gain==i.global_gain,c=r.block_type==ap.SHORT_TYPE?38:21,l=0;l<=c;l++){var x=-1;if((d||r.block_type==ap.NORM_TYPE)&&(x=r.global_gain-(r.scalefac[l]+(0!=r.preflag?e.pretab[l]:0)<<r.scalefac_scale+1)-8*r.subblock_gain[r.window[l]]),dh(r.width[l]>=0),d&&i.step[l]==x)0!=m&&(o(m,n,b,y,_,v),m=0),0!=p&&(a(p,n,b,y,_,v),p=0);else{var w,k=r.width[l];if(u+r.width[l]>r.max_nonzero_coeff)w=r.max_nonzero_coeff-u+1,lh.fill(s,r.max_nonzero_coeff,576,0),(k=w)<0&&(k=0),l=c+1;if(0==m&&0==p&&(_=f,v=g,b=t,y=h),null!=i&&i.sfb_count1>0&&l>=i.sfb_count1&&i.step[l]>0&&x>=i.step[l]?(0!=m&&(o(m,n,b,y,_,v),m=0,_=f,v=g,b=t,y=h),p+=k):(0!=p&&(a(p,n,b,y,_,v),p=0,_=f,v=g,b=t,y=h),m+=k),k<=0){0!=p&&(a(p,n,b,y,_,v),p=0),0!=m&&(o(m,n,b,y,_,v),m=0);break}}l<=c&&(g+=r.width[l],h+=r.width[l],u+=r.width[l])}0!=m&&(o(m,n,b,y,_,v),m=0),0!=p&&(a(p,n,b,y,_,v),p=0)}(s,i,e.IPOW20(n.global_gain),n,r),0!=(2&t.substep_shaping))for(var c=0,d=n.global_gain+n.scalefac_scale,u=.634521682242439/e.IPOW20(d),m=0;m<n.sfbmax;m++){var p,h=n.width[m];if(0==t.pseudohalf[m])c+=h;else for(p=c,c+=h;p<c;++p)i[p]=s[p]>=u?i[p]:0}return this.noquant_count_bits(t,n,r)},this.best_huffman_divide=function(e,s){var a=new xp,o=s.l3_enc,n=ch(23),l=ch(23),c=ch(23),d=ch(23);if(s.block_type!=ap.SHORT_TYPE||1!=e.mode_gr){a.assign(s),s.block_type==ap.NORM_TYPE&&(!function(e,s,a,o,n,i,l){for(var c=s.big_values,d=0;d<=22;d++)o[d]=rh.LARGE_BITS;for(d=0;d<16;d++){var u=e.scalefac_band.l[d+1];if(u>=c)break;var m=0,p=new t(m),h=r(a,0,u,p);m=p.bits;for(var f=0;f<8;f++){var g=e.scalefac_band.l[d+f+2];if(g>=c)break;var _=m,v=r(a,u,g,p=new t(_));_=p.bits,o[d+f]>_&&(o[d+f]=_,n[d+f]=d,i[d+f]=h,l[d+f]=v)}}}(e,s,o,n,l,c,d),i(e,a,s,o,n,l,c,d));var u=a.big_values;if(!(0==u||(o[u-2]|o[u-1])>1||(u=s.count1+2)>576)){a.assign(s),a.count1=u;for(var m=0,p=0;u>a.big_values;u-=4){var h=2*(2*(2*o[u-4]+o[u-3])+o[u-2])+o[u-1];m+=Jp.t32l[h],p+=Jp.t33l[h]}if(a.big_values=u,a.count1table_select=0,m>p&&(m=p,a.count1table_select=1),a.count1bits=m,a.block_type==ap.NORM_TYPE)i(e,a,s,o,n,l,c,d);else{if(a.part2_3_length=m,(m=e.scalefac_band.l[8])>u&&(m=u),m>0){var f=new t(a.part2_3_length);a.table_select[0]=r(o,0,m,f),a.part2_3_length=f.bits}if(u>m){f=new t(a.part2_3_length);a.table_select[1]=r(o,m,u,f),a.part2_3_length=f.bits}s.part2_3_length>a.part2_3_length&&s.assign(a)}}}};var l=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],c=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],d=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],u=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];uh.slen1_tab=d,uh.slen2_tab=u,this.best_scalefac_store=function(t,s,a,o){var n,r,i,m,p=o.tt[s][a],h=0;for(i=0,n=0;n<p.sfbmax;n++){var f=p.width[n];for(i+=f,m=-f;m<0&&0==p.l3_enc[m+i];m++);0==m&&(p.scalefac[n]=h=-2)}if(0==p.scalefac_scale&&0==p.preflag){var g=0;for(n=0;n<p.sfbmax;n++)p.scalefac[n]>0&&(g|=p.scalefac[n]);if(0==(1&g)&&0!=g){for(n=0;n<p.sfbmax;n++)p.scalefac[n]>0&&(p.scalefac[n]>>=1);p.scalefac_scale=h=1}}if(0==p.preflag&&p.block_type!=ap.SHORT_TYPE&&2==t.mode_gr){for(n=11;n<ap.SBPSY_l&&!(p.scalefac[n]<e.pretab[n]&&-2!=p.scalefac[n]);n++);if(n==ap.SBPSY_l){for(n=11;n<ap.SBPSY_l;n++)p.scalefac[n]>0&&(p.scalefac[n]-=e.pretab[n]);p.preflag=h=1}}for(r=0;r<4;r++)o.scfsi[a][r]=0;for(2==t.mode_gr&&1==s&&o.tt[0][a].block_type!=ap.SHORT_TYPE&&o.tt[1][a].block_type!=ap.SHORT_TYPE&&(!function(e,t){for(var s,a=t.tt[1][e],o=t.tt[0][e],n=0;n<Jp.scfsi_band.length-1;n++){for(s=Jp.scfsi_band[n];s<Jp.scfsi_band[n+1]&&!(o.scalefac[s]!=a.scalefac[s]&&a.scalefac[s]>=0);s++);if(s==Jp.scfsi_band[n+1]){for(s=Jp.scfsi_band[n];s<Jp.scfsi_band[n+1];s++)a.scalefac[s]=-1;t.scfsi[e][n]=1}}var r=0,i=0;for(s=0;s<11;s++)-1!=a.scalefac[s]&&(i++,r<a.scalefac[s]&&(r=a.scalefac[s]));for(var m=0,p=0;s<ap.SBPSY_l;s++)-1!=a.scalefac[s]&&(p++,m<a.scalefac[s]&&(m=a.scalefac[s]));for(n=0;n<16;n++)if(r<l[n]&&m<c[n]){var h=d[n]*i+u[n]*p;a.part2_length>h&&(a.part2_length=h,a.scalefac_compress=n)}}(a,o),h=0),n=0;n<p.sfbmax;n++)-2==p.scalefac[n]&&(p.scalefac[n]=0);0!=h&&(2==t.mode_gr?this.scale_bitcount(p):this.scale_bitcount_lsf(t,p))};var m=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],p=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],h=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(t){var s,a,o,n=0,r=0,i=t.scalefac;if(dh(function(e,t){for(var s=0;s<t;++s)if(e[s]<0)return!1;return!0}(i,t.sfbmax)),t.block_type==ap.SHORT_TYPE)o=m,0!=t.mixed_block_flag&&(o=p);else if(o=h,0==t.preflag){for(a=11;a<ap.SBPSY_l&&!(i[a]<e.pretab[a]);a++);if(a==ap.SBPSY_l)for(t.preflag=1,a=11;a<ap.SBPSY_l;a++)i[a]-=e.pretab[a]}for(a=0;a<t.sfbdivide;a++)n<i[a]&&(n=i[a]);for(;a<t.sfbmax;a++)r<i[a]&&(r=i[a]);for(t.part2_length=rh.LARGE_BITS,s=0;s<16;s++)n<l[s]&&r<c[s]&&t.part2_length>o[s]&&(t.part2_length=o[s],t.scalefac_compress=s);return t.part2_length==rh.LARGE_BITS};var f=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(t,s){var a,o,n,r,i,l,c,d,u=ch(4),m=s.scalefac;for(a=0!=s.preflag?2:0,c=0;c<4;c++)u[c]=0;if(s.block_type==ap.SHORT_TYPE){o=1;var p=e.nr_of_sfb_block[a][o];for(d=0,n=0;n<4;n++)for(r=p[n]/3,c=0;c<r;c++,d++)for(i=0;i<3;i++)m[3*d+i]>u[n]&&(u[n]=m[3*d+i])}else{o=0;p=e.nr_of_sfb_block[a][o];for(d=0,n=0;n<4;n++)for(r=p[n],c=0;c<r;c++,d++)m[d]>u[n]&&(u[n]=m[d])}for(l=!1,n=0;n<4;n++)u[n]>f[a][n]&&(l=!0);if(!l){var h,_,v,b;for(s.sfb_partition_table=e.nr_of_sfb_block[a][o],n=0;n<4;n++)s.slen[n]=g[u[n]];switch(h=s.slen[0],_=s.slen[1],v=s.slen[2],b=s.slen[3],a){case 0:s.scalefac_compress=(5*h+_<<4)+(v<<2)+b;break;case 1:s.scalefac_compress=400+(5*h+_<<2)+v;break;case 2:s.scalefac_compress=500+3*h+_;break;default:ih.err.printf("intensity stereo not implemented yet\n")}}if(!l)for(dh(null!=s.sfb_partition_table),s.part2_length=0,n=0;n<4;n++)s.part2_length+=s.slen[n]*s.sfb_partition_table[n];return l};var g=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(e){for(var t=2;t<=576;t+=2){for(var a,o=0;e.scalefac_band.l[++o]<t;);for(a=s[o][0];e.scalefac_band.l[a+1]>t;)a--;for(a<0&&(a=s[o][0]),e.bv_scf[t-2]=a,a=s[o][1];e.scalefac_band.l[a+e.bv_scf[t-2]+2]>t;)a--;a<0&&(a=s[o][1]),e.bv_scf[t-1]=a}}}var mh=Hm.System,ph=Hm.Arrays,hh=Hm.new_byte,fh=Hm.new_float_n,gh=Hm.new_int,_h=Hm.assert;function vh(){var e=this,t=null,s=null,a=null,o=null;this.setModules=function(e,n,r,i){t=e,s=n,a=r,o=i};var n=null,r=0,i=0,l=0;function c(e){mh.arraycopy(e.header[e.w_ptr].buf,0,n,i,e.sideinfo_len),i+=e.sideinfo_len,r+=8*e.sideinfo_len,e.w_ptr=e.w_ptr+1&Hp.MAX_HEADER_BUF-1}function d(e,t,s){for(;s>0;){var a;0==l&&(l=8,i++,_h(e.header[e.w_ptr].write_timing>=r),e.header[e.w_ptr].write_timing==r&&c(e),n[i]=0),s-=a=Math.min(s,l),l-=a,n[i]|=t>>s<<l,r+=a}}function u(e,t,s){for(;s>0;){var a;0==l&&(l=8,i++,n[i]=0),s-=a=Math.min(s,l),l-=a,n[i]|=t>>s<<l,r+=a}}function m(e,t){var s,o=e.internal_flags;if(t>=8&&(d(o,76,8),t-=8),t>=8&&(d(o,65,8),t-=8),t>=8&&(d(o,77,8),t-=8),t>=8&&(d(o,69,8),t-=8),t>=32){var n=a.getLameShortVersion();if(t>=32)for(s=0;s<n.length&&t>=8;++s)t-=8,d(o,n.charAt(s),8)}for(;t>=1;t-=1)d(o,o.ancillary_flag,1),o.ancillary_flag^=e.disable_reservoir?0:1}function p(e,t,s){for(var a=e.header[e.h_ptr].ptr;s>0;){var o=Math.min(s,8-(7&a));s-=o,e.header[e.h_ptr].buf[a>>3]|=t>>s<<8-(7&a)-o,a+=o}e.header[e.h_ptr].ptr=a}function h(e,t){e<<=8;for(var s=0;s<8;s++)0!=(65536&((t<<=1)^(e<<=1)))&&(t^=32773);return t}function f(e,t){var s,a=Jp.ht[t.count1table_select+32],o=0,n=t.big_values,r=t.big_values;for(_h(t.count1table_select<2),s=(t.count1-t.big_values)/4;s>0;--s){var i=0,l=0;0!=t.l3_enc[n+0]&&(l+=8,t.xr[r+0]<0&&i++),0!=t.l3_enc[n+1]&&(l+=4,i*=2,t.xr[r+1]<0&&i++),0!=t.l3_enc[n+2]&&(l+=2,i*=2,t.xr[r+2]<0&&i++),0!=t.l3_enc[n+3]&&(l++,i*=2,t.xr[r+3]<0&&i++),n+=4,r+=4,d(e,i+a.table[l],a.hlen[l]),o+=a.hlen[l]}return o}function g(e,t,s,a,o){var n=Jp.ht[t],r=0;if(0==t)return r;for(var i=s;i<a;i+=2){var l=0,c=0,u=n.xlen,m=n.xlen,p=0,h=o.l3_enc[i],f=o.l3_enc[i+1];if(0!=h&&(o.xr[i]<0&&p++,l--),t>15){if(h>14){var g=h-15;_h(g<=n.linmax),p|=g<<1,c=u,h=15}if(f>14){var _=f-15;_h(_<=n.linmax),p<<=u,p|=_,c+=u,f=15}m=16}0!=f&&(p<<=1,o.xr[i+1]<0&&p++,l--),h=h*m+f,c-=l,l+=n.hlen[h],d(e,n.table[h],l),d(e,p,c),r+=l+c}return r}function _(e,t){var s=3*e.scalefac_band.s[3];s>t.big_values&&(s=t.big_values);var a=g(e,t.table_select[0],0,s,t);return a+=g(e,t.table_select[1],s,t.big_values,t)}function v(e,t){var s,a,o,n;s=t.big_values;var r=t.region0_count+1;return _h(r<e.scalefac_band.l.length),o=e.scalefac_band.l[r],r+=t.region1_count+1,_h(r<e.scalefac_band.l.length),o>s&&(o=s),(n=e.scalefac_band.l[r])>s&&(n=s),a=g(e,t.table_select[0],0,o,t),a+=g(e,t.table_select[1],o,n,t),a+=g(e,t.table_select[2],n,s,t)}function b(){this.total=0}function y(t,s){var a,o,n,l,c,d=t.internal_flags;return c=d.w_ptr,-1==(l=d.h_ptr-1)&&(l=Hp.MAX_HEADER_BUF-1),a=d.header[l].write_timing-r,s.total=a,a>=0&&(o=1+l-c,l<c&&(o=1+l-c+Hp.MAX_HEADER_BUF),a-=8*o*d.sideinfo_len),a+=n=e.getframebits(t),s.total+=n,s.total%8!=0?s.total=1+s.total/8:s.total=s.total/8,s.total+=i+1,a<0&&mh.err.println("strange error flushing buffer ... \n"),a}this.getframebits=function(e){var t,s=e.internal_flags;return t=0!=s.bitrate_index?Jp.bitrate_table[e.version][s.bitrate_index]:e.brate,8*(0|72e3*(e.version+1)*t/e.out_samplerate+s.padding)},this.CRC_writeheader=function(e,t){var s=65535;s=h(255&t[2],s),s=h(255&t[3],s);for(var a=6;a<e.sideinfo_len;a++)s=h(255&t[a],s);t[4]=byte(s>>8),t[5]=byte(255&s)},this.flush_bitstream=function(e){var s,a,o=e.internal_flags,n=o.h_ptr-1;if(-1==n&&(n=Hp.MAX_HEADER_BUF-1),s=o.l3_side,!((a=y(e,new b))<0)){if(m(e,a),_h(o.header[n].write_timing+this.getframebits(e)==r),o.ResvSize=0,s.main_data_begin=0,o.findReplayGain){var i=t.GetTitleGain(o.rgdata);_h(NEQ(i,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),o.RadioGain=0|Math.floor(10*i+.5)}o.findPeakSample&&(o.noclipGainChange=0|Math.ceil(20*Math.log10(o.PeakSample/32767)*10),o.noclipGainChange>0&&(EQ(e.scale,1)||EQ(e.scale,0))?o.noclipScale=Math.floor(32767/o.PeakSample*100)/100:o.noclipScale=-1)}},this.add_dummy_byte=function(e,t,s){for(var a,o=e.internal_flags;s-- >0;)for(u(0,t,8),a=0;a<Hp.MAX_HEADER_BUF;++a)o.header[a].write_timing+=8},this.format_bitstream=function(e){var t,s=e.internal_flags;t=s.l3_side;var a=this.getframebits(e);m(e,t.resvDrain_pre),function(e,t){var s,a,o,n=e.internal_flags;if(s=n.l3_side,n.header[n.h_ptr].ptr=0,ph.fill(n.header[n.h_ptr].buf,0,n.sideinfo_len,0),e.out_samplerate<16e3?p(n,4094,12):p(n,4095,12),p(n,e.version,1),p(n,1,2),p(n,e.error_protection?0:1,1),p(n,n.bitrate_index,4),p(n,n.samplerate_index,2),p(n,n.padding,1),p(n,e.extension,1),p(n,e.mode.ordinal(),2),p(n,n.mode_ext,2),p(n,e.copyright,1),p(n,e.original,1),p(n,e.emphasis,2),e.error_protection&&p(n,0,16),1==e.version){for(_h(s.main_data_begin>=0),p(n,s.main_data_begin,9),2==n.channels_out?p(n,s.private_bits,3):p(n,s.private_bits,5),o=0;o<n.channels_out;o++){var r;for(r=0;r<4;r++)p(n,s.scfsi[o][r],1)}for(a=0;a<2;a++)for(o=0;o<n.channels_out;o++){p(n,(i=s.tt[a][o]).part2_3_length+i.part2_length,12),p(n,i.big_values/2,9),p(n,i.global_gain,8),p(n,i.scalefac_compress,4),i.block_type!=ap.NORM_TYPE?(p(n,1,1),p(n,i.block_type,2),p(n,i.mixed_block_flag,1),14==i.table_select[0]&&(i.table_select[0]=16),p(n,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),p(n,i.table_select[1],5),p(n,i.subblock_gain[0],3),p(n,i.subblock_gain[1],3),p(n,i.subblock_gain[2],3)):(p(n,0,1),14==i.table_select[0]&&(i.table_select[0]=16),p(n,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),p(n,i.table_select[1],5),14==i.table_select[2]&&(i.table_select[2]=16),p(n,i.table_select[2],5),_h(i.region0_count>=0&&i.region0_count<16),_h(i.region1_count>=0&&i.region1_count<8),p(n,i.region0_count,4),p(n,i.region1_count,3)),p(n,i.preflag,1),p(n,i.scalefac_scale,1),p(n,i.count1table_select,1)}}else for(_h(s.main_data_begin>=0),p(n,s.main_data_begin,8),p(n,s.private_bits,n.channels_out),a=0,o=0;o<n.channels_out;o++){var i;p(n,(i=s.tt[a][o]).part2_3_length+i.part2_length,12),p(n,i.big_values/2,9),p(n,i.global_gain,8),p(n,i.scalefac_compress,9),i.block_type!=ap.NORM_TYPE?(p(n,1,1),p(n,i.block_type,2),p(n,i.mixed_block_flag,1),14==i.table_select[0]&&(i.table_select[0]=16),p(n,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),p(n,i.table_select[1],5),p(n,i.subblock_gain[0],3),p(n,i.subblock_gain[1],3),p(n,i.subblock_gain[2],3)):(p(n,0,1),14==i.table_select[0]&&(i.table_select[0]=16),p(n,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),p(n,i.table_select[1],5),14==i.table_select[2]&&(i.table_select[2]=16),p(n,i.table_select[2],5),_h(i.region0_count>=0&&i.region0_count<16),_h(i.region1_count>=0&&i.region1_count<8),p(n,i.region0_count,4),p(n,i.region1_count,3)),p(n,i.scalefac_scale,1),p(n,i.count1table_select,1)}e.error_protection&&CRC_writeheader(n,n.header[n.h_ptr].buf);var l=n.h_ptr;_h(n.header[l].ptr==8*n.sideinfo_len),n.h_ptr=l+1&Hp.MAX_HEADER_BUF-1,n.header[n.h_ptr].write_timing=n.header[l].write_timing+t,n.h_ptr==n.w_ptr&&mh.err.println("Error: MAX_HEADER_BUF too small in bitstream.c \n")}(e,a);var o=8*s.sideinfo_len;if(o+=function(e){var t,s,a,o,n=0,r=e.internal_flags,i=r.l3_side;if(1==e.version)for(t=0;t<2;t++)for(s=0;s<r.channels_out;s++){var l=i.tt[t][s],c=uh.slen1_tab[l.scalefac_compress],u=uh.slen2_tab[l.scalefac_compress];for(o=0,a=0;a<l.sfbdivide;a++)-1!=l.scalefac[a]&&(d(r,l.scalefac[a],c),o+=c);for(;a<l.sfbmax;a++)-1!=l.scalefac[a]&&(d(r,l.scalefac[a],u),o+=u);_h(o==l.part2_length),l.block_type==ap.SHORT_TYPE?o+=_(r,l):o+=v(r,l),o+=f(r,l),_h(o==l.part2_3_length+l.part2_length),n+=o}else for(t=0,s=0;s<r.channels_out;s++){l=i.tt[t][s];var m,p,h=0;if(_h(null!=l.sfb_partition_table),o=0,a=0,p=0,l.block_type==ap.SHORT_TYPE){for(;p<4;p++){var g=l.sfb_partition_table[p]/3,b=l.slen[p];for(m=0;m<g;m++,a++)d(r,Math.max(l.scalefac[3*a+0],0),b),d(r,Math.max(l.scalefac[3*a+1],0),b),d(r,Math.max(l.scalefac[3*a+2],0),b),h+=3*b}o+=_(r,l)}else{for(;p<4;p++){g=l.sfb_partition_table[p],b=l.slen[p];for(m=0;m<g;m++,a++)d(r,Math.max(l.scalefac[a],0),b),h+=b}o+=v(r,l)}o+=f(r,l),_h(o==l.part2_3_length),_h(h==l.part2_length),n+=h+o}return n}(e),m(e,t.resvDrain_post),o+=t.resvDrain_post,t.main_data_begin+=(a-o)/8,y(e,new b)!=s.ResvSize&&mh.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),8*t.main_data_begin!=s.ResvSize&&(mh.err.printf("bit reservoir error: \nl3_side.main_data_begin: %d \nResvoir size:             %d \nresv drain (post)         %d \nresv drain (pre)          %d \nheader and sideinfo:      %d \ndata bits:                %d \ntotal bits:               %d (remainder: %d) \nbitsperframe:             %d \n",8*t.main_data_begin,s.ResvSize,t.resvDrain_post,t.resvDrain_pre,8*s.sideinfo_len,o-t.resvDrain_post-8*s.sideinfo_len,o,o%8,a),mh.err.println("This is a fatal error.  It has several possible causes:"),mh.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),mh.err.println(" 9%%  Your system is overclocked"),mh.err.println(" 1%%  bug in LAME encoding library"),s.ResvSize=8*t.main_data_begin),r>1e9){var n;for(n=0;n<Hp.MAX_HEADER_BUF;++n)s.header[n].write_timing-=r;r=0}return 0},this.copy_buffer=function(e,a,r,c,d){var u=i+1;if(u<=0)return 0;if(0!=c&&u>c)return-1;if(mh.arraycopy(n,0,a,r,u),i=-1,l=0,0!=d){var m=gh(1);if(m[0]=e.nMusicCRC,o.updateMusicCRC(m,a,r,u),e.nMusicCRC=m[0],u>0&&(e.VBR_seek_table.nBytesWritten+=u),e.decode_on_the_fly)for(var p,h=fh([2,1152]),f=u,g=-1;0!=g;)if(g=s.hip_decode1_unclipped(e.hip,a,r,f,h[0],h[1]),f=0,-1==g&&(g=0),g>0){if(e.findPeakSample){for(p=0;p<g;p++)h[0][p]>e.PeakSample?e.PeakSample=h[0][p]:-h[0][p]>e.PeakSample&&(e.PeakSample=-h[0][p]);if(e.channels_out>1)for(p=0;p<g;p++)h[1][p]>e.PeakSample?e.PeakSample=h[1][p]:-h[1][p]>e.PeakSample&&(e.PeakSample=-h[1][p])}if(e.findReplayGain&&t.AnalyzeSamples(e.rgdata,h[0],0,h[1],0,g,e.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}return u},this.init_bit_stream_w=function(e){n=hh(Ah.LAME_MAXMP3BUFFER),e.h_ptr=e.w_ptr=0,e.header[e.h_ptr].write_timing=0,i=-1,l=0,r=0}}vh.EQ=function(e,t){return Math.abs(e)>Math.abs(t)?Math.abs(e-t)<=1e-6*Math.abs(e):Math.abs(e-t)<=1e-6*Math.abs(t)},vh.NEQ=function(e,t){return!vh.EQ(e,t)};var bh=Hm.System,yh=Hm.VbrMode,xh=Hm.ShortBlock,wh=Hm.new_float,kh=Hm.new_int_n,Sh=Hm.new_short_n,Mh=Hm.assert;function Ah(){var e=this;Ah.V9=410,Ah.V8=420,Ah.V7=430,Ah.V6=440,Ah.V5=450,Ah.V4=460,Ah.V3=470,Ah.V2=480,Ah.V1=490,Ah.V0=500,Ah.R3MIX=1e3,Ah.STANDARD=1001,Ah.EXTREME=1002,Ah.INSANE=1003,Ah.STANDARD_FAST=1004,Ah.EXTREME_FAST=1005,Ah.MEDIUM=1006,Ah.MEDIUM_FAST=1007;var t,s,a,o,n;Ah.LAME_MAXMP3BUFFER=147456;var r,i,l,c=new gp;function d(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=wh(ap.SBMAX_l),this.bo_s_weight=wh(ap.SBMAX_s)}function u(){this.lowerlimit=0}function m(e,t){this.lowpass=t}this.enc=new ap,this.setModules=function(e,d,u,m,p,h,f,g,_){t=e,s=d,a=u,o=m,n=p,r=h,i=g,l=_,this.enc.setModules(s,c,o,r)};function p(e){return e>1?0:e<=0?1:Math.cos(Math.PI/2*e)}function h(e,t){switch(e){case 44100:return t.version=1,0;case 48e3:return t.version=1,1;case 32e3:return t.version=1,2;case 22050:return t.version=0,0;case 24e3:return t.version=0,1;case 16e3:return t.version=0,2;case 11025:return t.version=0,0;case 12e3:return t.version=0,1;case 8e3:return t.version=0,2;default:return t.version=0,-1}}function f(e,t,s){s<16e3&&(t=2);for(var a=Jp.bitrate_table[t][1],o=2;o<=14;o++)Jp.bitrate_table[t][o]>0&&Math.abs(Jp.bitrate_table[t][o]-e)<Math.abs(a-e)&&(a=Jp.bitrate_table[t][o]);return a}function g(e,t,s){s<16e3&&(t=2);for(var a=0;a<=14;a++)if(Jp.bitrate_table[t][a]>0&&Jp.bitrate_table[t][a]==e)return a;return-1}function _(t,s){var a=[new m(8,2e3),new m(16,3700),new m(24,3900),new m(32,5500),new m(40,7e3),new m(48,7500),new m(56,1e4),new m(64,11e3),new m(80,13500),new m(96,15100),new m(112,15600),new m(128,17e3),new m(160,17500),new m(192,18600),new m(224,19400),new m(256,19700),new m(320,20500)],o=e.nearestBitrateFullIndex(s);t.lowerlimit=a[o].lowpass}function v(e){var t=ap.BLKSIZE+e.framesize-ap.FFTOFFSET;return t=Math.max(t,512+e.framesize-32)}function b(t,s,a,o,n,r){var i=e.enc.lame_encode_mp3_frame(t,s,a,o,n,r);return t.frameNum++,i}function y(){this.n_in=0,this.n_out=0}function x(){this.num_used=0}function w(e,t,s){var a=Math.PI*t;(e/=s)<0&&(e=0),e>1&&(e=1);var o=e-.5,n=.42-.5*Math.cos(2*e*Math.PI)+.08*Math.cos(4*e*Math.PI);return Math.abs(o)<1e-9?a/Math.PI:n*Math.sin(s*a*o)/(Math.PI*s*o)}function k(e,t,s,a,o,n,r,i,l){var c,d,u=e.internal_flags,m=0,p=e.out_samplerate/function e(t,s){return 0!=s?e(s,t%s):t}(e.out_samplerate,e.in_samplerate);p>Hp.BPC&&(p=Hp.BPC);var h=Math.abs(u.resample_ratio-Math.floor(.5+u.resample_ratio))<1e-4?1:0,f=1/u.resample_ratio;f>1&&(f=1);var g=31;g%2==0&&--g;var _=(g+=h)+1;if(0==u.fill_buffer_resample_init){for(u.inbuf_old[0]=wh(_),u.inbuf_old[1]=wh(_),c=0;c<=2*p;++c)u.blackfilt[c]=wh(_);for(u.itime[0]=0,u.itime[1]=0,m=0;m<=2*p;m++){var v=0,b=(m-p)/(2*p);for(c=0;c<=g;c++)v+=u.blackfilt[m][c]=w(c-b,f,g);for(c=0;c<=g;c++)u.blackfilt[m][c]/=v}u.fill_buffer_resample_init=1}var y=u.inbuf_old[l];for(d=0;d<a;d++){var x,k;if(x=d*u.resample_ratio,g+(m=0|Math.floor(x-u.itime[l]))-g/2>=r)break;b=x-u.itime[l]-(m+g%2*.5);k=0|Math.floor(2*b*p+p+.5);var S=0;for(c=0;c<=g;++c){var M=0|c+m-g/2;S+=(M<0?y[_+M]:o[n+M])*u.blackfilt[k][c]}t[s+d]=S}if(i.num_used=Math.min(r,g+m-g/2),u.itime[l]+=i.num_used-d*u.resample_ratio,i.num_used>=_)for(c=0;c<_;c++)y[c]=o[n+i.num_used+c-_];else{var A=_-i.num_used;for(c=0;c<A;++c)y[c]=y[c+i.num_used];for(m=0;c<_;++c,++m)y[c]=o[n+m];Mh(m==i.num_used)}return d}function S(e,t,s,a,o,n){var r=e.internal_flags;if(r.resample_ratio<.9999||r.resample_ratio>1.0001)for(var i=0;i<r.channels_out;i++){var l=new x;n.n_out=k(e,t[i],r.mf_size,e.framesize,s[i],a,o,l,i),n.n_in=l.num_used}else{n.n_out=Math.min(e.framesize,o),n.n_in=n.n_out;for(var c=0;c<n.n_out;++c)t[0][r.mf_size+c]=s[0][a+c],2==r.channels_out&&(t[1][r.mf_size+c]=s[1][a+c])}}this.lame_init=function(){var e=new _p;return function(e){var t;e.class_id=4294479419,t=e.internal_flags=new Hp,e.mode=Gm.NOT_SET,e.original=1,e.in_samplerate=44100,e.num_channels=2,e.num_samples=-1,e.bWriteVbrTag=!0,e.quality=-1,e.short_blocks=null,t.subblock_gain=-1,e.lowpassfreq=0,e.highpassfreq=0,e.lowpasswidth=-1,e.highpasswidth=-1,e.VBR=yh.vbr_off,e.VBR_q=4,e.ATHcurve=-1,e.VBR_mean_bitrate_kbps=128,e.VBR_min_bitrate_kbps=0,e.VBR_max_bitrate_kbps=0,e.VBR_hard_min=0,t.VBR_min_bitrate=1,t.VBR_max_bitrate=13,e.quant_comp=-1,e.quant_comp_short=-1,e.msfix=-1,t.resample_ratio=1,t.OldValue[0]=180,t.OldValue[1]=180,t.CurrentStep[0]=4,t.CurrentStep[1]=4,t.masking_lower=1,t.nsPsy.attackthre=-1,t.nsPsy.attackthre_s=-1,e.scale=-1,e.athaa_type=-1,e.ATHtype=-1,e.athaa_loudapprox=-1,e.athaa_sensitivity=0,e.useTemporal=null,e.interChRatio=-1,t.mf_samples_to_encode=ap.ENCDELAY+ap.POSTDELAY,e.encoder_padding=0,t.mf_size=ap.ENCDELAY-ap.MDCTDELAY,e.findReplayGain=!1,e.decode_on_the_fly=!1,t.decode_on_the_fly=!1,t.findReplayGain=!1,t.findPeakSample=!1,t.RadioGain=0,t.AudiophileGain=0,t.noclipGainChange=0,t.noclipScale=-1,e.preset=0,e.write_id3tag_automatic=!0}(e),e.lame_allocated_gfp=1,e},this.nearestBitrateFullIndex=function(e){var t=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],s=0,a=0,o=0,n=0;n=t[16],o=16,a=t[16],s=16;for(var r=0;r<16;r++)if(Math.max(e,t[r+1])!=e){n=t[r+1],o=r+1,a=t[r],s=r;break}return n-e>e-a?s:o},this.lame_init_params=function(e){var m,v,b,y=e.internal_flags;if(y.Class_ID=0,null==y.ATH&&(y.ATH=new Dp),null==y.PSY&&(y.PSY=new d),null==y.rgdata&&(y.rgdata=new Xp),y.channels_in=e.num_channels,1==y.channels_in&&(e.mode=Gm.MONO),y.channels_out=e.mode==Gm.MONO?1:2,y.mode_ext=ap.MPG_MD_MS_LR,e.mode==Gm.MONO&&(e.force_ms=!1),e.VBR==yh.vbr_off&&128!=e.VBR_mean_bitrate_kbps&&0==e.brate&&(e.brate=e.VBR_mean_bitrate_kbps),e.VBR==yh.vbr_off||e.VBR==yh.vbr_mtrh||e.VBR==yh.vbr_mt||(e.free_format=!1),e.VBR==yh.vbr_off&&0==e.brate&&vh.EQ(e.compression_ratio,0)&&(e.compression_ratio=11.025),e.VBR==yh.vbr_off&&e.compression_ratio>0&&(0==e.out_samplerate&&(e.out_samplerate=map2MP3Frequency(int(.97*e.in_samplerate))),e.brate=0|16*e.out_samplerate*y.channels_out/(1e3*e.compression_ratio),y.samplerate_index=h(e.out_samplerate,e),e.free_format||(e.brate=f(e.brate,e.version,e.out_samplerate))),0!=e.out_samplerate&&(e.out_samplerate<16e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,64)):e.out_samplerate<32e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,160)):(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,32),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320))),0==e.lowpassfreq){var x=16e3;switch(e.VBR){case yh.vbr_off:_(w=new u,e.brate),x=w.lowerlimit;break;case yh.vbr_abr:var w;_(w=new u,e.VBR_mean_bitrate_kbps),x=w.lowerlimit;break;case yh.vbr_rh:var k=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(e.VBR_q>=0&&e.VBR_q<=9){var S=k[e.VBR_q],M=k[e.VBR_q+1],A=e.VBR_q_frac;x=linear_int(S,M,A)}else x=19500;break;default:k=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(e.VBR_q>=0&&e.VBR_q<=9){S=k[e.VBR_q],M=k[e.VBR_q+1],A=e.VBR_q_frac;x=linear_int(S,M,A)}else x=19500}e.mode!=Gm.MONO||e.VBR!=yh.vbr_off&&e.VBR!=yh.vbr_abr||(x*=1.5),e.lowpassfreq=0|x}if(0==e.out_samplerate&&(2*e.lowpassfreq>e.in_samplerate&&(e.lowpassfreq=e.in_samplerate/2),e.out_samplerate=(m=0|e.lowpassfreq,v=e.in_samplerate,b=44100,v>=48e3?b=48e3:v>=44100?b=44100:v>=32e3?b=32e3:v>=24e3?b=24e3:v>=22050?b=22050:v>=16e3?b=16e3:v>=12e3?b=12e3:v>=11025?b=11025:v>=8e3&&(b=8e3),-1==m?b:(m<=15960&&(b=44100),m<=15250&&(b=32e3),m<=11220&&(b=24e3),m<=9970&&(b=22050),m<=7230&&(b=16e3),m<=5420&&(b=12e3),m<=4510&&(b=11025),m<=3970&&(b=8e3),v<b?v>44100?48e3:v>32e3?44100:v>24e3?32e3:v>22050?24e3:v>16e3?22050:v>12e3?16e3:v>11025?12e3:v>8e3?11025:8e3:b))),e.lowpassfreq=Math.min(20500,e.lowpassfreq),e.lowpassfreq=Math.min(e.out_samplerate/2,e.lowpassfreq),e.VBR==yh.vbr_off&&(e.compression_ratio=16*e.out_samplerate*y.channels_out/(1e3*e.brate)),e.VBR==yh.vbr_abr&&(e.compression_ratio=16*e.out_samplerate*y.channels_out/(1e3*e.VBR_mean_bitrate_kbps)),e.bWriteVbrTag||(e.findReplayGain=!1,e.decode_on_the_fly=!1,y.findPeakSample=!1),y.findReplayGain=e.findReplayGain,y.decode_on_the_fly=e.decode_on_the_fly,y.decode_on_the_fly&&(y.findPeakSample=!0),y.findReplayGain&&t.InitGainAnalysis(y.rgdata,e.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return e.internal_flags=null,-6;switch(y.decode_on_the_fly&&!e.decode_only&&(null!=y.hip&&l.hip_decode_exit(y.hip),y.hip=l.hip_decode_init()),y.mode_gr=e.out_samplerate<=24e3?1:2,e.framesize=576*y.mode_gr,e.encoder_delay=ap.ENCDELAY,y.resample_ratio=e.in_samplerate/e.out_samplerate,e.VBR){case yh.vbr_mt:case yh.vbr_rh:case yh.vbr_mtrh:e.compression_ratio=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5][e.VBR_q];break;case yh.vbr_abr:e.compression_ratio=16*e.out_samplerate*y.channels_out/(1e3*e.VBR_mean_bitrate_kbps);break;default:e.compression_ratio=16*e.out_samplerate*y.channels_out/(1e3*e.brate)}if(e.mode==Gm.NOT_SET&&(e.mode=Gm.JOINT_STEREO),e.highpassfreq>0?(y.highpass1=2*e.highpassfreq,e.highpasswidth>=0?y.highpass2=2*(e.highpassfreq+e.highpasswidth):y.highpass2=2*e.highpassfreq,y.highpass1/=e.out_samplerate,y.highpass2/=e.out_samplerate):(y.highpass1=0,y.highpass2=0),e.lowpassfreq>0?(y.lowpass2=2*e.lowpassfreq,e.lowpasswidth>=0?(y.lowpass1=2*(e.lowpassfreq-e.lowpasswidth),y.lowpass1<0&&(y.lowpass1=0)):y.lowpass1=2*e.lowpassfreq,y.lowpass1/=e.out_samplerate,y.lowpass2/=e.out_samplerate):(y.lowpass1=0,y.lowpass2=0),function(e){var t=e.internal_flags,s=32,a=-1;if(t.lowpass1>0){for(var o=999,n=0;n<=31;n++){(c=n/31)>=t.lowpass2&&(s=Math.min(s,n)),t.lowpass1<c&&c<t.lowpass2&&(o=Math.min(o,n))}t.lowpass1=999==o?(s-.75)/31:(o-.75)/31,t.lowpass2=s/31}if(t.highpass2>0&&t.highpass2<.75/31*.9&&(t.highpass1=0,t.highpass2=0,bh.err.println("Warning: highpass filter disabled.  highpass frequency too small\n")),t.highpass2>0){var r=-1;for(n=0;n<=31;n++){(c=n/31)<=t.highpass1&&(a=Math.max(a,n)),t.highpass1<c&&c<t.highpass2&&(r=Math.max(r,n))}t.highpass1=a/31,t.highpass2=-1==r?(a+.75)/31:(r+.75)/31}for(n=0;n<32;n++){var i,l,c=n/31;i=t.highpass2>t.highpass1?p((t.highpass2-c)/(t.highpass2-t.highpass1+1e-20)):1,l=t.lowpass2>t.lowpass1?p((c-t.lowpass1)/(t.lowpass2-t.lowpass1+1e-20)):1,t.amp_filter[n]=i*l}}(e),y.samplerate_index=h(e.out_samplerate,e),y.samplerate_index<0)return e.internal_flags=null,-1;if(e.VBR==yh.vbr_off){if(e.free_format)y.bitrate_index=0;else if(e.brate=f(e.brate,e.version,e.out_samplerate),y.bitrate_index=g(e.brate,e.version,e.out_samplerate),y.bitrate_index<=0)return e.internal_flags=null,-1}else y.bitrate_index=1;e.analysis&&(e.bWriteVbrTag=!1),null!=y.pinfo&&(e.bWriteVbrTag=!1),s.init_bit_stream_w(y);for(var R,T=y.samplerate_index+3*e.version+6*(e.out_samplerate<16e3?1:0),E=0;E<ap.SBMAX_l+1;E++)y.scalefac_band.l[E]=o.sfBandIndex[T].l[E];for(E=0;E<ap.PSFB21+1;E++){var B=(y.scalefac_band.l[22]-y.scalefac_band.l[21])/ap.PSFB21,O=y.scalefac_band.l[21]+E*B;y.scalefac_band.psfb21[E]=O}y.scalefac_band.psfb21[ap.PSFB21]=576;for(E=0;E<ap.SBMAX_s+1;E++)y.scalefac_band.s[E]=o.sfBandIndex[T].s[E];for(E=0;E<ap.PSFB12+1;E++){B=(y.scalefac_band.s[13]-y.scalefac_band.s[12])/ap.PSFB12,O=y.scalefac_band.s[12]+E*B;y.scalefac_band.psfb12[E]=O}for(y.scalefac_band.psfb12[ap.PSFB12]=192,1==e.version?y.sideinfo_len=1==y.channels_out?21:36:y.sideinfo_len=1==y.channels_out?13:21,e.error_protection&&(y.sideinfo_len+=2),function(e){var t=e.internal_flags;e.frameNum=0,e.write_id3tag_automatic&&i.id3tag_write_v2(e),t.bitrate_stereoMode_Hist=kh([16,5]),t.bitrate_blockType_Hist=kh([16,6]),t.PeakSample=0,e.bWriteVbrTag&&r.InitVbrTag(e)}(e),y.Class_ID=4294479419,R=0;R<19;R++)y.nsPsy.pefirbuf[R]=700*y.mode_gr*y.channels_out;switch(-1==e.ATHtype&&(e.ATHtype=4),Mh(e.VBR_q<=9),Mh(e.VBR_q>=0),e.VBR){case yh.vbr_mt:e.VBR=yh.vbr_mtrh;case yh.vbr_mtrh:null==e.useTemporal&&(e.useTemporal=!1),a.apply_preset(e,500-10*e.VBR_q,0),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),e.quality<5&&(e.quality=0),e.quality>5&&(e.quality=5),y.PSY.mask_adjust=e.maskingadjust,y.PSY.mask_adjust_short=e.maskingadjust_short,e.experimentalY?y.sfb21_extra=!1:y.sfb21_extra=e.out_samplerate>44e3,y.iteration_loop=new VBRNewIterationLoop(n);break;case yh.vbr_rh:a.apply_preset(e,500-10*e.VBR_q,0),y.PSY.mask_adjust=e.maskingadjust,y.PSY.mask_adjust_short=e.maskingadjust_short,e.experimentalY?y.sfb21_extra=!1:y.sfb21_extra=e.out_samplerate>44e3,e.quality>6&&(e.quality=6),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),y.iteration_loop=new VBROldIterationLoop(n);break;default:var C;y.sfb21_extra=!1,e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),(C=e.VBR)==yh.vbr_off&&(e.VBR_mean_bitrate_kbps=e.brate),a.apply_preset(e,e.VBR_mean_bitrate_kbps,0),e.VBR=C,y.PSY.mask_adjust=e.maskingadjust,y.PSY.mask_adjust_short=e.maskingadjust_short,C==yh.vbr_off?y.iteration_loop=new Wp(n):y.iteration_loop=new ABRIterationLoop(n)}if(Mh(e.scale>=0),e.VBR!=yh.vbr_off){if(y.VBR_min_bitrate=1,y.VBR_max_bitrate=14,e.out_samplerate<16e3&&(y.VBR_max_bitrate=8),0!=e.VBR_min_bitrate_kbps&&(e.VBR_min_bitrate_kbps=f(e.VBR_min_bitrate_kbps,e.version,e.out_samplerate),y.VBR_min_bitrate=g(e.VBR_min_bitrate_kbps,e.version,e.out_samplerate),y.VBR_min_bitrate<0))return-1;if(0!=e.VBR_max_bitrate_kbps&&(e.VBR_max_bitrate_kbps=f(e.VBR_max_bitrate_kbps,e.version,e.out_samplerate),y.VBR_max_bitrate=g(e.VBR_max_bitrate_kbps,e.version,e.out_samplerate),y.VBR_max_bitrate<0))return-1;e.VBR_min_bitrate_kbps=Jp.bitrate_table[e.version][y.VBR_min_bitrate],e.VBR_max_bitrate_kbps=Jp.bitrate_table[e.version][y.VBR_max_bitrate],e.VBR_mean_bitrate_kbps=Math.min(Jp.bitrate_table[e.version][y.VBR_max_bitrate],e.VBR_mean_bitrate_kbps),e.VBR_mean_bitrate_kbps=Math.max(Jp.bitrate_table[e.version][y.VBR_min_bitrate],e.VBR_mean_bitrate_kbps)}return e.tune&&(y.PSY.mask_adjust+=e.tune_value_a,y.PSY.mask_adjust_short+=e.tune_value_a),function(e){var t=e.internal_flags;switch(e.quality){default:case 9:t.psymodel=0,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 8:e.quality=7;case 7:t.psymodel=1,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 6:case 5:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=0,t.full_outer_loop=0;break;case 4:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 3:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 2:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 1:case 0:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=2,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0}}(e),Mh(e.scale>=0),e.athaa_type<0?y.ATH.useAdjust=3:y.ATH.useAdjust=e.athaa_type,y.ATH.aaSensitivityP=Math.pow(10,e.athaa_sensitivity/-10),null==e.short_blocks&&(e.short_blocks=xh.short_block_allowed),e.short_blocks!=xh.short_block_allowed||e.mode!=Gm.JOINT_STEREO&&e.mode!=Gm.STEREO||(e.short_blocks=xh.short_block_coupled),e.quant_comp<0&&(e.quant_comp=1),e.quant_comp_short<0&&(e.quant_comp_short=0),e.msfix<0&&(e.msfix=0),e.exp_nspsytune=1|e.exp_nspsytune,e.internal_flags.nsPsy.attackthre<0&&(e.internal_flags.nsPsy.attackthre=gp.NSATTACKTHRE),e.internal_flags.nsPsy.attackthre_s<0&&(e.internal_flags.nsPsy.attackthre_s=gp.NSATTACKTHRE_S),Mh(e.scale>=0),e.scale<0&&(e.scale=1),e.ATHtype<0&&(e.ATHtype=4),e.ATHcurve<0&&(e.ATHcurve=4),e.athaa_loudapprox<0&&(e.athaa_loudapprox=2),e.interChRatio<0&&(e.interChRatio=0),null==e.useTemporal&&(e.useTemporal=!0),y.slot_lag=y.frac_SpF=0,e.VBR==yh.vbr_off&&(y.slot_lag=y.frac_SpF=72e3*(e.version+1)*e.brate%e.out_samplerate|0),o.iteration_init(e),c.psymodel_init(e),Mh(e.scale>=0),0},this.lame_encode_flush=function(e,t,a,o){var n,r,l,c,d=e.internal_flags,u=Sh([2,1152]),m=0,p=d.mf_samples_to_encode-ap.POSTDELAY,h=v(e);if(d.mf_samples_to_encode<1)return 0;for(n=0,e.in_samplerate!=e.out_samplerate&&(p+=16*e.out_samplerate/e.in_samplerate),(l=e.framesize-p%e.framesize)<576&&(l+=e.framesize),e.encoder_padding=l,c=(p+l)/e.framesize;c>0&&m>=0;){var f=h-d.mf_size,g=e.frameNum;f*=e.in_samplerate,(f/=e.out_samplerate)>1152&&(f=1152),f<1&&(f=1),r=o-n,0==o&&(r=0),a+=m=this.lame_encode_buffer(e,u[0],u[1],f,t,a,r),n+=m,c-=g!=e.frameNum?1:0}if(d.mf_samples_to_encode=0,m<0)return m;if(r=o-n,0==o&&(r=0),s.flush_bitstream(e),(m=s.copy_buffer(d,t,a,r,1))<0)return m;if(a+=m,r=o-(n+=m),0==o&&(r=0),e.write_id3tag_automatic){if(i.id3tag_write_v1(e),(m=s.copy_buffer(d,t,a,r,0))<0)return m;n+=m}return n},this.lame_encode_buffer=function(e,a,o,n,r,i,l){var c=e.internal_flags,d=[null,null];if(4294479419!=c.Class_ID)return-3;if(0==n)return 0;!function(e,t){(null==e.in_buffer_0||e.in_buffer_nsamples<t)&&(e.in_buffer_0=wh(t),e.in_buffer_1=wh(t),e.in_buffer_nsamples=t)}(c,n),d[0]=c.in_buffer_0,d[1]=c.in_buffer_1;for(var u=0;u<n;u++)d[0][u]=a[u],c.channels_in>1&&(d[1][u]=o[u]);return function(e,a,o,n,r,i,l){var c,d,u,m,p,h=e.internal_flags,f=0,g=[null,null],_=[null,null];if(4294479419!=h.Class_ID)return-3;if(0==n)return 0;if((p=s.copy_buffer(h,r,i,l,0))<0)return p;if(i+=p,f+=p,_[0]=a,_[1]=o,vh.NEQ(e.scale,0)&&vh.NEQ(e.scale,1))for(d=0;d<n;++d)_[0][d]*=e.scale,2==h.channels_out&&(_[1][d]*=e.scale);if(vh.NEQ(e.scale_left,0)&&vh.NEQ(e.scale_left,1))for(d=0;d<n;++d)_[0][d]*=e.scale_left;if(vh.NEQ(e.scale_right,0)&&vh.NEQ(e.scale_right,1))for(d=0;d<n;++d)_[1][d]*=e.scale_right;if(2==e.num_channels&&1==h.channels_out)for(d=0;d<n;++d)_[0][d]=.5*(_[0][d]+_[1][d]),_[1][d]=0;m=v(e),g[0]=h.mfbuf[0],g[1]=h.mfbuf[1];var x=0;for(;n>0;){var w,k,M=[null,null];M[0]=_[0],M[1]=_[1];var A=new y;if(S(e,g,M,x,n,A),w=A.n_in,k=A.n_out,h.findReplayGain&&!h.decode_on_the_fly&&t.AnalyzeSamples(h.rgdata,g[0],h.mf_size,g[1],h.mf_size,k,h.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(n-=w,x+=w,h.channels_out,h.mf_size+=k,Mh(h.mf_size<=Hp.MFSIZE),h.mf_samples_to_encode<1&&(h.mf_samples_to_encode=ap.ENCDELAY+ap.POSTDELAY),h.mf_samples_to_encode+=k,h.mf_size>=m){var R=l-f;if(0==l&&(R=0),(c=b(e,g[0],g[1],r,i,R))<0)return c;for(i+=c,f+=c,h.mf_size-=e.framesize,h.mf_samples_to_encode-=e.framesize,u=0;u<h.channels_out;u++)for(d=0;d<h.mf_size;d++)g[u][d]=g[u][d+e.framesize]}}return f}(e,d[0],d[1],n,r,i,l)}}var Rh=Hm.VbrMode;function Th(){function e(e,t,s,a,o,n,r,i,l,c,d,u,m,p,h){this.vbr_q=e,this.quant_comp=t,this.quant_comp_s=s,this.expY=a,this.st_lrm=o,this.st_s=n,this.masking_adj=r,this.masking_adj_short=i,this.ath_lower=l,this.ath_curve=c,this.ath_sensitivity=d,this.interch=u,this.safejoint=m,this.sfb21mod=p,this.msfix=h}function t(e,t,s,a,o,n,r,i,l,c,d,u,m,p){this.quant_comp=t,this.quant_comp_s=s,this.safejoint=a,this.nsmsfix=o,this.st_lrm=n,this.st_s=r,this.nsbass=i,this.scale=l,this.masking_adj=c,this.ath_lower=d,this.ath_curve=u,this.interch=m,this.sfscale=p}var s;this.setModules=function(e){s=e};var a=[new e(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new e(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new e(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new e(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new e(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new e(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new e(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new e(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new e(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],o=[new e(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new e(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new e(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new e(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new e(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new e(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new e(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new e(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new e(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function n(e,t,s){var n=e.VBR==Rh.vbr_rh?a:o,r=e.VBR_q_frac,i=n[t],l=n[t+1],c=i;i.st_lrm=i.st_lrm+r*(l.st_lrm-i.st_lrm),i.st_s=i.st_s+r*(l.st_s-i.st_s),i.masking_adj=i.masking_adj+r*(l.masking_adj-i.masking_adj),i.masking_adj_short=i.masking_adj_short+r*(l.masking_adj_short-i.masking_adj_short),i.ath_lower=i.ath_lower+r*(l.ath_lower-i.ath_lower),i.ath_curve=i.ath_curve+r*(l.ath_curve-i.ath_curve),i.ath_sensitivity=i.ath_sensitivity+r*(l.ath_sensitivity-i.ath_sensitivity),i.interch=i.interch+r*(l.interch-i.interch),i.msfix=i.msfix+r*(l.msfix-i.msfix),function(e,t){var s=0;t<0&&(s=-1,t=0);t>9&&(s=-1,t=9);e.VBR_q=t,e.VBR_q_frac=0}(e,c.vbr_q),0!=s?e.quant_comp=c.quant_comp:Math.abs(e.quant_comp- -1)>0||(e.quant_comp=c.quant_comp),0!=s?e.quant_comp_short=c.quant_comp_s:Math.abs(e.quant_comp_short- -1)>0||(e.quant_comp_short=c.quant_comp_s),0!=c.expY&&(e.experimentalY=0!=c.expY),0!=s?e.internal_flags.nsPsy.attackthre=c.st_lrm:Math.abs(e.internal_flags.nsPsy.attackthre- -1)>0||(e.internal_flags.nsPsy.attackthre=c.st_lrm),0!=s?e.internal_flags.nsPsy.attackthre_s=c.st_s:Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)>0||(e.internal_flags.nsPsy.attackthre_s=c.st_s),0!=s?e.maskingadjust=c.masking_adj:Math.abs(e.maskingadjust-0)>0||(e.maskingadjust=c.masking_adj),0!=s?e.maskingadjust_short=c.masking_adj_short:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=c.masking_adj_short),0!=s?e.ATHlower=-c.ath_lower/10:Math.abs(10*-e.ATHlower-0)>0||(e.ATHlower=-c.ath_lower/10),0!=s?e.ATHcurve=c.ath_curve:Math.abs(e.ATHcurve- -1)>0||(e.ATHcurve=c.ath_curve),0!=s?e.athaa_sensitivity=c.ath_sensitivity:Math.abs(e.athaa_sensitivity- -1)>0||(e.athaa_sensitivity=c.ath_sensitivity),c.interch>0&&(0!=s?e.interChRatio=c.interch:Math.abs(e.interChRatio- -1)>0||(e.interChRatio=c.interch)),c.safejoint>0&&(e.exp_nspsytune=e.exp_nspsytune|c.safejoint),c.sfb21mod>0&&(e.exp_nspsytune=e.exp_nspsytune|c.sfb21mod<<20),0!=s?e.msfix=c.msfix:Math.abs(e.msfix- -1)>0||(e.msfix=c.msfix),0==s&&(e.VBR_q=t,e.VBR_q_frac=r)}var r=[new t(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new t(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new t(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new t(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new t(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new t(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new t(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new t(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new t(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new t(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new t(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new t(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new t(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new t(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new t(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function i(e,t,a){var o=t,n=s.nearestBitrateFullIndex(t);if(e.VBR=Rh.vbr_abr,e.VBR_mean_bitrate_kbps=o,e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320),e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.brate=e.VBR_mean_bitrate_kbps,e.VBR_mean_bitrate_kbps>320&&(e.disable_reservoir=!0),r[n].safejoint>0&&(e.exp_nspsytune=2|e.exp_nspsytune),r[n].sfscale>0&&(e.internal_flags.noise_shaping=2),Math.abs(r[n].nsbass)>0){var i=int(4*r[n].nsbass);i<0&&(i+=64),e.exp_nspsytune=e.exp_nspsytune|i<<2}return 0!=a?e.quant_comp=r[n].quant_comp:Math.abs(e.quant_comp- -1)>0||(e.quant_comp=r[n].quant_comp),0!=a?e.quant_comp_short=r[n].quant_comp_s:Math.abs(e.quant_comp_short- -1)>0||(e.quant_comp_short=r[n].quant_comp_s),0!=a?e.msfix=r[n].nsmsfix:Math.abs(e.msfix- -1)>0||(e.msfix=r[n].nsmsfix),0!=a?e.internal_flags.nsPsy.attackthre=r[n].st_lrm:Math.abs(e.internal_flags.nsPsy.attackthre- -1)>0||(e.internal_flags.nsPsy.attackthre=r[n].st_lrm),0!=a?e.internal_flags.nsPsy.attackthre_s=r[n].st_s:Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)>0||(e.internal_flags.nsPsy.attackthre_s=r[n].st_s),0!=a?e.scale=r[n].scale:Math.abs(e.scale- -1)>0||(e.scale=r[n].scale),0!=a?e.maskingadjust=r[n].masking_adj:Math.abs(e.maskingadjust-0)>0||(e.maskingadjust=r[n].masking_adj),r[n].masking_adj>0?0!=a?e.maskingadjust_short=.9*r[n].masking_adj:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=.9*r[n].masking_adj):0!=a?e.maskingadjust_short=1.1*r[n].masking_adj:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=1.1*r[n].masking_adj),0!=a?e.ATHlower=-r[n].ath_lower/10:Math.abs(10*-e.ATHlower-0)>0||(e.ATHlower=-r[n].ath_lower/10),0!=a?e.ATHcurve=r[n].ath_curve:Math.abs(e.ATHcurve- -1)>0||(e.ATHcurve=r[n].ath_curve),0!=a?e.interChRatio=r[n].interch:Math.abs(e.interChRatio- -1)>0||(e.interChRatio=r[n].interch),t}this.apply_preset=function(e,t,s){switch(t){case Ah.R3MIX:t=Ah.V3,e.VBR=Rh.vbr_mtrh;break;case Ah.MEDIUM:t=Ah.V4,e.VBR=Rh.vbr_rh;break;case Ah.MEDIUM_FAST:t=Ah.V4,e.VBR=Rh.vbr_mtrh;break;case Ah.STANDARD:t=Ah.V2,e.VBR=Rh.vbr_rh;break;case Ah.STANDARD_FAST:t=Ah.V2,e.VBR=Rh.vbr_mtrh;break;case Ah.EXTREME:t=Ah.V0,e.VBR=Rh.vbr_rh;break;case Ah.EXTREME_FAST:t=Ah.V0,e.VBR=Rh.vbr_mtrh;break;case Ah.INSANE:return t=320,e.preset=t,i(e,t,s),e.VBR=Rh.vbr_off,t}switch(e.preset=t,t){case Ah.V9:return n(e,9,s),t;case Ah.V8:return n(e,8,s),t;case Ah.V7:return n(e,7,s),t;case Ah.V6:return n(e,6,s),t;case Ah.V5:return n(e,5,s),t;case Ah.V4:return n(e,4,s),t;case Ah.V3:return n(e,3,s),t;case Ah.V2:return n(e,2,s),t;case Ah.V1:return n(e,1,s),t;case Ah.V0:return n(e,0,s),t}return t>=8&&t<=320?i(e,t,s):(e.preset=0,t)}}function Eh(){this.setModules=function(e,t){}}function Bh(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}var Oh=Hm.new_float,Ch=Hm.new_int;function jh(){this.global_gain=0,this.sfb_count1=0,this.step=Ch(39),this.noise=Oh(39),this.noise_log=Oh(39)}var Ih=Hm.System,Lh=Hm.VbrMode,Ph=Hm.Util,Nh=Hm.Arrays,Hh=Hm.new_float,Fh=Hm.assert;function Dh(){var e,t,s;this.rv=null,this.qupvt=null;var a,o=new Eh;function n(e){this.ordinal=e}function r(e){for(var t=0;t<e.sfbmax;t++)if(e.scalefac[t]+e.subblock_gain[e.window[t]]==0)return!1;return!0}function i(e,t,s,a,o){var n;switch(e){default:case 9:t.over_count>0?(n=s.over_SSD<=t.over_SSD,s.over_SSD==t.over_SSD&&(n=s.bits<t.bits)):n=s.max_noise<0&&10*s.max_noise+s.bits<=10*t.max_noise+t.bits;break;case 0:n=s.over_count<t.over_count||s.over_count==t.over_count&&s.over_noise<t.over_noise||s.over_count==t.over_count&&BitStream.EQ(s.over_noise,t.over_noise)&&s.tot_noise<t.tot_noise;break;case 8:s.max_noise=function(e,t){for(var s,a=1e-37,o=0;o<t.psymax;o++)a+=(s=e[o],Ph.FAST_LOG10(.368+.632*s*s*s));return Math.max(1e-20,a)}(o,a);case 1:n=s.max_noise<t.max_noise;break;case 2:n=s.tot_noise<t.tot_noise;break;case 3:n=s.tot_noise<t.tot_noise&&s.max_noise<t.max_noise;break;case 4:n=s.max_noise<=0&&t.max_noise>.2||s.max_noise<=0&&t.max_noise<0&&t.max_noise>s.max_noise-.2&&s.tot_noise<t.tot_noise||s.max_noise<=0&&t.max_noise>0&&t.max_noise>s.max_noise-.2&&s.tot_noise<t.tot_noise+t.over_noise||s.max_noise>0&&t.max_noise>-.05&&t.max_noise>s.max_noise-.1&&s.tot_noise+s.over_noise<t.tot_noise+t.over_noise||s.max_noise>0&&t.max_noise>-.1&&t.max_noise>s.max_noise-.15&&s.tot_noise+s.over_noise+s.over_noise<t.tot_noise+t.over_noise+t.over_noise;break;case 5:n=s.over_noise<t.over_noise||BitStream.EQ(s.over_noise,t.over_noise)&&s.tot_noise<t.tot_noise;break;case 6:n=s.over_noise<t.over_noise||BitStream.EQ(s.over_noise,t.over_noise)&&(s.max_noise<t.max_noise||BitStream.EQ(s.max_noise,t.max_noise)&&s.tot_noise<=t.tot_noise);break;case 7:n=s.over_count<t.over_count||s.over_noise<t.over_noise}return 0==t.over_count&&(n=n&&s.bits<t.bits),n}function l(e,t,o,n,i){var l=e.internal_flags;!function(e,t,s,a,o){var n,r=e.internal_flags;n=0==t.scalefac_scale?1.2968395546510096:1.6817928305074292;for(var i=0,l=0;l<t.sfbmax;l++)i<s[l]&&(i=s[l]);var c=r.noise_shaping_amp;switch(3==c&&(c=o?2:1),c){case 2:break;case 1:i>1?i=Math.pow(i,.5):i*=.95;break;case 0:default:i>1?i=1:i*=.95}var d=0;for(l=0;l<t.sfbmax;l++){var u,m=t.width[l];if(d+=m,!(s[l]<i)){if(0!=(2&r.substep_shaping)&&(r.pseudohalf[l]=0==r.pseudohalf[l]?1:0,0==r.pseudohalf[l]&&2==r.noise_shaping_amp))return;for(t.scalefac[l]++,u=-m;u<0;u++)a[d+u]*=n,a[d+u]>t.xrpow_max&&(t.xrpow_max=a[d+u]);if(2==r.noise_shaping_amp)return}}}(e,t,o,n,i);var c=r(t);return!c&&(!(c=2==l.mode_gr?a.scale_bitcount(t):a.scale_bitcount_lsf(l,t))||(l.noise_shaping>1&&(Nh.fill(l.pseudohalf,0),0==t.scalefac_scale?(!function(e,t){for(var a=0,o=0;o<e.sfbmax;o++){var n=e.width[o],r=e.scalefac[o];if(0!=e.preflag&&(r+=s.pretab[o]),a+=n,0!=(1&r)){r++;for(var i=-n;i<0;i++)t[a+i]*=1.2968395546510096,t[a+i]>e.xrpow_max&&(e.xrpow_max=t[a+i])}e.scalefac[o]=r>>1}e.preflag=0,e.scalefac_scale=1}(t,n),c=!1):t.block_type==ap.SHORT_TYPE&&l.subblock_gain>0&&(c=function(e,t,a){var o,n=t.scalefac;for(o=0;o<t.sfb_lmax;o++)if(n[o]>=16)return!0;for(var r=0;r<3;r++){var i=0,l=0;for(o=t.sfb_lmax+r;o<t.sfbdivide;o+=3)i<n[o]&&(i=n[o]);for(;o<t.sfbmax;o+=3)l<n[o]&&(l=n[o]);if(!(i<16&&l<8)){if(t.subblock_gain[r]>=7)return!0;t.subblock_gain[r]++;var c=e.scalefac_band.l[t.sfb_lmax];for(o=t.sfb_lmax+r;o<t.sfbmax;o+=3){var d=t.width[o],u=n[o];if((u-=4>>t.scalefac_scale)>=0)n[o]=u,c+=3*d;else{n[o]=0;var m=210+(u<<t.scalefac_scale+1);h=s.IPOW20(m),c+=d*(r+1);for(var p=-d;p<0;p++)a[c+p]*=h,a[c+p]>t.xrpow_max&&(t.xrpow_max=a[c+p]);c+=d*(3-r-1)}}var h=s.IPOW20(202);c+=t.width[o]*(r+1);for(p=-t.width[o];p<0;p++)a[c+p]*=h,a[c+p]>t.xrpow_max&&(t.xrpow_max=a[c+p])}}return!1}(l,t,n)||r(t))),c||(c=2==l.mode_gr?a.scale_bitcount(t):a.scale_bitcount_lsf(l,t)),!c))}this.setModules=function(n,r,i,l){e=n,t=r,this.rv=r,s=i,this.qupvt=i,a=l,o.setModules(s,a)},this.ms_convert=function(e,t){for(var s=0;s<576;++s){var a=e.tt[t][0].xr[s],o=e.tt[t][1].xr[s];e.tt[t][0].xr[s]=(a+o)*(.5*Ph.SQRT2),e.tt[t][1].xr[s]=(a-o)*(.5*Ph.SQRT2)}},this.init_xrpow=function(e,t,s){var a=0,o=0|t.max_nonzero_coeff;if(t.xrpow_max=0,Nh.fill(s,o,576,0),(a=function(e,t,s,a){a=0;for(var o=0;o<=s;++o){var n=Math.abs(e.xr[o]);a+=n,t[o]=Math.sqrt(n*Math.sqrt(n)),t[o]>e.xrpow_max&&(e.xrpow_max=t[o])}return a}(t,s,o,a))>1e-20){var n=0;0!=(2&e.substep_shaping)&&(n=1);for(var r=0;r<t.psymax;r++)e.pseudohalf[r]=n;return!0}return Nh.fill(t.l3_enc,0,576,0),!1},this.init_outer_loop=function(e,t){t.part2_3_length=0,t.big_values=0,t.count1=0,t.global_gain=210,t.scalefac_compress=0,t.table_select[0]=0,t.table_select[1]=0,t.table_select[2]=0,t.subblock_gain[0]=0,t.subblock_gain[1]=0,t.subblock_gain[2]=0,t.subblock_gain[3]=0,t.region0_count=0,t.region1_count=0,t.preflag=0,t.scalefac_scale=0,t.count1table_select=0,t.part2_length=0,t.sfb_lmax=ap.SBPSY_l,t.sfb_smin=ap.SBPSY_s,t.psy_lmax=e.sfb21_extra?ap.SBMAX_l:ap.SBPSY_l,t.psymax=t.psy_lmax,t.sfbmax=t.sfb_lmax,t.sfbdivide=11;for(var a=0;a<ap.SBMAX_l;a++)t.width[a]=e.scalefac_band.l[a+1]-e.scalefac_band.l[a],t.window[a]=3;if(t.block_type==ap.SHORT_TYPE){var o=Hh(576);t.sfb_smin=0,t.sfb_lmax=0,0!=t.mixed_block_flag&&(t.sfb_smin=3,t.sfb_lmax=2*e.mode_gr+4),t.psymax=t.sfb_lmax+3*((e.sfb21_extra?ap.SBMAX_s:ap.SBPSY_s)-t.sfb_smin),t.sfbmax=t.sfb_lmax+3*(ap.SBPSY_s-t.sfb_smin),t.sfbdivide=t.sfbmax-18,t.psy_lmax=t.sfb_lmax;var n=e.scalefac_band.l[t.sfb_lmax];Ih.arraycopy(t.xr,0,o,0,576);for(a=t.sfb_smin;a<ap.SBMAX_s;a++)for(var r=e.scalefac_band.s[a],i=e.scalefac_band.s[a+1],l=0;l<3;l++)for(var c=r;c<i;c++)t.xr[n++]=o[3*c+l];var d=t.sfb_lmax;for(a=t.sfb_smin;a<ap.SBMAX_s;a++)t.width[d]=t.width[d+1]=t.width[d+2]=e.scalefac_band.s[a+1]-e.scalefac_band.s[a],t.window[d]=0,t.window[d+1]=1,t.window[d+2]=2,d+=3}t.count1bits=0,t.sfb_partition_table=s.nr_of_sfb_block[0][0],t.slen[0]=0,t.slen[1]=0,t.slen[2]=0,t.slen[3]=0,t.max_nonzero_coeff=575,Nh.fill(t.scalefac,0),function(e,t){var a=e.ATH,o=t.xr;if(t.block_type!=ap.SHORT_TYPE)for(var n=!1,r=ap.PSFB21-1;r>=0&&!n;r--){var i=e.scalefac_band.psfb21[r],l=e.scalefac_band.psfb21[r+1],c=s.athAdjust(a.adjust,a.psfb21[r],a.floor);e.nsPsy.longfact[21]>1e-12&&(c*=e.nsPsy.longfact[21]);for(var d=l-1;d>=i;d--){if(!(Math.abs(o[d])<c)){n=!0;break}o[d]=0}}else for(var u=0;u<3;u++)for(n=!1,r=ap.PSFB12-1;r>=0&&!n;r--){l=(i=3*e.scalefac_band.s[12]+(e.scalefac_band.s[13]-e.scalefac_band.s[12])*u+(e.scalefac_band.psfb12[r]-e.scalefac_band.psfb12[0]))+(e.scalefac_band.psfb12[r+1]-e.scalefac_band.psfb12[r]);var m=s.athAdjust(a.adjust,a.psfb12[r],a.floor);e.nsPsy.shortfact[12]>1e-12&&(m*=e.nsPsy.shortfact[12]);for(d=l-1;d>=i;d--){if(!(Math.abs(o[d])<m)){n=!0;break}o[d]=0}}}(e,t)},n.BINSEARCH_NONE=new n(0),n.BINSEARCH_UP=new n(1),n.BINSEARCH_DOWN=new n(2),this.trancate_smallspectrums=function(e,t,o,n){var r=Hh(vp.SFBMAX);if((0!=(4&e.substep_shaping)||t.block_type!=ap.SHORT_TYPE)&&0==(128&e.substep_shaping)){s.calc_noise(t,o,r,new Bh,null);for(var i=0;i<576;i++){var l=0;0!=t.l3_enc[i]&&(l=Math.abs(t.xr[i])),n[i]=l}i=0;var c=8;t.block_type==ap.SHORT_TYPE&&(c=6);do{var d,u,m,p,h=t.width[c];if(i+=h,!(r[c]>=1||(Nh.sort(n,i-h,h),BitStream.EQ(n[i-1],0)))){d=(1-r[c])*o[c],u=0,p=0;do{var f;for(m=1;p+m<h&&!BitStream.NEQ(n[p+i-h],n[p+i+m-h]);m++);if(d<(f=n[p+i-h]*n[p+i-h]*m)){0!=p&&(u=n[p+i-h-1]);break}d-=f,p+=m}while(p<h);if(!BitStream.EQ(u,0))do{Math.abs(t.xr[i-h])<=u&&(t.l3_enc[i-h]=0)}while(--h>0)}}while(++c<t.psymax);t.part2_3_length=a.noquant_count_bits(e,t,null)}},this.outer_loop=function(e,t,o,r,c,d){var u=e.internal_flags,m=new xp,p=Hh(576),h=Hh(vp.SFBMAX),f=new Bh,g=new jh,_=9999999,v=!1,b=!1,y=0;if(function(e,t,s,o,r){var i,l=e.CurrentStep[o],c=!1,d=e.OldValue[o],u=n.BINSEARCH_NONE;for(t.global_gain=d,s-=t.part2_length;;){var m;if(i=a.count_bits(e,r,t,null),1==l||i==s)break;i>s?(u==n.BINSEARCH_DOWN&&(c=!0),c&&(l/=2),u=n.BINSEARCH_UP,m=l):(u==n.BINSEARCH_UP&&(c=!0),c&&(l/=2),u=n.BINSEARCH_DOWN,m=-l),t.global_gain+=m,t.global_gain<0&&(t.global_gain=0,c=!0),t.global_gain>255&&(t.global_gain=255,c=!0)}for(Fh(t.global_gain>=0),Fh(t.global_gain<256);i>s&&t.global_gain<255;)t.global_gain++,i=a.count_bits(e,r,t,null);e.CurrentStep[o]=d-t.global_gain>=4?4:2,e.OldValue[o]=t.global_gain,t.part2_3_length=i}(u,t,d,c,r),0==u.noise_shaping)return 100;s.calc_noise(t,o,h,f,g),f.bits=t.part2_3_length,m.assign(t);var x=0;for(Ih.arraycopy(r,0,p,0,576);!v;){do{var w,k=new Bh,S=255;if(w=0!=(2&u.substep_shaping)?20:3,u.sfb21_extra){if(h[m.sfbmax]>1)break;if(m.block_type==ap.SHORT_TYPE&&(h[m.sfbmax+1]>1||h[m.sfbmax+2]>1))break}if(!l(e,m,h,r,b))break;0!=m.scalefac_scale&&(S=254);var M=d-m.part2_length;if(M<=0)break;for(;(m.part2_3_length=a.count_bits(u,r,m,g))>M&&m.global_gain<=S;)m.global_gain++;if(m.global_gain>S)break;if(0==f.over_count){for(;(m.part2_3_length=a.count_bits(u,r,m,g))>_&&m.global_gain<=S;)m.global_gain++;if(m.global_gain>S)break}if(s.calc_noise(m,o,h,k,g),k.bits=m.part2_3_length,0!=(i(t.block_type!=ap.SHORT_TYPE?e.quant_comp:e.quant_comp_short,f,k,m,h)?1:0))_=t.part2_3_length,f=k,t.assign(m),x=0,Ih.arraycopy(r,0,p,0,576);else if(0==u.full_outer_loop){if(++x>w&&0==f.over_count)break;if(3==u.noise_shaping_amp&&b&&x>30)break;if(3==u.noise_shaping_amp&&b&&m.global_gain-y>15)break}}while(m.global_gain+m.scalefac_scale<255);3==u.noise_shaping_amp?b?v=!0:(m.assign(t),Ih.arraycopy(p,0,r,0,576),x=0,y=m.global_gain,b=!0):v=!0}return Fh(t.global_gain+t.scalefac_scale<=255),e.VBR==Lh.vbr_rh||e.VBR==Lh.vbr_mtrh?Ih.arraycopy(p,0,r,0,576):0!=(1&u.substep_shaping)&&trancate_smallspectrums(u,t,o,r),f.over_count},this.iteration_finish_one=function(e,s,o){var n=e.l3_side,r=n.tt[s][o];a.best_scalefac_store(e,s,o,n),1==e.use_best_huffman&&a.best_huffman_divide(e,r),t.ResvAdjust(e,r)},this.VBR_encode_granule=function(e,t,s,a,o,n,r){var i,l=e.internal_flags,c=new xp,d=Hh(576),u=r,m=r+1,p=(r+n)/2,h=0,f=l.sfb21_extra;Fh(u<=LameInternalFlags.MAX_BITS_PER_CHANNEL),Nh.fill(c.l3_enc,0);do{l.sfb21_extra=!(p>u-42)&&f,outer_loop(e,t,s,a,o,p)<=0?(h=1,m=t.part2_3_length,c.assign(t),Ih.arraycopy(a,0,d,0,576),i=(r=m-32)-n,p=(r+n)/2):(i=r-(n=p+32),p=(r+n)/2,0!=h&&(h=2,t.assign(c),Ih.arraycopy(d,0,a,0,576)))}while(i>12);l.sfb21_extra=f,2==h&&Ih.arraycopy(c.l3_enc,0,t.l3_enc,0,576),Fh(t.part2_3_length<=u)},this.get_framebits=function(s,a){var o=s.internal_flags;o.bitrate_index=o.VBR_min_bitrate;var n=e.getframebits(s);o.bitrate_index=1,n=e.getframebits(s);for(var r=1;r<=o.VBR_max_bitrate;r++){o.bitrate_index=r;var i=new MeanBits(n);a[r]=t.ResvFrameBegin(s,i),n=i.bits}},this.VBR_old_prepare=function(e,a,o,n,r,i,l,c,d){var u,m=e.internal_flags,p=0,h=1,f=0;m.bitrate_index=m.VBR_max_bitrate;var g=t.ResvFrameBegin(e,new MeanBits(0))/m.mode_gr;get_framebits(e,i);for(var _=0;_<m.mode_gr;_++){var v=s.on_pe(e,a,c[_],g,_,0);m.mode_ext==ap.MPG_MD_MS_LR&&(ms_convert(m.l3_side,_),s.reduce_side(c[_],o[_],g,v));for(var b=0;b<m.channels_out;++b){var y=m.l3_side.tt[_][b];y.block_type!=ap.SHORT_TYPE?(p=1.28/(1+Math.exp(3.5-a[_][b]/300))-.05,u=m.PSY.mask_adjust-p):(p=2.56/(1+Math.exp(3.5-a[_][b]/300))-.14,u=m.PSY.mask_adjust_short-p),m.masking_lower=Math.pow(10,.1*u),init_outer_loop(m,y),d[_][b]=s.calc_xmin(e,n[_][b],y,r[_][b]),0!=d[_][b]&&(h=0),l[_][b]=126,f+=c[_][b]}}for(_=0;_<m.mode_gr;_++)for(b=0;b<m.channels_out;b++)f>i[m.VBR_max_bitrate]&&(c[_][b]*=i[m.VBR_max_bitrate],c[_][b]/=f),l[_][b]>c[_][b]&&(l[_][b]=c[_][b]);return h},this.bitpressure_strategy=function(e,t,s,a){for(var o=0;o<e.mode_gr;o++)for(var n=0;n<e.channels_out;n++){for(var r=e.l3_side.tt[o][n],i=t[o][n],l=0,c=0;c<r.psy_lmax;c++)i[l++]*=1+.029*c*c/ap.SBMAX_l/ap.SBMAX_l;if(r.block_type==ap.SHORT_TYPE)for(c=r.sfb_smin;c<ap.SBMAX_s;c++)i[l++]*=1+.029*c*c/ap.SBMAX_s/ap.SBMAX_s,i[l++]*=1+.029*c*c/ap.SBMAX_s/ap.SBMAX_s,i[l++]*=1+.029*c*c/ap.SBMAX_s/ap.SBMAX_s;a[o][n]=0|Math.max(s[o][n],.9*a[o][n])}},this.VBR_new_prepare=function(e,a,o,n,r,i){var l,c=e.internal_flags,d=1,u=0,m=0;if(e.free_format){c.bitrate_index=0;p=new MeanBits(u);l=t.ResvFrameBegin(e,p),u=p.bits,r[0]=l}else{c.bitrate_index=c.VBR_max_bitrate;var p=new MeanBits(u);t.ResvFrameBegin(e,p),u=p.bits,get_framebits(e,r),l=r[c.VBR_max_bitrate]}for(var h=0;h<c.mode_gr;h++){s.on_pe(e,a,i[h],u,h,0),c.mode_ext==ap.MPG_MD_MS_LR&&ms_convert(c.l3_side,h);for(var f=0;f<c.channels_out;++f){var g=c.l3_side.tt[h][f];c.masking_lower=Math.pow(10,.1*c.PSY.mask_adjust),init_outer_loop(c,g),0!=s.calc_xmin(e,o[h][f],g,n[h][f])&&(d=0),m+=i[h][f]}}for(h=0;h<c.mode_gr;h++)for(f=0;f<c.channels_out;f++)m>l&&(i[h][f]*=l,i[h][f]/=m);return d},this.calc_target_bits=function(a,o,n,r,i,l){var c,d,u,m,p=a.internal_flags,h=p.l3_side,f=0;p.bitrate_index=p.VBR_max_bitrate;var g=new MeanBits(f);for(l[0]=t.ResvFrameBegin(a,g),f=g.bits,p.bitrate_index=1,f=e.getframebits(a)-8*p.sideinfo_len,i[0]=f/(p.mode_gr*p.channels_out),f=a.VBR_mean_bitrate_kbps*a.framesize*1e3,0!=(1&p.substep_shaping)&&(f*=1.09),f/=a.out_samplerate,f-=8*p.sideinfo_len,f/=p.mode_gr*p.channels_out,(c=.93+.07*(11-a.compression_ratio)/5.5)<.9&&(c=.9),c>1&&(c=1),d=0;d<p.mode_gr;d++){var _=0;for(u=0;u<p.channels_out;u++){if(r[d][u]=int(c*f),o[d][u]>700){var v=int((o[d][u]-700)/1.4),b=h.tt[d][u];r[d][u]=int(c*f),b.block_type==ap.SHORT_TYPE&&v<f/2&&(v=f/2),v>3*f/2?v=3*f/2:v<0&&(v=0),r[d][u]+=v}r[d][u]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(r[d][u]=LameInternalFlags.MAX_BITS_PER_CHANNEL),_+=r[d][u]}if(_>LameInternalFlags.MAX_BITS_PER_GRANULE)for(u=0;u<p.channels_out;++u)r[d][u]*=LameInternalFlags.MAX_BITS_PER_GRANULE,r[d][u]/=_}if(p.mode_ext==ap.MPG_MD_MS_LR)for(d=0;d<p.mode_gr;d++)s.reduce_side(r[d],n[d],f*p.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(m=0,d=0;d<p.mode_gr;d++)for(u=0;u<p.channels_out;u++)r[d][u]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(r[d][u]=LameInternalFlags.MAX_BITS_PER_CHANNEL),m+=r[d][u];if(m>l[0])for(d=0;d<p.mode_gr;d++)for(u=0;u<p.channels_out;u++)r[d][u]*=l[0],r[d][u]/=m}}var $h=Hm.assert;function Uh(){var e;this.setModules=function(t){e=t},this.ResvFrameBegin=function(t,s){var a,o=t.internal_flags,n=o.l3_side,r=e.getframebits(t);s.bits=(r-8*o.sideinfo_len)/o.mode_gr;var i=2048*o.mode_gr-8;t.brate>320?a=8*int(1e3*t.brate/(t.out_samplerate/1152)/8+.5):(a=11520,t.strict_ISO&&(a=8*int(32e4/(t.out_samplerate/1152)/8+.5))),o.ResvMax=a-r,o.ResvMax>i&&(o.ResvMax=i),(o.ResvMax<0||t.disable_reservoir)&&(o.ResvMax=0);var l=s.bits*o.mode_gr+Math.min(o.ResvSize,o.ResvMax);return l>a&&(l=a),$h(o.ResvMax%8==0),$h(o.ResvMax>=0),n.resvDrain_pre=0,null!=o.pinfo&&(o.pinfo.mean_bits=s.bits/2,o.pinfo.resvsize=o.ResvSize),l},this.ResvMaxBits=function(e,t,s,a){var o,n=e.internal_flags,r=n.ResvSize,i=n.ResvMax;0!=a&&(r+=t),0!=(1&n.substep_shaping)&&(i*=.9),s.bits=t,10*r>9*i?(o=r-9*i/10,s.bits+=o,n.substep_shaping|=128):(o=0,n.substep_shaping&=127,e.disable_reservoir||0!=(1&n.substep_shaping)||(s.bits-=.1*t));var l=r<6*n.ResvMax/10?r:6*n.ResvMax/10;return(l-=o)<0&&(l=0),l},this.ResvAdjust=function(e,t){e.ResvSize-=t.part2_3_length+t.part2_length},this.ResvFrameEnd=function(e,t){var s,a=e.l3_side;e.ResvSize+=t*e.mode_gr;var o=0;a.resvDrain_post=0,a.resvDrain_pre=0,0!=(s=e.ResvSize%8)&&(o+=s),(s=e.ResvSize-o-e.ResvMax)>0&&(o+=s);var n=Math.min(8*a.main_data_begin,o)/8;a.resvDrain_pre+=8*n,o-=8*n,e.ResvSize-=8*n,a.main_data_begin-=n,a.resvDrain_post+=o,e.ResvSize-=o}}function qh(){this.getLameVersion=function(){return"3.98.4"},this.getLameShortVersion=function(){return"3.98.4"},this.getLameVeryShortVersion=function(){return"LAME3.98r"},this.getPsyVersion=function(){return"0.93"},this.getLameUrl=function(){return"http://www.mp3dev.org/"},this.getLameOsBitness=function(){return"32bits"}}var Vh=Hm.System,zh=Hm.VbrMode,Xh=Hm.ShortBlock,Yh=Hm.Arrays,Kh=Hm.new_byte,Gh=Hm.assert;function Zh(){var e,t,s;this.setModules=function(a,o,n){e=a,t=o,s=n};var a=Zh.NUMTOCENTRIES,o=Zh.MAXFRAMESIZE,n=a+4+4+4+4+4+9+1+1+8+1+1+3+1+1+2+4+2+2,r=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function i(e,t){var s=255&e[t+0];return s<<=8,s|=255&e[t+1],s<<=8,s|=255&e[t+2],s<<=8,s|=255&e[t+3]}function l(e,t,s){e[t+0]=255&s>>24,e[t+1]=255&s>>16,e[t+2]=255&s>>8,e[t+3]=255&s}function c(e,t,s){e[t+0]=255&s>>8,e[t+1]=255&s}function d(e,t,s){return 255&(e<<t|s&~(-1<<t))}function u(t,s){var a=t.internal_flags;s[0]=d(s[0],8,255),s[1]=d(s[1],3,7),s[1]=d(s[1],1,t.out_samplerate<16e3?0:1),s[1]=d(s[1],1,t.version),s[1]=d(s[1],2,1),s[1]=d(s[1],1,t.error_protection?0:1),s[2]=d(s[2],4,a.bitrate_index),s[2]=d(s[2],2,a.samplerate_index),s[2]=d(s[2],1,0),s[2]=d(s[2],1,t.extension),s[3]=d(s[3],2,t.mode.ordinal()),s[3]=d(s[3],2,a.mode_ext),s[3]=d(s[3],1,t.copyright),s[3]=d(s[3],1,t.original),s[3]=d(s[3],2,t.emphasis),s[0]=255;var o,n,r=241&s[1];o=1==t.version?128:t.out_samplerate<16e3?32:64,t.VBR==zh.vbr_off&&(o=t.brate),n=t.free_format?0:255&16*e.BitrateIndex(o,t.version,t.out_samplerate),1==t.version?(s[1]=255&(10|r),r=13&s[2],s[2]=255&(n|r)):(s[1]=255&(2|r),r=13&s[2],s[2]=255&(n|r))}function m(e,t){return t=t>>8^r[255&(t^e)]}this.addVbrFrame=function(e){var t=e.internal_flags,s=Tables.bitrate_table[e.version][t.bitrate_index];Gh(null!=t.VBR_seek_table.bag),function(e,t){if(e.nVbrNumFrames++,e.sum+=t,e.seen++,!(e.seen<e.want)&&(e.pos<e.size&&(e.bag[e.pos]=e.sum,e.pos++,e.seen=0),e.pos==e.size)){for(var s=1;s<e.size;s+=2)e.bag[s/2]=e.bag[s];e.want*=2,e.pos/=2}}(t.VBR_seek_table,s)},this.getVbrTag=function(e){var t=new VBRTagData,s=0;t.flags=0;var o=e[s+1]>>3&1,n=e[s+2]>>2&3,r=e[s+3]>>6&3,l=e[s+2]>>4&15;if(l=Tables.bitrate_table[o][l],e[s+1]>>4==14?t.samprate=Tables.samplerate_table[2][n]:t.samprate=Tables.samplerate_table[o][n],!function(e,t){return new String(e,t,"Xing".length(),null).equals("Xing")||new String(e,t,"Info".length(),null).equals("Info")}(e,s+=0!=o?3!=r?36:21:3!=r?21:13))return null;s+=4,t.hId=o;var c=t.flags=i(e,s);if(s+=4,0!=(1&c)&&(t.frames=i(e,s),s+=4),0!=(2&c)&&(t.bytes=i(e,s),s+=4),0!=(4&c)){if(null!=t.toc)for(var d=0;d<a;d++)t.toc[d]=e[s+d];s+=a}t.vbrScale=-1,0!=(8&c)&&(t.vbrScale=i(e,s),s+=4),t.headersize=72e3*(o+1)*l/t.samprate;var u=e[(s+=21)+0]<<4;u+=e[s+1]>>4;var m=(15&e[s+1])<<8;return(u<0||u>3e3)&&(u=-1),((m+=255&e[s+2])<0||m>3e3)&&(m=-1),t.encDelay=u,t.encPadding=m,t},this.InitVbrTag=function(e){var s,a=e.internal_flags;s=1==e.version?128:e.out_samplerate<16e3?32:64,e.VBR==zh.vbr_off&&(s=e.brate);var r=72e3*(e.version+1)*s/e.out_samplerate,i=a.sideinfo_len+n;if(a.VBR_seek_table.TotalFrameSize=r,r<i||r>o)e.bWriteVbrTag=!1;else{a.VBR_seek_table.nVbrNumFrames=0,a.VBR_seek_table.nBytesWritten=0,a.VBR_seek_table.sum=0,a.VBR_seek_table.seen=0,a.VBR_seek_table.want=1,a.VBR_seek_table.pos=0,null==a.VBR_seek_table.bag&&(a.VBR_seek_table.bag=new int[400],a.VBR_seek_table.size=400);var l=Kh(o);u(e,l);for(var c=a.VBR_seek_table.TotalFrameSize,d=0;d<c;++d)t.add_dummy_byte(e,255&l[d],1)}},this.updateMusicCRC=function(e,t,s,a){for(var o=0;o<a;++o)e[0]=m(t[s+o],e[0])},this.getLameTagFrame=function(e,o){var n=e.internal_flags;if(!e.bWriteVbrTag)return 0;if(n.Class_ID!=Lame.LAME_ID)return 0;if(n.VBR_seek_table.pos<=0)return 0;if(o.length<n.VBR_seek_table.TotalFrameSize)return n.VBR_seek_table.TotalFrameSize;Yh.fill(o,0,n.VBR_seek_table.TotalFrameSize,0),u(e,o);var r=Kh(a);if(e.free_format)for(var i=1;i<a;++i)r[i]=255&255*i/100;else!function(e,t){if(!(e.pos<=0))for(var s=1;s<a;++s){var o=s/a,n=0|Math.floor(o*e.pos);n>e.pos-1&&(n=e.pos-1);var r=0|256*e.bag[n]/e.sum;r>255&&(r=255),t[s]=255&r}}(n.VBR_seek_table,r);var d=n.sideinfo_len;e.error_protection&&(d-=2),e.VBR==zh.vbr_off?(o[d++]=255&"Info".charAt(0),o[d++]=255&"Info".charAt(1),o[d++]=255&"Info".charAt(2),o[d++]=255&"Info".charAt(3)):(o[d++]=255&"Xing".charAt(0),o[d++]=255&"Xing".charAt(1),o[d++]=255&"Xing".charAt(2),o[d++]=255&"Xing".charAt(3)),l(o,d,15),l(o,d+=4,n.VBR_seek_table.nVbrNumFrames),d+=4;var p=n.VBR_seek_table.nBytesWritten+n.VBR_seek_table.TotalFrameSize;l(o,d,0|p),d+=4,Vh.arraycopy(r,0,o,d,r.length),d+=r.length,e.error_protection&&t.CRC_writeheader(n,o);var h=0;for(i=0;i<d;i++)h=m(o[i],h);return d+=function(e,t,a,o,n){var r,i,d,u,p,h=e.internal_flags,f=0,g=e.encoder_delay,_=e.encoder_padding,v=100-10*e.VBR_q-e.quality,b=s.getLameVeryShortVersion(),y=[1,5,3,2,4,0,3],x=0|(e.lowpassfreq/100+.5>255?255:e.lowpassfreq/100+.5),w=0,k=0,S=e.internal_flags.noise_shaping,M=0,A=0,R=0,T=0!=(1&e.exp_nspsytune),E=0!=(2&e.exp_nspsytune),B=!1,O=!1,C=e.internal_flags.nogap_total,j=e.internal_flags.nogap_current,I=e.ATHtype;switch(e.VBR){case vbr_abr:p=e.VBR_mean_bitrate_kbps;break;case vbr_off:p=e.brate;break;default:p=e.VBR_min_bitrate_kbps}switch(r=0+(e.VBR.ordinal()<y.length?y[e.VBR.ordinal()]:0),h.findReplayGain&&(h.RadioGain>510&&(h.RadioGain=510),h.RadioGain<-510&&(h.RadioGain=-510),k=8192,k|=3072,h.RadioGain>=0?k|=h.RadioGain:(k|=512,k|=-h.RadioGain)),h.findPeakSample&&(w=Math.abs(0|h.PeakSample/32767*Math.pow(2,23)+.5)),-1!=C&&(j>0&&(O=!0),j<C-1&&(B=!0)),u=I+((T?1:0)<<4)+((E?1:0)<<5)+((B?1:0)<<6)+((O?1:0)<<7),v<0&&(v=0),e.mode){case MONO:M=0;break;case STEREO:M=1;break;case DUAL_CHANNEL:M=2;break;case JOINT_STEREO:M=e.force_ms?4:3;break;case NOT_SET:default:M=7}R=e.in_samplerate<=32e3?0:48e3==e.in_samplerate?2:e.in_samplerate>48e3?3:1,(e.short_blocks==Xh.short_block_forced||e.short_blocks==Xh.short_block_dispensed||-1==e.lowpassfreq&&-1==e.highpassfreq||e.scale_left<e.scale_right||e.scale_left>e.scale_right||e.disable_reservoir&&e.brate<320||e.noATH||e.ATHonly||0==I||e.in_samplerate<=32e3)&&(A=1),i=S+(M<<2)+(A<<5)+(R<<6),d=h.nMusicCRC,l(a,o+f,v),f+=4;for(var L=0;L<9;L++)a[o+f+L]=255&b.charAt(L);a[o+(f+=9)]=255&r,a[o+ ++f]=255&x,l(a,o+ ++f,w),c(a,o+(f+=4),k),c(a,o+(f+=2),0),a[o+(f+=2)]=255&u,a[o+ ++f]=p>=255?255:255&p,a[o+ ++f]=255&g>>4,a[o+f+1]=255&(g<<4)+(_>>8),a[o+f+2]=255&_,a[o+(f+=3)]=255&i,f++,a[o+f++]=0,c(a,o+f,e.preset),l(a,o+(f+=2),t),c(a,o+(f+=4),d),f+=2;for(var P=0;P<f;P++)n=m(a[o+P],n);return c(a,o+f,n),f+=2}(e,p,o,d,h),n.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(e,t){if(e.internal_flags.VBR_seek_table.pos<=0)return-1;if(t.seek(t.length()),0==t.length())return-1;var s=function(e){e.seek(0);var t=Kh(10);return e.readFully(t),new String(t,"ISO-8859-1").startsWith("ID3")?0:((127&t[6])<<21|(127&t[7])<<14|(127&t[8])<<7|127&t[9])+t.length}(t);t.seek(s);var a=Kh(o),n=getLameTagFrame(e,a);return n>a.length?-1:(n<1||t.write(a,0,n),0)}}Zh.NUMTOCENTRIES=100,Zh.MAXFRAMESIZE=2880;var Wh=Hm.new_byte,Qh=Hm.assert;function Jh(){this.setModules=function(e,t){}}function ef(){this.setModules=function(e,t,s){}}function tf(){}function sf(){this.setModules=function(e,t){}}function af(e,t,s){3!=arguments.length&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),e=1,t=44100,s=128);var a=new Ah,o=new Jh,n=new qp,r=new vh,i=new Th,l=new rh,c=new Dh,d=new Zh,u=new qh,m=new sf,p=new Uh,h=new uh,f=new ef,g=new tf;a.setModules(n,r,i,l,c,d,u,m,g),r.setModules(n,g,u,d),m.setModules(r,u),i.setModules(a),c.setModules(r,p,l,h),l.setModules(h,p,a.enc.psy),p.setModules(r),h.setModules(l),d.setModules(a,r,u),o.setModules(f,g),f.setModules(u,m,i);var _=a.lame_init();_.num_channels=e,_.in_samplerate=t,_.brate=s,_.mode=Gm.STEREO,_.quality=3,_.bWriteVbrTag=!1,_.disable_reservoir=!0,_.write_id3tag_automatic=!1,a.lame_init_params(_);var v=1152,b=0|1.25*v+7200,y=Wh(b);this.encodeBuffer=function(t,s){1==e&&(s=t),Qh(t.length==s.length),t.length>v&&(v=t.length,y=Wh(b=0|1.25*v+7200));var o=a.lame_encode_buffer(_,t,s,t.length,y,0,b);return new Int8Array(y.subarray(0,o))},this.flush=function(){var e=a.lame_encode_flush(_,y,0,b);return new Int8Array(y.subarray(0,e))}}function of(e){return e.charCodeAt(0)<<24|e.charCodeAt(1)<<16|e.charCodeAt(2)<<8|e.charCodeAt(3)}of("RIFF"),of("WAVE"),of("fmt "),of("data");class nf{constructor(e){this.bitRate=e.bitRate,this.sampleRate=e.sampleRate,this.dataBuffer=[],this.encoder=new af(1,this.sampleRate,this.bitRate)}encode(e){const t=this._convertBuffer(e);let s=t.length;for(let e=0;s>=0;e+=1152){const a=t.subarray(e,e+1152),o=this.encoder.encodeBuffer(a);this.dataBuffer.push(new Int8Array(o)),s-=1152}}finish(){this.dataBuffer.push(this.encoder.flush());const e=new Blob(this.dataBuffer,{type:"audio/mp3"});return this.dataBuffer=[],{id:Date.now(),blob:e,url:URL.createObjectURL(e)}}_floatTo16BitPCM(e,t){for(let s=0;s<e.length;s++){const a=Math.max(-1,Math.min(1,e[s]));t[s]=a<0?32768*a:32767*a}}_convertBuffer(e){const t=new Float32Array(e),s=new Int16Array(e.length);return this._floatTo16BitPCM(t,s),s}}class rf{constructor(e={}){this.beforeRecording=e.beforeRecording,this.pauseRecording=e.pauseRecording,this.afterRecording=e.afterRecording,this.micFailed=e.micFailed,this.encoderOptions={bitRate:e.bitRate,sampleRate:e.sampleRate},this.bufferSize=4096,this.records=[],this.isPause=!1,this.isRecording=!1,this.duration=0,this.volume=0,this._duration=0}start(){this.beforeRecording&&this.beforeRecording("start recording"),navigator.mediaDevices.getUserMedia({video:!1,audio:{channelCount:1,echoCancellation:!1}}).then(this._micCaptured.bind(this)).catch(this._micError.bind(this)),this.isPause=!1,this.isRecording=!0,this.lameEncoder||(this.lameEncoder=new nf(this.encoderOptions))}stop(){this.stream.getTracks().forEach(e=>e.stop()),this.input.disconnect(),this.processor.disconnect(),this.context.close();let e=null;e=this.lameEncoder.finish(),e.duration=this.duration,this.records.push(e),this._duration=0,this.duration=0,this.isPause=!1,this.isRecording=!1,this.afterRecording&&this.afterRecording(e)}pause(){this.stream.getTracks().forEach(e=>e.stop()),this.input.disconnect(),this.processor.disconnect(),this._duration=this.duration,this.isPause=!0,this.pauseRecording&&this.pauseRecording("pause recording")}_micCaptured(e){this.context=new(window.AudioContext||window.webkitAudioContext),this.duration=this._duration,this.input=this.context.createMediaStreamSource(e),this.processor=this.context.createScriptProcessor(this.bufferSize,1,1),this.stream=e,this.processor.onaudioprocess=e=>{const t=e.inputBuffer.getChannelData(0);let s=0;this.lameEncoder&&this.lameEncoder.encode(t);for(let e=0;e<t.length;++e)s+=t[e]*t[e];this.duration=parseFloat(this._duration)+parseFloat(this.context.currentTime.toFixed(2)),this.volume=Math.sqrt(s/t.length).toFixed(2)},this.input.connect(this.processor),this.processor.connect(this.context.destination)}_micError(e){this.micFailed&&this.micFailed(e)}}var lf=window.chrome,cf=window.navigator,df=cf.vendor,uf=void 0!==window.opr,mf=cf.userAgent.indexOf("Edg")>-1,pf=cf.userAgent.match("CriOS");function hf(){var e=function(){var e=navigator.userAgent||navigator.vendor||window.opera||null;if(!e)throw new Error("Failed to look for user agent information.");return e}(),t=e.substr(0,4);return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw(n|u)|c55\/|capi|ccwa|cdm|cell|chtm|cldc|cmd|co(mp|nd)|craw|da(it|ll|ng)|dbte|dcs|devi|dica|dmob|do(c|p)o|ds(12|d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(|_)|g1 u|g560|gene|gf5|gmo|go(\.w|od)|gr(ad|un)|haie|hcit|hd(m|p|t)|hei|hi(pt|ta)|hp( i|ip)|hsc|ht(c(| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i(20|go|ma)|i230|iac( ||\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|[a-w])|libw|lynx|m1w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|mcr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|([1-8]|c))|phil|pire|pl(ay|uc)|pn2|po(ck|rt|se)|prox|psio|ptg|qaa|qc(07|12|21|32|60|[2-7]|i)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h|oo|p)|sdk\/|se(c(|0|1)|47|mc|nd|ri)|sgh|shar|sie(|m)|sk0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h|v|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl|tdg|tel(i|m)|tim|tmo|to(pl|sh)|ts(70|m|m3|m5)|tx9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas|your|zeto|zte/i.test(t)}const ff={name:"RoomFooter",components:{SvgIcon:Un,EmojiPickerContainer:Nu,RoomFiles:zu,RoomMessageReply:um,RoomUsersTag:_m,RoomEmojis:xm,RoomTemplatesText:Tm},directives:{clickOutside:Dl},props:{room:{type:Object,required:!0},roomId:{type:[String,Number],required:!0},roomMessage:{type:String,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},showEmojis:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},templatesText:{type:Array,default:null},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},initReplyMessage:{type:Object,default:null},initEditMessage:{type:Object,default:null},droppedFiles:{type:Array,default:null},emojiDataSource:{type:String,default:void 0}},emits:["edit-message","send-message","update-edited-message-id","textarea-action-handler","typing-message"],data(){return{message:"",editedMessage:{},messageReply:null,cursorRangePosition:null,files:[],fileDialog:!1,selectUsersTagItem:null,selectEmojiItem:null,selectTemplatesTextItem:null,format:"mp3",activeUpOrDownEmojis:null,activeUpOrDownUsersTag:null,activeUpOrDownTemplatesText:null,emojisDB:new ld({dataSource:this.emojiDataSource}),emojiOpened:!1,keepKeyboardOpen:!1,filteredEmojis:[],filteredUsersTag:[],selectedUsersTag:[],filteredTemplatesText:[],recorder:this.initRecorder(),isRecording:!1}},computed:{isMessageEmpty(){return!this.files.length&&!this.message.trim()},isFileLoading(){return this.files.some(e=>e.loading)},recordedTime(){return new Date(1e3*this.recorder.duration).toISOString().substr(14,5)},shadowFooter(){return!!(this.filteredEmojis.length||this.filteredUsersTag.length||this.filteredTemplatesText.length||this.files.length||this.messageReply)}},watch:{roomId(){this.resetMessage(!0,!0),this.roomMessage&&(this.message=this.roomMessage,setTimeout(()=>this.onChangeInput()))},message(e){this.getTextareaRef().value=e},roomMessage:{immediate:!0,handler(e){e&&(this.message=this.roomMessage)}},editedMessage(e){this.$emit("update-edited-message-id",e._id)},initReplyMessage(e){e&&this.replyMessage(e)},initEditMessage(e){e&&this.editMessage(e)},droppedFiles(e){e&&this.onFileChange(e)}},mounted(){const e=hf();let t=!0;this.getTextareaRef().addEventListener("keyup",s=>{"Enter"!==s.key||s.shiftKey||this.fileDialog||(e?(this.message=this.message+"\n",setTimeout(()=>this.onChangeInput())):!t||this.filteredEmojis.length||this.filteredUsersTag.length||this.filteredTemplatesText.length||this.sendMessage()),t=!s.isComposing,setTimeout(()=>{this.updateFooterLists()},60)}),this.getTextareaRef().addEventListener("click",()=>{e&&(this.keepKeyboardOpen=!0),this.updateFooterLists()}),this.getTextareaRef().addEventListener("blur",()=>{setTimeout(()=>{this.resetFooterList()},100),e&&setTimeout(()=>this.keepKeyboardOpen=!1)})},beforeUnmount(){this.stopRecorder()},methods:{getTextareaRef(){return this.$refs.roomTextarea},focusTextarea(e){hf()&&e||this.getTextareaRef()&&(this.getTextareaRef().focus(),this.cursorRangePosition&&setTimeout(()=>{const e=pf||null!=lf&&"Google Inc."===df&&!1===uf&&!1===mf?0:1;this.getTextareaRef().setSelectionRange(this.cursorRangePosition+e,this.cursorRangePosition+e),this.cursorRangePosition=null}))},onChangeInput(){var e,t,s;((null==(e=this.getTextareaRef())?void 0:e.value)||""===(null==(t=this.getTextareaRef())?void 0:t.value))&&(this.message=null==(s=this.getTextareaRef())?void 0:s.value),this.keepKeyboardOpen=!0,this.resizeTextarea(),this.$emit("typing-message",this.message)},resizeTextarea(){const e=this.getTextareaRef();if(!e)return;const t=window.getComputedStyle(e,null).getPropertyValue("padding-top").replace("px","");e.style.height=0,e.style.height=e.scrollHeight-2*t+"px"},escapeTextarea(){this.filteredEmojis.length?this.filteredEmojis=[]:this.filteredUsersTag.length?this.filteredUsersTag=[]:this.filteredTemplatesText.length?this.filteredTemplatesText=[]:this.resetMessage()},onPasteImage(e){var t;const s=null==(t=e.clipboardData)?void 0:t.items;s&&Array.from(s).forEach(e=>{if(e.type.includes("image")){const t=e.getAsFile();this.onFileChange([t])}})},updateActiveUpOrDown(e,t){this.filteredEmojis.length?(this.activeUpOrDownEmojis=t,e.preventDefault()):this.filteredUsersTag.length?(this.activeUpOrDownUsersTag=t,e.preventDefault()):this.filteredTemplatesText.length&&(this.activeUpOrDownTemplatesText=t,e.preventDefault())},selectItem(){this.filteredEmojis.length?this.selectEmojiItem=!0:this.filteredUsersTag.length?this.selectUsersTagItem=!0:this.filteredTemplatesText.length&&(this.selectTemplatesTextItem=!0)},selectEmoji(e){if(this.selectEmojiItem=!1,!e)return;const{position:t,endPosition:s}=this.getCharPosition(":");this.message=this.message.substr(0,t-1)+e+this.message.substr(s,this.message.length-1),this.cursorRangePosition=t,this.focusTextarea()},selectTemplateText(e){if(this.selectTemplatesTextItem=!1,!e)return;const{position:t,endPosition:s}=this.getCharPosition("/"),a=this.message.substr(s,s).length?"":" ";this.message=this.message.substr(0,t-1)+e.text+a+this.message.substr(s,this.message.length-1),this.cursorRangePosition=t+e.text.length+a.length+1,this.focusTextarea()},addEmoji(e){this.message+=e.unicode,this.focusTextarea(!0)},launchFilePicker(){this.$refs.file.value="",this.$refs.file.click()},async onFileChange(e){this.fileDialog=!0,this.focusTextarea(),Array.from(e).forEach(async e=>{const t=URL.createObjectURL(e),s=e.name.lastIndexOf(".");this.files.push({loading:!0,name:e.name.substring(0,s),size:e.size,type:e.type,extension:e.name.substring(s+1),localUrl:t});const a=await fetch(t).then(e=>e.blob());let o=this.files.find(e=>e.localUrl===t);o&&(o.blob=a,o.loading=!1,delete o.loading)}),setTimeout(()=>this.fileDialog=!1,500)},removeFile(e){this.files.splice(e,1),this.focusTextarea()},toggleRecorder(e){if(this.isRecording=e,this.recorder.isRecording)try{this.recorder.stop();const e=this.recorder.records[0];this.files.push({blob:e.blob,name:"audio."+this.format,size:e.blob.size,duration:e.duration,type:e.blob.type,audio:!0,localUrl:URL.createObjectURL(e.blob)}),this.recorder=this.initRecorder(),this.sendMessage()}catch{setTimeout(()=>this.stopRecorder(),100)}else setTimeout(()=>this.recorder.start(),200)},stopRecorder(){if(this.recorder.isRecording)try{this.recorder.stop(),this.recorder=this.initRecorder()}catch{setTimeout(()=>this.stopRecorder(),100)}},textareaActionHandler(){this.$emit("textarea-action-handler",this.message)},sendMessage(){var e;let t=this.message.trim();if(!this.files.length&&!t)return;if(this.isFileLoading)return;this.selectedUsersTag.forEach(e=>{t=t.replace("@"+e.username,`<usertag>${e._id}</usertag>`)});const s=this.files.length?this.files:null;this.editedMessage._id?(this.editedMessage.content!==t||(null==(e=this.editedMessage.files)?void 0:e.length)||this.files.length)&&this.$emit("edit-message",{messageId:this.editedMessage._id,newContent:t,files:s,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}):this.$emit("send-message",{content:t,files:s,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}),this.resetMessage(!0)},editMessage(e){this.resetMessage(),this.editedMessage={...e};let t=e.content;const s=t;[...t.matchAll(new RegExp("<usertag>","gi"))].map(e=>e.index).forEach(e=>{const a=s.substring(e+"<usertag>".length,s.indexOf("</usertag>",e)),o=this.room.users.find(e=>e._id===a);t=t.replace(`<usertag>${a}</usertag>`,"@"+((null==o?void 0:o.username)||"unknown")),this.selectUserTag(o,!0)}),this.message=t,e.files&&(this.files=[...e.files]),setTimeout(()=>this.resizeTextarea())},replyMessage(e){this.editedMessage={},this.messageReply=e,this.focusTextarea()},updateFooterLists(){this.updateFooterList("@"),this.updateFooterList(":"),this.updateFooterList("/")},updateFooterList(e){if(!this.getTextareaRef())return;if(":"===e&&!this.emojisSuggestionEnabled)return;if(!("@"!==e||this.userTagsEnabled&&this.room.users))return;if("/"===e&&!this.templatesText)return;const t=this.getTextareaRef().selectionStart;let s=t;for(;s>0&&this.message.charAt(s-1)!==e&&(" "!==this.message.charAt(s-1)||":"!==e);)s--;const a=this.message.charAt(s-2),o=!a.match(/^[0-9a-zA-Z]+$/);if(this.message.charAt(s-1)!==e||a&&" "!==a&&!o)this.resetFooterList(e);else{const a=this.message.substring(s,t);":"===e?this.updateEmojis(a):"@"===e?this.updateShowUsersTag(a):"/"===e&&this.updateShowTemplatesText(a)}},updateShowUsersTag(e){this.filteredUsersTag=rc(this.room.users,"username",e,!0).filter(e=>e._id!==this.currentUserId)},selectUserTag(e,t=!1){if(this.selectUsersTagItem=!1,!e)return;const{position:s,endPosition:a}=this.getCharPosition("@"),o=this.message.substr(a,a).length?"":" ";this.message=this.message.substr(0,s)+e.username+o+this.message.substr(a,this.message.length-1),this.selectedUsersTag=[...this.selectedUsersTag,{...e}],t||(this.cursorRangePosition=s+e.username.length+o.length+1),this.focusTextarea()},updateShowTemplatesText(e){this.filteredTemplatesText=rc(this.templatesText,"tag",e,!0)},getCharPosition(e){let t=this.getTextareaRef().selectionStart;for(;t>0&&this.message.charAt(t-1)!==e;)t--;return{position:t,endPosition:this.getTextareaRef().selectionEnd}},async updateEmojis(e){if(!e)return;const t=await this.emojisDB.getEmojiBySearchQuery(e);this.filteredEmojis=t.map(e=>e.unicode)},resetFooterList(e=null){":"===e?this.filteredEmojis=[]:"@"===e?this.filteredUsersTag=[]:("/"===e||(this.filteredEmojis=[],this.filteredUsersTag=[]),this.filteredTemplatesText=[])},resetMessage(e=!1,t=!1){t||this.$emit("typing-message",null),this.selectedUsersTag=[],this.resetFooterList(),this.resetTextareaSize(),this.message="",this.editedMessage={},this.messageReply=null,this.files=[],this.emojiOpened=!1,this.preventKeyboardFromClosing(),!this.textareaAutoFocus&&t||setTimeout(()=>this.focusTextarea(e))},resetTextareaSize(){this.getTextareaRef()&&(this.getTextareaRef().style.height="20px")},preventKeyboardFromClosing(){this.keepKeyboardOpen&&this.getTextareaRef().focus()},initRecorder(){return this.isRecording=!1,new rf({bitRate:Number(this.audioBitRate),sampleRate:Number(this.audioSampleRate),beforeRecording:null,afterRecording:null,pauseRecording:null,micFailed:this.micFailed})},micFailed(){this.isRecording=!1,this.recorder=this.initRecorder()}}},gf={key:0,class:"vac-icon-textarea-left"},_f=Ka("div",{class:"vac-dot-audio-record"},null,-1),vf={class:"vac-dot-audio-record-time"},bf=["placeholder"],yf={class:"vac-icon-textarea"},xf={key:1},wf=["accept"];var kf=Bn(ff,[["render",function(e,t,s,a,o,n){const r=qs("room-emojis"),i=qs("room-users-tag"),l=qs("room-templates-text"),c=qs("room-message-reply"),d=qs("room-files"),u=qs("svg-icon"),m=qs("emoji-picker-container"),p=zs("click-outside");return $s((Na(),$a("div",{id:"room-footer",class:Ue(["vac-room-footer",{"vac-app-box-shadow":n.shadowFooter}])},[Ga(r,{"filtered-emojis":o.filteredEmojis,"select-item":o.selectEmojiItem,"active-up-or-down":o.activeUpOrDownEmojis,onSelectEmoji:t[0]||(t[0]=e=>n.selectEmoji(e)),onActivateItem:t[1]||(t[1]=e=>o.activeUpOrDownEmojis=0)},null,8,["filtered-emojis","select-item","active-up-or-down"]),Ga(i,{"filtered-users-tag":o.filteredUsersTag,"select-item":o.selectUsersTagItem,"active-up-or-down":o.activeUpOrDownUsersTag,onSelectUserTag:t[2]||(t[2]=e=>n.selectUserTag(e)),onActivateItem:t[3]||(t[3]=e=>o.activeUpOrDownUsersTag=0)},null,8,["filtered-users-tag","select-item","active-up-or-down"]),Ga(l,{"filtered-templates-text":o.filteredTemplatesText,"select-item":o.selectTemplatesTextItem,"active-up-or-down":o.activeUpOrDownTemplatesText,onSelectTemplateText:t[4]||(t[4]=e=>n.selectTemplateText(e)),onActivateItem:t[5]||(t[5]=e=>o.activeUpOrDownTemplatesText=0)},null,8,["filtered-templates-text","select-item","active-up-or-down"]),Ga(c,{room:s.room,"message-reply":o.messageReply,"text-formatting":s.textFormatting,"link-options":s.linkOptions,onResetMessage:n.resetMessage},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["room","message-reply","text-formatting","link-options","onResetMessage"]),Ga(d,{files:o.files,onRemoveFile:n.removeFile,onResetMessage:n.resetMessage},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["files","onRemoveFile","onResetMessage"]),Ka("div",{class:Ue(["vac-box-footer",{"vac-box-footer-border":!o.files.length}])},[s.showAudio&&!o.files.length?(Na(),$a("div",gf,[o.isRecording?(Na(),$a(Oa,{key:0},[Ka("div",{class:"vac-svg-button vac-icon-audio-stop",onClick:t[6]||(t[6]=(...e)=>n.stopRecorder&&n.stopRecorder(...e))},[Zs(e.$slots,"audio-stop-icon",{},()=>[Ga(u,{name:"close-outline"})])]),_f,Ka("div",vf,Ve(n.recordedTime),1),Ka("div",{class:"vac-svg-button vac-icon-audio-confirm",onClick:t[7]||(t[7]=e=>n.toggleRecorder(!1))},[Zs(e.$slots,"audio-check-icon",{},()=>[Ga(u,{name:"checkmark"})])])],64)):(Na(),$a("div",{key:1,class:"vac-svg-button",onClick:t[8]||(t[8]=e=>n.toggleRecorder(!0))},[Zs(e.$slots,"microphone-icon",{},()=>[Ga(u,{name:"microphone",class:"vac-icon-microphone"})])]))])):Ja("",!0),Ka("textarea",{id:"roomTextarea",ref:"roomTextarea",placeholder:s.textMessages.TYPE_MESSAGE,class:Ue(["vac-textarea",{"vac-textarea-outline":o.editedMessage._id}]),style:{"min-height":"20px","padding-left":"12px"},onInput:t[9]||(t[9]=(...e)=>n.onChangeInput&&n.onChangeInput(...e)),onKeydown:[t[10]||(t[10]=Sn((...e)=>n.escapeTextarea&&n.escapeTextarea(...e),["esc"])),t[11]||(t[11]=Sn(wn((...e)=>n.selectItem&&n.selectItem(...e),["exact","prevent"]),["enter"])),t[13]||(t[13]=Sn(wn(()=>{},["exact","prevent"]),["tab"])),t[14]||(t[14]=Sn((...e)=>n.selectItem&&n.selectItem(...e),["tab"])),t[15]||(t[15]=Sn(e=>n.updateActiveUpOrDown(e,-1),["up"])),t[16]||(t[16]=Sn(e=>n.updateActiveUpOrDown(e,1),["down"]))],onPaste:t[12]||(t[12]=(...e)=>n.onPasteImage&&n.onPasteImage(...e))},null,42,bf),Ka("div",yf,[o.editedMessage._id?(Na(),$a("div",{key:0,class:"vac-svg-button",onClick:t[17]||(t[17]=(...e)=>n.resetMessage&&n.resetMessage(...e))},[Zs(e.$slots,"edit-close-icon",{},()=>[Ga(u,{name:"close-outline"})])])):Ja("",!0),s.showEmojis?$s((Na(),$a("div",xf,[Zs(e.$slots,"emoji-picker",ao({emojiOpened:o.emojiOpened},{addEmoji:n.addEmoji}),()=>[Ga(m,{"emoji-opened":o.emojiOpened,"position-top":!0,"emoji-data-source":s.emojiDataSource,onAddEmoji:n.addEmoji,onOpenEmoji:t[18]||(t[18]=e=>o.emojiOpened=e)},{"emoji-picker-icon":ss(()=>[Zs(e.$slots,"emoji-picker-icon")]),_:3},8,["emoji-opened","emoji-data-source","onAddEmoji"])])])),[[p,()=>o.emojiOpened=!1]]):Ja("",!0),s.showFiles?(Na(),$a("div",{key:2,class:"vac-svg-button",onClick:t[19]||(t[19]=(...e)=>n.launchFilePicker&&n.launchFilePicker(...e))},[Zs(e.$slots,"paperclip-icon",{},()=>[Ga(u,{name:"paperclip"})])])):Ja("",!0),s.textareaActionEnabled?(Na(),$a("div",{key:3,class:"vac-svg-button",onClick:t[20]||(t[20]=(...e)=>n.textareaActionHandler&&n.textareaActionHandler(...e))},[Zs(e.$slots,"custom-action-icon",{},()=>[Ga(u,{name:"deleted"})])])):Ja("",!0),s.showFiles?(Na(),$a("input",{key:4,ref:"file",type:"file",multiple:"",accept:s.acceptedFiles,style:{display:"none"},onChange:t[21]||(t[21]=e=>n.onFileChange(e.target.files))},null,40,wf)):Ja("",!0),s.showSendIcon?(Na(),$a("div",{key:5,class:Ue(["vac-svg-button",{"vac-send-disabled":n.isMessageEmpty}]),onClick:t[22]||(t[22]=(...e)=>n.sendMessage&&n.sendMessage(...e))},[Zs(e.$slots,"send-icon",{},()=>[Ga(u,{name:"send",param:n.isMessageEmpty||n.isFileLoading?"disabled":""},null,8,["param"])])],2)):Ja("",!0)])],2)],2)),[[Mn,Object.keys(s.room).length&&s.showFooter]])}]]);const Sf={class:"vac-reply-message"},Mf={class:"vac-reply-username"},Af={key:0,class:"vac-image-reply-container"},Rf={key:1,class:"vac-video-reply-container"},Tf={controls:""},Ef=["src"],Bf={key:3,class:"vac-file-container"},Of={class:"vac-text-ellipsis"},Cf={key:0,class:"vac-text-ellipsis vac-text-extension"},jf={class:"vac-reply-content"};var If=Bn({name:"MessageReply",components:{AudioPlayer:Qu,SvgIcon:Un,FormatMessage:jl},props:{message:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},roomUsers:{type:Array,required:!0}},computed:{replyUsername(){const{senderId:e}=this.message.replyMessage,t=this.roomUsers.find(t=>t._id===e);return t?t.username:""},firstFile(){var e,t;return(null==(t=null==(e=this.message.replyMessage)?void 0:e.files)?void 0:t.length)?this.message.replyMessage.files[0]:{}},isAudio(){return Xl(this.firstFile)},isImage(){return ql(this.firstFile)},isVideo(){return Vl(this.firstFile)},isOtherFile(){var e;return(null==(e=this.message.replyMessage.files)?void 0:e.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},[["render",function(e,t,s,a,o,n){const r=qs("audio-player"),i=qs("svg-icon"),l=qs("format-message");return Na(),$a("div",Sf,[Ka("div",Mf,Ve(n.replyUsername),1),n.isImage?(Na(),$a("div",Af,[Ka("div",{class:"vac-message-image vac-message-image-reply",style:He({"background-image":`url('${n.firstFile.url}')`})},null,4)])):n.isVideo?(Na(),$a("div",Rf,[Ka("video",Tf,[Ka("source",{src:n.firstFile.url},null,8,Ef)])])):n.isAudio?(Na(),Ua(r,{key:2,src:n.firstFile.url,"message-selection-enabled":!1,onUpdateProgressTime:t[0]||(t[0]=t=>e.progressTime=t),onHoverAudioProgress:t[1]||(t[1]=t=>e.hoverAudioProgress=t)},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["src"])):n.isOtherFile?(Na(),$a("div",Bf,[Ka("div",null,[Zs(e.$slots,"file-icon",{},()=>[Ga(i,{name:"file"})])]),Ka("div",Of,Ve(n.firstFile.name),1),n.firstFile.extension?(Na(),$a("div",Cf,Ve(n.firstFile.extension),1)):Ja("",!0)])):Ja("",!0),Ka("div",jf,[Ga(l,{"message-id":s.message.replyMessage._id,content:s.message.replyMessage.content,users:s.roomUsers,"text-formatting":s.textFormatting,"link-options":s.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])])}]]);const Lf={name:"ProgressBar",props:{progress:{type:Number,default:0}},data:()=>({radius:35,stroke:4,normalizedRadius:27,circumference:54*Math.PI}),computed:{strokeDashoffset(){return this.circumference-this.progress/100*this.circumference}}},Pf={ref:"progress",class:"vac-progress-wrapper"},Nf=["height","width"],Hf=["stroke-dasharray","stroke-width","r","cx","cy"],Ff={class:"vac-progress-text"},Df=Ka("span",{class:"vac-progress-pourcent"},"%",-1);var $f=Bn(Lf,[["render",function(e,t,s,a,o,n){return Na(),Ua(Wo,{name:"vac-fade-spinner",appear:""},{default:ss(()=>[Ka("div",Pf,[(Na(),$a("svg",{height:2*o.radius,width:2*o.radius},[Ka("circle",{stroke:"rgba(255, 255, 255, 0.7)","stroke-dasharray":o.circumference+" "+o.circumference,style:He({strokeDashoffset:n.strokeDashoffset,strokeLinecap:"round"}),"stroke-width":o.stroke,fill:"transparent",r:o.normalizedRadius,cx:o.radius,cy:o.radius},null,12,Hf)],8,Nf)),Ka("div",{class:"vac-progress-content",style:He({height:2*o.radius-19+"px",width:2*o.radius-19+"px"})},[Ka("div",Ff,[Qa(Ve(s.progress),1),Df])],4)],512)]),_:1})}]]);const Uf={name:"MessageFile",components:{SvgIcon:Un,Loader:Hn,ProgressBar:$f},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},file:{type:Object,required:!0},index:{type:Number,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file"],data:()=>({imageResponsive:"",imageLoading:!1,imageHover:!1}),computed:{isImageLoading(){return-1!==this.file.url.indexOf("blob:http")||this.imageLoading},isImage(){return ql(this.file)},isVideo(){return Vl(this.file)}},watch:{file:{immediate:!0,handler(){this.checkImgLoad()}}},mounted(){const e=this.$refs["imageRef"+this.index];e&&(this.imageResponsive={maxHeight:e.clientWidth-18,loaderTop:e.clientHeight/2-9})},methods:{checkImgLoad(){if(!ql(this.file))return;this.imageLoading=!0;const e=new Image;e.src=this.file.url,e.addEventListener("load",()=>this.imageLoading=!1)},openFile(e,t){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:this.file,action:t}))}}},qf={class:"vac-message-file-container"},Vf={key:0,class:"vac-image-buttons"},zf={controls:""},Xf=["src"];const Yf={name:"MessageFiles",components:{SvgIcon:Un,FormatMessage:jl,ProgressBar:$f,MessageFile:Bn(Uf,[["render",function(e,t,s,a,o,n){const r=qs("progress-bar"),i=qs("loader"),l=qs("svg-icon");return Na(),$a("div",qf,[n.isImage?(Na(),$a("div",{key:0,ref:"imageRef"+s.index,class:"vac-message-image-container",onMouseover:t[2]||(t[2]=e=>o.imageHover=!0),onMouseleave:t[3]||(t[3]=e=>o.imageHover=!1),onClick:t[4]||(t[4]=e=>n.openFile(e,"preview"))},[s.file.progress>=0?(Na(),Ua(r,{key:0,progress:s.file.progress,style:He({top:o.imageResponsive.loaderTop+"px"})},null,8,["progress","style"])):(Na(),Ua(i,{key:1,show:n.isImageLoading,type:"message-file","message-id":s.message._id,style:He({top:o.imageResponsive.loaderTop+"px"})},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["show","message-id","style"])),Ka("div",{class:Ue(["vac-message-image",{"vac-blur-loading":n.isImageLoading&&s.message.senderId===s.currentUserId}]),style:He({"background-image":`url('${n.isImageLoading&&s.file.preview||s.file.url}')`,"max-height":o.imageResponsive.maxHeight+"px"})},[Ga(Wo,{name:"vac-fade-image"},{default:ss(()=>[s.messageSelectionEnabled||!o.imageHover||n.isImageLoading?Ja("",!0):(Na(),$a("div",Vf,[Ka("div",{class:"vac-svg-button vac-button-view",onClick:t[0]||(t[0]=e=>n.openFile(e,"preview"))},[Zs(e.$slots,"eye-icon_"+s.message._id,{},()=>[Ga(l,{name:"eye"})])]),Ka("div",{class:"vac-svg-button vac-button-download",onClick:t[1]||(t[1]=e=>n.openFile(e,"download"))},[Zs(e.$slots,"document-icon_"+s.message._id,{},()=>[Ga(l,{name:"document"})])])]))]),_:3})],6)],544)):n.isVideo?(Na(),$a("div",{key:1,class:"vac-video-container",onClick:t[5]||(t[5]=wn(e=>n.openFile(e,"preview"),["prevent"]))},[s.file.progress>=0?(Na(),Ua(r,{key:0,progress:s.file.progress},null,8,["progress"])):Ja("",!0),Ka("video",zf,[Ka("source",{src:s.file.url},null,8,Xf)])])):Ja("",!0)])}]])},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},roomUsers:{type:Array,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file","open-user-tag"],computed:{imageVideoFiles(){return this.message.files.filter(e=>zl(e))},otherFiles(){return this.message.files.filter(e=>!zl(e))}},methods:{openFile(e,t,s){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:t,action:s}))}}},Kf={class:"vac-message-files-container"},Gf=["onClick"],Zf={class:"vac-svg-button"},Wf={class:"vac-text-ellipsis"},Qf={key:0,class:"vac-text-ellipsis vac-text-extension"};const Jf={name:"MessageActions",components:{SvgIcon:Un,EmojiPickerContainer:Nu},directives:{clickOutside:Dl},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},messageActions:{type:Array,required:!0},showReactionEmojis:{type:Boolean,required:!0},messageHover:{type:Boolean,required:!0},hoverMessageId:{type:[String,Number],default:null},hoverAudioProgress:{type:Boolean,required:!0},emojiDataSource:{type:String,default:void 0}},emits:["update-emoji-opened","update-options-opened","update-message-hover","message-action-handler","send-message-reaction"],data:()=>({menuOptionsTop:0,optionsOpened:!1,optionsClosing:!1,emojiOpened:!1}),computed:{isMessageActions(){return this.filteredMessageActions.length&&this.messageHover&&!this.message.deleted&&!this.message.disableActions&&!this.hoverAudioProgress},isMessageReactions(){return this.showReactionEmojis&&this.messageHover&&!this.message.deleted&&!this.message.disableReactions&&!this.hoverAudioProgress},filteredMessageActions(){return this.message.senderId===this.currentUserId?this.messageActions:this.messageActions.filter(e=>!e.onlyMe)}},watch:{emojiOpened(e){this.$emit("update-emoji-opened",e),e&&(this.optionsOpened=!1)},optionsOpened(e){this.$emit("update-options-opened",e)}},methods:{openOptions(){this.optionsClosing||(this.optionsOpened=!this.optionsOpened,this.optionsOpened&&setTimeout(()=>{const e=Iu(this.$el,"#room-footer");if(!e||!this.$refs.menuOptions||!this.$refs.actionIcon)return;const t=this.$refs.menuOptions.getBoundingClientRect().height,s=this.$refs.actionIcon.getBoundingClientRect().top,a=e.getBoundingClientRect().top-s>t+50;this.menuOptionsTop=a?30:-t}))},closeOptions(){this.optionsOpened=!1,this.optionsClosing=!0,this.updateMessageHover(),setTimeout(()=>this.optionsClosing=!1,100)},openEmoji(){this.emojiOpened=!this.emojiOpened},closeEmoji(){this.emojiOpened=!1,this.updateMessageHover()},updateMessageHover(){this.hoverMessageId!==this.message._id&&this.$emit("update-message-hover",!1)},messageActionHandler(e){this.closeOptions(),this.$emit("message-action-handler",e)},sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t}),this.closeEmoji()}}},eg={class:"vac-message-actions-wrapper"},tg={key:"3"},sg={class:"vac-menu-list"},ag=["onClick"];const og=["onClick"];function ng(e,t){return Object.prototype.hasOwnProperty.call(e,t)&&null!==e[t]&&void 0!==e[t]}const rg={name:"RoomMessage",components:{SvgIcon:Un,FormatMessage:jl,AudioPlayer:Qu,MessageReply:If,MessageFiles:Bn(Yf,[["render",function(e,t,s,a,o,n){const r=qs("message-file"),i=qs("progress-bar"),l=qs("svg-icon"),c=qs("format-message");return Na(),$a("div",Kf,[(Na(!0),$a(Oa,null,Ks(n.imageVideoFiles,(a,o)=>(Na(),$a("div",{key:o+"iv"},[Ga(r,{file:a,"current-user-id":s.currentUserId,message:s.message,index:o,"message-selection-enabled":s.messageSelectionEnabled,onOpenFile:t[0]||(t[0]=t=>e.$emit("open-file",t))},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["file","current-user-id","message","index","message-selection-enabled"])]))),128)),(Na(!0),$a(Oa,null,Ks(n.otherFiles,(t,s)=>(Na(),$a("div",{key:s+"a",class:"vac-file-wrapper"},[t.progress>=0?(Na(),Ua(i,{key:0,progress:t.progress,style:{top:"44px"}},null,8,["progress"])):Ja("",!0),Ka("div",{class:Ue(["vac-file-container",{"vac-file-container-progress":t.progress>=0}]),onClick:e=>n.openFile(e,t,"download")},[Ka("div",Zf,[Zs(e.$slots,"document-icon",{},()=>[Ga(l,{name:"document"})])]),Ka("div",Wf,Ve(t.name),1),t.extension?(Na(),$a("div",Qf,Ve(t.extension),1)):Ja("",!0)],10,Gf)]))),128)),Ga(c,{"message-id":s.message._id,content:s.message.content,users:s.roomUsers,"text-formatting":s.textFormatting,"link-options":s.linkOptions,onOpenUserTag:t[1]||(t[1]=t=>e.$emit("open-user-tag",t))},null,8,["message-id","content","users","text-formatting","link-options"])])}]]),MessageActions:Bn(Jf,[["render",function(e,t,s,a,o,n){const r=qs("svg-icon"),i=qs("emoji-picker-container"),l=zs("click-outside");return Na(),$a("div",eg,[Ka("div",{class:"vac-options-container",style:He({display:s.hoverAudioProgress?"none":"initial",width:n.filteredMessageActions.length&&s.showReactionEmojis?"70px":"45px"})},[Ga(gn,{name:"vac-slide-left",tag:"span"},{default:ss(()=>[n.isMessageActions||n.isMessageReactions?(Na(),$a("div",{key:"1",class:Ue(["vac-blur-container",{"vac-options-me":s.message.senderId===s.currentUserId}])},null,2)):Ja("",!0),n.isMessageActions?(Na(),$a("div",{ref:"actionIcon",key:"2",class:"vac-svg-button vac-message-options",onClick:t[0]||(t[0]=(...e)=>n.openOptions&&n.openOptions(...e))},[Zs(e.$slots,"dropdown-icon_"+s.message._id,{},()=>[Ga(r,{name:"dropdown",param:"message"})])],512)):Ja("",!0),n.isMessageReactions?$s((Na(),$a("div",tg,[Zs(e.$slots,"emoji-picker",ao({emojiOpened:o.emojiOpened},{addEmoji:n.sendMessageReaction}),()=>[Ga(i,{class:"vac-message-emojis",style:He({right:n.isMessageActions?"30px":"5px"}),"emoji-opened":o.emojiOpened,"emoji-reaction":!0,"position-right":s.message.senderId===s.currentUserId,"message-id":s.message._id,"emoji-data-source":s.emojiDataSource,onAddEmoji:n.sendMessageReaction,onOpenEmoji:n.openEmoji},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["style","emoji-opened","position-right","message-id","emoji-data-source","onAddEmoji","onOpenEmoji"])])])),[[l,n.closeEmoji]]):Ja("",!0)]),_:3})],4),n.filteredMessageActions.length?(Na(),Ua(Wo,{key:0,name:s.message.senderId===s.currentUserId?"vac-slide-left":"vac-slide-right"},{default:ss(()=>[o.optionsOpened?$s((Na(),$a("div",{key:0,ref:"menuOptions",class:Ue(["vac-menu-options",{"vac-menu-left":s.message.senderId!==s.currentUserId}]),style:He({top:o.menuOptionsTop+"px"})},[Ka("div",sg,[(Na(!0),$a(Oa,null,Ks(n.filteredMessageActions,e=>(Na(),$a("div",{key:e.name},[Ka("div",{class:"vac-menu-item",onClick:t=>n.messageActionHandler(e)},Ve(e.title),9,ag)]))),128))])],6)),[[l,n.closeOptions]]):Ja("",!0)]),_:1},8,["name"])):Ja("",!0)])}]]),MessageReactions:Bn({name:"MessageReactions",props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0}},emits:["send-message-reaction"],methods:{sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t})}}},[["render",function(e,t,s,a,o,n){return s.message.deleted?Ja("",!0):(Na(),Ua(gn,{key:0,name:"vac-slide-left",tag:"span"},{default:ss(()=>[(Na(!0),$a(Oa,null,Ks(s.message.reactions,(e,t)=>$s((Na(),$a("button",{key:t+0,class:Ue(["vac-button-reaction",{"vac-reaction-me":-1!==e.indexOf(s.currentUserId)}]),style:He({float:s.message.senderId===s.currentUserId?"right":"left"}),onClick:s=>n.sendMessageReaction({unicode:t},e)},[Qa(Ve(t),1),Ka("span",null,Ve(e.length),1)],14,og)),[[Mn,e.length]])),128))]),_:1}))}]])},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},index:{type:Number,required:!0},message:{type:Object,required:!0},messages:{type:Array,required:!0},editedMessageId:{type:[String,Number],default:null},roomUsers:{type:Array,default:()=>[]},messageActions:{type:Array,required:!0},newMessages:{type:Array,default:()=>[]},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},usernameOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},selectedMessages:{type:Array,default:()=>[]},emojiDataSource:{type:String,default:void 0}},emits:["message-added","open-file","open-user-tag","open-failed-message","message-action-handler","send-message-reaction","select-message","unselect-message"],data:()=>({hoverMessageId:null,messageHover:!1,optionsOpened:!1,emojiOpened:!1,newMessage:{},progressTime:"- : -",hoverAudioProgress:!1}),computed:{showUsername(){return!(!this.usernameOptions.currentUser&&this.message.senderId===this.currentUserId)&&this.roomUsers.length>=this.usernameOptions.minUsers},showDate(){return this.index>0&&this.message.date!==this.messages[this.index-1].date},messageOffset(){return this.index>0&&this.message.senderId!==this.messages[this.index-1].senderId},isMessageHover(){return this.editedMessageId===this.message._id||this.hoverMessageId===this.message._id},isAudio(){var e;return null==(e=this.message.files)?void 0:e.some(e=>Xl(e))},isCheckmarkVisible(){return this.message.senderId===this.currentUserId&&!this.message.deleted&&(this.message.saved||this.message.distributed||this.message.seen)},hasCurrentUserAvatar(){return this.messages.some(e=>e.senderId===this.currentUserId&&e.avatar)},hasSenderUserAvatar(){return this.messages.some(e=>e.senderId!==this.currentUserId&&e.avatar)},isMessageSelected(){return this.messageSelectionEnabled&&!!this.selectedMessages.find(e=>e._id===this.message._id)}},watch:{newMessages:{immediate:!0,deep:!0,handler(e){e.length&&this.showNewMessagesDivider?this.newMessage=e.reduce((e,t)=>t.index<e.index?t:e):this.newMessage={}}},messageSelectionEnabled(){this.resetMessageHover()}},mounted(){!function(e){if(t=e,![{key:"_id",type:["string","number"]},{key:"senderId",type:["string","number"]}].every(e=>e.type.find(s=>s===typeof t[e.key])&&ng(t,e.key)))throw new Error("Messages object is not valid! Must contain at least _id[String, Number] and senderId[String, Number]");var t}(this.message),this.$emit("message-added",{message:this.message,index:this.index,ref:this.$refs.message})},methods:{onHoverMessage(){this.messageSelectionEnabled||(this.messageHover=!0,this.canEditMessage()&&(this.hoverMessageId=this.message._id))},canEditMessage(){return!this.message.deleted},onLeaveMessage(){this.messageSelectionEnabled||(this.optionsOpened||this.emojiOpened||(this.messageHover=!1),this.hoverMessageId=null)},resetMessageHover(){this.messageHover=!1,this.hoverMessageId=null},openFile(e){this.$emit("open-file",{message:this.message,file:e})},openUserTag(e){this.$emit("open-user-tag",{user:e})},messageActionHandler(e){this.resetMessageHover(),setTimeout(()=>{this.$emit("message-action-handler",{action:e,message:this.message})},300)},sendMessageReaction({emoji:e,reaction:t}){this.$emit("send-message-reaction",{messageId:this.message._id,reaction:e,remove:t&&-1!==t.indexOf(this.currentUserId)}),this.messageHover=!1},selectMessage(){this.messageSelectionEnabled&&(this.isMessageSelected?this.$emit("unselect-message",this.message._id):this.$emit("select-message",this.message))}}},ig=["id"],lg={key:0,class:"vac-card-info vac-card-date"},cg={key:1,class:"vac-line-new"},dg={key:2,class:"vac-card-info vac-card-system"},ug={key:1,class:"vac-avatar-offset"},mg={key:0,class:"vac-progress-time"},pg={class:"vac-text-timestamp"},hg={key:0,class:"vac-icon-edited"},fg={key:1},gg=[Ka("div",{class:"vac-failure-text"},"!",-1)],_g={key:3,class:"vac-avatar-current-offset"};const vg={name:"ChatRoom",components:{Loader:Hn,SvgIcon:Un,RoomHeader:Tc,RoomFooter:kf,RoomMessage:Bn(rg,[["render",function(e,t,s,a,o,n){const r=qs("format-message"),i=qs("message-reply"),l=qs("message-files"),c=qs("audio-player"),d=qs("svg-icon"),u=qs("message-actions"),m=qs("message-reactions");return Na(),$a("div",{id:s.message._id,ref:"message",class:"vac-message-wrapper"},[n.showDate?(Na(),$a("div",lg,Ve(s.message.date),1)):Ja("",!0),o.newMessage._id===s.message._id?(Na(),$a("div",cg,Ve(s.textMessages.NEW_MESSAGES),1)):Ja("",!0),s.message.system?(Na(),$a("div",dg,[Zs(e.$slots,"message_"+s.message._id,{},()=>[Ga(r,{"message-id":s.message._id,content:s.message.content,deleted:!!s.message.deleted,users:s.roomUsers,"text-messages":s.textMessages,"text-formatting":s.textFormatting,"link-options":s.linkOptions,onOpenUserTag:n.openUserTag},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["message-id","content","deleted","users","text-messages","text-formatting","link-options","onOpenUserTag"])])])):(Na(),$a("div",{key:3,class:Ue(["vac-message-box",{"vac-offset-current":s.message.senderId===s.currentUserId}]),onClick:t[8]||(t[8]=(...e)=>n.selectMessage&&n.selectMessage(...e))},[Zs(e.$slots,"message_"+s.message._id,{},()=>[s.message.senderId!==s.currentUserId?Zs(e.$slots,"message-avatar_"+s.message._id,{key:0},()=>[s.message.avatar?(Na(),$a("div",{key:0,class:"vac-avatar",style:He({"background-image":`url('${s.message.avatar}')`})},null,4)):Ja("",!0)]):Ja("",!0),n.hasSenderUserAvatar&&!s.message.avatar?(Na(),$a("div",ug)):Ja("",!0),Ka("div",{class:Ue(["vac-message-container",{"vac-message-container-offset":n.messageOffset}])},[Ka("div",{class:Ue(["vac-message-card",{"vac-message-highlight":n.isMessageHover,"vac-message-current":s.message.senderId===s.currentUserId,"vac-message-deleted":s.message.deleted,"vac-item-clickable":s.messageSelectionEnabled,"vac-message-selected":n.isMessageSelected}]),onMouseover:t[5]||(t[5]=(...e)=>n.onHoverMessage&&n.onHoverMessage(...e)),onMouseleave:t[6]||(t[6]=(...e)=>n.onLeaveMessage&&n.onLeaveMessage(...e))},[n.showUsername?(Na(),$a("div",{key:0,class:Ue(["vac-text-username",{"vac-username-reply":!s.message.deleted&&s.message.replyMessage}])},[Ka("span",null,Ve(s.message.username),1)],2)):Ja("",!0),!s.message.deleted&&s.message.replyMessage?(Na(),Ua(i,{key:1,message:s.message,"room-users":s.roomUsers,"text-formatting":s.textFormatting,"link-options":s.linkOptions},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["message","room-users","text-formatting","link-options"])):Ja("",!0),!s.message.deleted&&s.message.files&&s.message.files.length?!n.isAudio||s.message.files.length>1?(Na(),Ua(l,{key:3,"current-user-id":s.currentUserId,message:s.message,"room-users":s.roomUsers,"text-formatting":s.textFormatting,"link-options":s.linkOptions,"message-selection-enabled":s.messageSelectionEnabled,onOpenFile:n.openFile,onOpenUserTag:n.openUserTag},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["current-user-id","message","room-users","text-formatting","link-options","message-selection-enabled","onOpenFile","onOpenUserTag"])):(Na(),$a(Oa,{key:4},[Ga(c,{"message-id":s.message._id,src:s.message.files[0].url,"message-selection-enabled":s.messageSelectionEnabled,onUpdateProgressTime:t[0]||(t[0]=e=>o.progressTime=e),onHoverAudioProgress:t[1]||(t[1]=e=>o.hoverAudioProgress=e)},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["message-id","src","message-selection-enabled"]),s.message.deleted?Ja("",!0):(Na(),$a("div",mg,Ve(o.progressTime),1))],64)):(Na(),Ua(r,{key:2,"message-id":s.message._id,content:s.message.content,deleted:!!s.message.deleted,users:s.roomUsers,"text-formatting":s.textFormatting,"text-messages":s.textMessages,"link-options":s.linkOptions,onOpenUserTag:n.openUserTag},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["message-id","content","deleted","users","text-formatting","text-messages","link-options","onOpenUserTag"])),Ka("div",pg,[s.message.edited&&!s.message.deleted?(Na(),$a("div",hg,[Zs(e.$slots,"pencil-icon_"+s.message._id,{},()=>[Ga(d,{name:"pencil"})])])):Ja("",!0),Ka("span",null,Ve(s.message.timestamp),1),n.isCheckmarkVisible?(Na(),$a("span",fg,[Zs(e.$slots,"checkmark-icon_"+s.message._id,{},()=>[Ga(d,{name:s.message.distributed?"double-checkmark":"checkmark",param:s.message.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])])])):Ja("",!0)]),Ga(u,{"current-user-id":s.currentUserId,message:s.message,"message-actions":s.messageActions,"show-reaction-emojis":s.showReactionEmojis,"message-hover":o.messageHover,"hover-message-id":o.hoverMessageId,"hover-audio-progress":o.hoverAudioProgress,"emoji-data-source":s.emojiDataSource,onUpdateMessageHover:t[2]||(t[2]=e=>o.messageHover=e),onUpdateOptionsOpened:t[3]||(t[3]=e=>o.optionsOpened=e),onUpdateEmojiOpened:t[4]||(t[4]=e=>o.emojiOpened=e),onMessageActionHandler:n.messageActionHandler,onSendMessageReaction:n.sendMessageReaction},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["current-user-id","message","message-actions","show-reaction-emojis","message-hover","hover-message-id","hover-audio-progress","emoji-data-source","onMessageActionHandler","onSendMessageReaction"])],34),Ga(m,{"current-user-id":s.currentUserId,message:s.message,onSendMessageReaction:n.sendMessageReaction},null,8,["current-user-id","message","onSendMessageReaction"])],2),Zs(e.$slots,"message-failure_"+s.message._id,{},()=>[s.message.failure&&s.message.senderId===s.currentUserId?(Na(),$a("div",{key:0,class:Ue(["vac-failure-container vac-svg-button",{"vac-failure-container-avatar":s.message.avatar&&s.message.senderId===s.currentUserId}]),onClick:t[7]||(t[7]=t=>e.$emit("open-failed-message",{message:s.message}))},gg,2)):Ja("",!0)]),s.message.senderId===s.currentUserId?Zs(e.$slots,"message-avatar_"+s.message._id,{key:2},()=>[s.message.avatar?(Na(),$a("div",{key:0,class:"vac-avatar vac-avatar-current",style:He({"background-image":`url('${s.message.avatar}')`})},null,4)):Ja("",!0)]):Ja("",!0),n.hasCurrentUserAvatar&&!s.message.avatar?(Na(),$a("div",_g)):Ja("",!0)])],2))],8,ig)}]])},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},roomId:{type:[String,Number],required:!0},loadFirstRoom:{type:Boolean,required:!0},messages:{type:Array,required:!0},roomMessage:{type:String,default:null},messagesLoaded:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},messageActions:{type:Array,required:!0},messageSelectionActions:{type:Array,required:!0},autoScroll:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},showEmojis:{type:Boolean,required:!0},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},loadingRooms:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},scrollDistance:{type:Number,required:!0},templatesText:{type:Array,default:null},usernameOptions:{type:Object,required:!0},emojiDataSource:{type:String,default:void 0}},emits:["toggle-rooms-list","room-info","menu-action-handler","message-selection-action-handler","edit-message","send-message","delete-message","message-action-handler","fetch-messages","send-message-reaction","typing-message","open-file","open-user-tag","open-failed-message","textarea-action-handler"],data:()=>({editedMessageId:null,initReplyMessage:null,initEditMessage:null,loadingMessages:!1,observer:null,showLoader:!0,loadingMoreMessages:!1,scrollIcon:!1,scrollMessagesCount:0,newMessages:[],messageSelectionEnabled:!1,selectedMessages:[],droppedFiles:[]}),computed:{room(){return this.rooms.find(e=>e.roomId===this.roomId)||{}},showNoMessages(){return this.roomId&&!this.messages.length&&!this.loadingMessages&&!this.loadingRooms},showNoRoom(){const e=!this.rooms.length&&!this.loadingRooms||!this.roomId&&!this.loadFirstRoom;return e&&this.updateLoadingMessages(!1),e},showMessagesStarted(){return this.messages.length&&this.messagesLoaded}},watch:{roomId:{immediate:!0,handler(){this.onRoomChanged()}},messages:{deep:!0,handler(e,t){e.forEach((e,t)=>{this.showNewMessagesDivider&&!e.seen&&e.senderId!==this.currentUserId&&this.newMessages.push({_id:e._id,index:t})}),(null==t?void 0:t.length)===(null==e?void 0:e.length)-1&&(this.newMessages=[]),setTimeout(()=>this.loadingMoreMessages=!1)}},messagesLoaded(e){e&&this.updateLoadingMessages(!1)}},mounted(){this.newMessages=[]},methods:{updateLoadingMessages(e){this.loadingMessages=e,e||setTimeout(()=>this.initIntersectionObserver())},initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=this.$el.querySelector("#infinite-loader-messages");if(e){const t={root:this.$el.querySelector("#messages-list"),rootMargin:this.scrollDistance+"px",threshold:0};this.observer=new IntersectionObserver(e=>{e[0].isIntersecting&&this.loadMoreMessages()},t),this.observer.observe(e)}},preventTopScroll(){const e=this.$refs.scrollContainer,t=e.scrollHeight,s=new ResizeObserver(a=>{e.scrollHeight!==t&&this.$refs.scrollContainer&&(this.$refs.scrollContainer.scrollTo({top:e.scrollHeight-t}),s.disconnect())});for(var a=0;a<e.children.length;a++)s.observe(e.children[a])},touchStart(e){if(!this.singleRoom&&1===e.changedTouches.length){const t=e.changedTouches[0].clientX,s=e.changedTouches[0].clientY;addEventListener("touchend",e=>this.touchEnd(e,t,s),{once:!0})}},touchEnd(e,t,s){if(1===e.changedTouches.length){const a=e.changedTouches[0].clientX,o=e.changedTouches[0].clientY,n=a-t>100,r=Math.abs(o-s)>50;n&&!r&&this.$emit("toggle-rooms-list")}},onRoomChanged(){this.updateLoadingMessages(!0),this.scrollIcon=!1,this.scrollMessagesCount=0,this.resetMessageSelection();const e=this.$watch(()=>this.messages,t=>{if(!t||!t.length)return;const s=this.$refs.scrollContainer;s&&(e(),setTimeout(()=>{s.scrollTo({top:s.scrollHeight}),this.updateLoadingMessages(!1)}))})},resetMessageSelection(){this.messageSelectionEnabled=!1,this.selectedMessages=[]},selectMessage(e){this.selectedMessages.push(e)},unselectMessage(e){this.selectedMessages=this.selectedMessages.filter(t=>t._id!==e)},onMessageAdded({message:e,index:t,ref:s}){if(t!==this.messages.length-1)return;const a=s.offsetHeight+60;setTimeout(()=>{const t=this.getBottomScroll(this.$refs.scrollContainer)>a;e.senderId===this.currentUserId?t?this.autoScroll.send.newAfterScrollUp&&this.scrollToBottom():this.autoScroll.send.new&&this.scrollToBottom():t?this.autoScroll.receive.newAfterScrollUp?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++):this.autoScroll.receive.new?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++)})},onContainerScroll(e){if(!e.target)return;const t=this.getBottomScroll(e.target);t<60&&(this.scrollMessagesCount=0),this.scrollIcon=t>500||this.scrollMessagesCount},loadMoreMessages(){this.loadingMessages||setTimeout(()=>{if(!this.loadingMoreMessages){if(this.messagesLoaded||!this.roomId)return this.loadingMoreMessages=!1,void(this.showLoader=!1);this.preventTopScroll(),this.$emit("fetch-messages"),this.loadingMoreMessages=!0}},500)},messageActionHandler({action:e,message:t}){switch(e.name){case"replyMessage":return this.initReplyMessage=t,void setTimeout(()=>{this.initReplyMessage=null});case"editMessage":return this.initEditMessage=t,void setTimeout(()=>{this.initEditMessage=null});case"deleteMessage":return this.$emit("delete-message",t);case"selectMessages":return this.selectedMessages=[t],void(this.messageSelectionEnabled=!0);default:return this.$emit("message-action-handler",{action:e,message:t})}},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{action:e,messages:this.selectedMessages}),this.resetMessageSelection()},sendMessageReaction(e){this.$emit("send-message-reaction",e)},getBottomScroll(e){const{scrollHeight:t,clientHeight:s,scrollTop:a}=e;return t-s-a},scrollToBottom(){setTimeout(()=>{const e=this.$refs.scrollContainer;e.classList.add("vac-scroll-smooth"),e.scrollTo({top:e.scrollHeight,behavior:"smooth"}),setTimeout(()=>e.classList.remove("vac-scroll-smooth"))},50)},openFile({message:e,file:t}){this.$emit("open-file",{message:e,file:t})},openUserTag(e){this.$emit("open-user-tag",e)},onDropFiles(e){this.showFiles&&(this.droppedFiles=e.dataTransfer.files)}}},bg={class:"vac-container-center vac-room-empty"},yg={class:"vac-messages-container"},xg={key:0,class:"vac-text-started"},wg={key:1,class:"vac-text-started"},kg={key:0,id:"infinite-loader-messages"},Sg={key:2},Mg={key:0,class:"vac-badge-counter vac-messages-count"};const Ag={key:0,class:"vac-media-preview-container"},Rg={key:1,class:"vac-media-preview-container"},Tg={controls:"",autoplay:""},Eg=["src"],Bg={class:"vac-svg-button"};var Og={ROOMS_EMPTY:"No rooms",ROOM_EMPTY:"No room selected",NEW_MESSAGES:"New Messages",MESSAGE_DELETED:"This message was deleted",MESSAGES_EMPTY:"No messages",CONVERSATION_STARTED:"Conversation started on:",TYPE_MESSAGE:"Type message",SEARCH:"Search",IS_ONLINE:"is online",LAST_SEEN:"last seen ",IS_TYPING:"is writing...",CANCEL_SELECT_MESSAGE:"Cancel"};const Cg={light:{general:{color:"#0a0a0a",colorButtonClear:"#1976d2",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#fff",colorPlaceholder:"#9ca6af",colorCaret:"#1976d2",colorSpinner:"#333",borderStyle:"1px solid #e1e4e8",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#fff",colorRoomName:"#0a0a0a",colorRoomInfo:"#9ca6af"},footer:{background:"#f8f9fa",borderStyleInput:"1px solid #e1e4e8",borderInputSelected:"#1976d2",backgroundReply:"#e5e5e6",backgroundTagActive:"#e5e5e6",backgroundTag:"#f8f9fa"},content:{background:"#f8f9fa"},sidemenu:{background:"#fff",backgroundHover:"#f6f6f6",backgroundActive:"#e5effa",colorActive:"#1976d2",borderColorSearch:"#e1e5e8"},dropdown:{background:"#fff",backgroundHover:"#f6f6f6"},message:{background:"#fff",backgroundMe:"#ccf2cf",color:"#0a0a0a",colorStarted:"#9ca6af",backgroundDeleted:"#dadfe2",backgroundSelected:"#c2dcf2",colorDeleted:"#757e85",colorUsername:"#9ca6af",colorTimestamp:"#828c94",backgroundDate:"#e5effa",colorDate:"#505a62",backgroundSystem:"#e5effa",colorSystem:"#505a62",backgroundMedia:"rgba(0, 0, 0, 0.15)",backgroundReply:"rgba(0, 0, 0, 0.08)",colorReplyUsername:"#0a0a0a",colorReply:"#6e6e6e",colorTag:"#0d579c",backgroundImage:"#ddd",colorNewMessages:"#1976d2",backgroundScrollCounter:"#0696c7",colorScrollCounter:"#fff",backgroundReaction:"#eee",borderStyleReaction:"1px solid #eee",backgroundReactionHover:"#fff",borderStyleReactionHover:"1px solid #ddd",colorReactionCounter:"#0a0a0a",backgroundReactionMe:"#cfecf5",borderStyleReactionMe:"1px solid #3b98b8",backgroundReactionHoverMe:"#cfecf5",borderStyleReactionHoverMe:"1px solid #3b98b8",colorReactionCounterMe:"#0b59b3",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(0, 0, 0, 0.15)",backgroundAudioProgress:"#455247",backgroundAudioProgressSelector:"#455247",colorFileExtension:"#757e85"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#0a0a0a",colorMessage:"#67717a",colorTimestamp:"#a2aeb8",colorStateOnline:"#4caf50",colorStateOffline:"#9ca6af",backgroundCounterBadge:"#0696c7",colorCounterBadge:"#fff"},emoji:{background:"#fff"},icons:{search:"#9ca6af",add:"#1976d2",toggle:"#0a0a0a",menu:"#0a0a0a",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#1976d2",closeOutline:"#000",closePreview:"#fff",send:"#1976d2",sendDisabled:"#9ca6af",emoji:"#1976d2",emojiReaction:"rgba(0, 0, 0, 0.3)",document:"#1976d2",pencil:"#9e9e9e",checkmark:"#9e9e9e",checkmarkSeen:"#0696c7",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#9e9e9e",dropdownScroll:"#0a0a0a",microphone:"#1976d2",audioPlay:"#455247",audioPause:"#455247",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}},dark:{general:{color:"#fff",colorButtonClear:"#fff",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#202223",colorPlaceholder:"#596269",colorCaret:"#fff",colorSpinner:"#fff",borderStyle:"none",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#181a1b",colorRoomName:"#fff",colorRoomInfo:"#9ca6af"},footer:{background:"#131415",borderStyleInput:"none",borderInputSelected:"#1976d2",backgroundReply:"#1b1c1c",backgroundTagActive:"#1b1c1c",backgroundTag:"#131415"},content:{background:"#131415"},sidemenu:{background:"#181a1b",backgroundHover:"#202224",backgroundActive:"#151617",colorActive:"#fff",borderColorSearch:"#181a1b"},dropdown:{background:"#2a2c33",backgroundHover:"#26282e"},message:{background:"#22242a",backgroundMe:"#1f7e80",color:"#fff",colorStarted:"#9ca6af",backgroundDeleted:"#1b1c21",backgroundSelected:"#c2dcf2",colorDeleted:"#a2a5a8",colorUsername:"#b3bac9",colorTimestamp:"#ebedf2",backgroundDate:"rgba(0, 0, 0, 0.3)",colorDate:"#bec5cc",backgroundSystem:"rgba(0, 0, 0, 0.3)",colorSystem:"#bec5cc",backgroundMedia:"rgba(0, 0, 0, 0.18)",backgroundReply:"rgba(0, 0, 0, 0.18)",colorReplyUsername:"#fff",colorReply:"#d6d6d6",colorTag:"#f0c60a",backgroundImage:"#ddd",colorNewMessages:"#fff",backgroundScrollCounter:"#1976d2",colorScrollCounter:"#fff",backgroundReaction:"none",borderStyleReaction:"none",backgroundReactionHover:"#202223",borderStyleReactionHover:"none",colorReactionCounter:"#fff",backgroundReactionMe:"#4e9ad1",borderStyleReactionMe:"none",backgroundReactionHoverMe:"#4e9ad1",borderStyleReactionHoverMe:"none",colorReactionCounterMe:"#fff",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(255, 255, 255, 0.15)",backgroundAudioProgress:"#b7d4d3",backgroundAudioProgressSelector:"#b7d4d3",colorFileExtension:"#a2a5a8"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#fff",colorMessage:"#6c7278",colorTimestamp:"#6c7278",colorStateOnline:"#4caf50",colorStateOffline:"#596269",backgroundCounterBadge:"#1976d2",colorCounterBadge:"#fff"},emoji:{background:"#343740"},icons:{search:"#596269",add:"#fff",toggle:"#fff",menu:"#fff",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#fff",closeOutline:"#fff",closePreview:"#fff",send:"#fff",sendDisabled:"#646a70",emoji:"#fff",emojiReaction:"#fff",document:"#1976d2",pencil:"#ebedf2",checkmark:"#ebedf2",checkmarkSeen:"#f0d90a",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#fff",dropdownScroll:"#0a0a0a",microphone:"#fff",audioPlay:"#b7d4d3",audioPause:"#b7d4d3",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}}};const jg={name:"ChatContainer",components:{RoomsList:pc,Room:Bn(vg,[["render",function(e,t,s,a,o,n){const r=qs("room-header"),i=qs("loader"),l=qs("room-message"),c=qs("svg-icon"),d=qs("room-footer");return $s((Na(),$a("div",{class:"vac-col-messages",onDrop:t[12]||(t[12]=wn((...e)=>n.onDropFiles&&n.onDropFiles(...e),["prevent"])),onDragenter:t[13]||(t[13]=wn(()=>{},["prevent"])),onDragover:t[14]||(t[14]=wn(()=>{},["prevent"])),onDragleave:t[15]||(t[15]=wn(()=>{},["prevent"])),onTouchstart:t[16]||(t[16]=(...e)=>n.touchStart&&n.touchStart(...e))},[n.showNoRoom?Zs(e.$slots,"no-room-selected",{key:0},()=>[Ka("div",bg,[Ka("div",null,Ve(s.textMessages.ROOM_EMPTY),1)])]):(Na(),Ua(r,{key:1,"current-user-id":s.currentUserId,"text-messages":s.textMessages,"single-room":s.singleRoom,"show-rooms-list":s.showRoomsList,"is-mobile":s.isMobile,"room-info-enabled":s.roomInfoEnabled,"menu-actions":s.menuActions,room:n.room,"message-selection-enabled":o.messageSelectionEnabled,"message-selection-actions":s.messageSelectionActions,"selected-messages-total":o.selectedMessages.length,onToggleRoomsList:t[0]||(t[0]=t=>e.$emit("toggle-rooms-list")),onRoomInfo:t[1]||(t[1]=t=>e.$emit("room-info")),onMenuActionHandler:t[2]||(t[2]=t=>e.$emit("menu-action-handler",t)),onMessageSelectionActionHandler:n.messageSelectionActionHandler,onCancelMessageSelection:t[3]||(t[3]=e=>o.messageSelectionEnabled=!1)},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["current-user-id","text-messages","single-room","show-rooms-list","is-mobile","room-info-enabled","menu-actions","room","message-selection-enabled","message-selection-actions","selected-messages-total","onMessageSelectionActionHandler"])),Ka("div",{id:"messages-list",ref:"scrollContainer",class:"vac-container-scroll",onScroll:t[5]||(t[5]=(...e)=>n.onContainerScroll&&n.onContainerScroll(...e))},[Ga(i,{show:o.loadingMessages,type:"messages"},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["show"]),Ka("div",yg,[Ka("div",{class:Ue({"vac-messages-hidden":o.loadingMessages})},[Ga(Wo,{name:"vac-fade-message"},{default:ss(()=>[Ka("div",null,[n.showNoMessages?(Na(),$a("div",xg,[Zs(e.$slots,"messages-empty",{},()=>[Qa(Ve(s.textMessages.MESSAGES_EMPTY),1)])])):Ja("",!0),n.showMessagesStarted?(Na(),$a("div",wg,Ve(s.textMessages.CONVERSATION_STARTED)+" "+Ve(s.messages[0].date),1)):Ja("",!0)])]),_:3}),s.messages.length&&!s.messagesLoaded?(Na(),$a("div",kg,[Ga(i,{show:!0,infinite:!0,type:"infinite-messages"},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1024)])):Ja("",!0),(Na(),Ua(gn,{key:s.roomId,name:"vac-fade-message",tag:"span"},{default:ss(()=>[(Na(!0),$a(Oa,null,Ks(s.messages,(a,r)=>(Na(),$a("div",{key:a.indexId||a._id},[Ga(l,{"current-user-id":s.currentUserId,message:a,index:r,messages:s.messages,"edited-message-id":o.editedMessageId,"message-actions":s.messageActions,"room-users":n.room.users,"text-messages":s.textMessages,"new-messages":o.newMessages,"show-reaction-emojis":s.showReactionEmojis,"show-new-messages-divider":s.showNewMessagesDivider,"text-formatting":s.textFormatting,"link-options":s.linkOptions,"username-options":s.usernameOptions,"message-selection-enabled":o.messageSelectionEnabled,"selected-messages":o.selectedMessages,"emoji-data-source":s.emojiDataSource,onMessageAdded:n.onMessageAdded,onMessageActionHandler:n.messageActionHandler,onOpenFile:n.openFile,onOpenUserTag:n.openUserTag,onOpenFailedMessage:t[4]||(t[4]=t=>e.$emit("open-failed-message",t)),onSendMessageReaction:n.sendMessageReaction,onSelectMessage:n.selectMessage,onUnselectMessage:n.unselectMessage},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["current-user-id","message","index","messages","edited-message-id","message-actions","room-users","text-messages","new-messages","show-reaction-emojis","show-new-messages-divider","text-formatting","link-options","username-options","message-selection-enabled","selected-messages","emoji-data-source","onMessageAdded","onMessageActionHandler","onOpenFile","onOpenUserTag","onSendMessageReaction","onSelectMessage","onUnselectMessage"])]))),128))]),_:3}))],2)])],544),o.loadingMessages?Ja("",!0):(Na(),$a("div",Sg,[Ga(Wo,{name:"vac-bounce"},{default:ss(()=>[o.scrollIcon?(Na(),$a("div",{key:0,class:"vac-icon-scroll",onClick:t[6]||(t[6]=(...e)=>n.scrollToBottom&&n.scrollToBottom(...e))},[Ga(Wo,{name:"vac-bounce"},{default:ss(()=>[o.scrollMessagesCount?(Na(),$a("div",Mg,Ve(o.scrollMessagesCount),1)):Ja("",!0)]),_:1}),Zs(e.$slots,"scroll-icon",{},()=>[Ga(c,{name:"dropdown",param:"scroll"})])])):Ja("",!0)]),_:3})])),Ga(d,{room:n.room,"room-id":s.roomId,"room-message":s.roomMessage,"text-messages":s.textMessages,"show-send-icon":s.showSendIcon,"show-files":s.showFiles,"show-audio":s.showAudio,"show-emojis":s.showEmojis,"show-footer":s.showFooter,"accepted-files":s.acceptedFiles,"textarea-action-enabled":s.textareaActionEnabled,"textarea-auto-focus":s.textareaAutoFocus,"user-tags-enabled":s.userTagsEnabled,"emojis-suggestion-enabled":s.emojisSuggestionEnabled,"templates-text":s.templatesText,"text-formatting":s.textFormatting,"link-options":s.linkOptions,"audio-bit-rate":s.audioBitRate,"audio-sample-rate":s.audioSampleRate,"init-reply-message":o.initReplyMessage,"init-edit-message":o.initEditMessage,"dropped-files":o.droppedFiles,"emoji-data-source":s.emojiDataSource,onUpdateEditedMessageId:t[7]||(t[7]=e=>o.editedMessageId=e),onEditMessage:t[8]||(t[8]=t=>e.$emit("edit-message",t)),onSendMessage:t[9]||(t[9]=t=>e.$emit("send-message",t)),onTypingMessage:t[10]||(t[10]=t=>e.$emit("typing-message",t)),onTextareaActionHandler:t[11]||(t[11]=t=>e.$emit("textarea-action-handler",t))},Gs({_:2},[Ks(e.$slots,(t,s)=>({name:s,fn:ss(t=>[Zs(e.$slots,s,qe(Za(t)))])}))]),1032,["room","room-id","room-message","text-messages","show-send-icon","show-files","show-audio","show-emojis","show-footer","accepted-files","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","templates-text","text-formatting","link-options","audio-bit-rate","audio-sample-rate","init-reply-message","init-edit-message","dropped-files","emoji-data-source"])],544)),[[Mn,s.isMobile&&!s.showRoomsList||!s.isMobile||s.singleRoom]])}]]),MediaPreview:Bn({name:"MediaPreview",components:{SvgIcon:Un},props:{file:{type:Object,required:!0}},emits:["close-media-preview"],computed:{isImage(){return ql(this.file)},isVideo(){return Vl(this.file)}},mounted(){this.$refs.modal.focus()},methods:{closeModal(){this.$emit("close-media-preview")}}},[["render",function(e,t,s,a,o,n){const r=qs("svg-icon");return Na(),$a("div",{ref:"modal",tabindex:"0",class:"vac-media-preview",onClick:t[0]||(t[0]=wn((...e)=>n.closeModal&&n.closeModal(...e),["stop"])),onKeydown:t[1]||(t[1]=Sn((...e)=>n.closeModal&&n.closeModal(...e),["esc"]))},[Ga(Wo,{name:"vac-bounce-preview",appear:""},{default:ss(()=>[n.isImage?(Na(),$a("div",Ag,[Ka("div",{class:"vac-image-preview",style:He({"background-image":`url('${s.file.url}')`})},null,4)])):n.isVideo?(Na(),$a("div",Rg,[Ka("video",Tg,[Ka("source",{src:s.file.url},null,8,Eg)])])):Ja("",!0)]),_:1}),Ka("div",Bg,[Zs(e.$slots,"preview-close-icon",{},()=>[Ga(r,{name:"close-outline",param:"preview"})])])],544)}]])},props:{height:{type:String,default:"600px"},theme:{type:String,default:"light"},styles:{type:[Object,String],default:()=>({})},responsiveBreakpoint:{type:Number,default:900},singleRoom:{type:[Boolean,String],default:!1},roomsListOpened:{type:[Boolean,String],default:!0},textMessages:{type:[Object,String],default:()=>({})},currentUserId:{type:String,default:""},rooms:{type:[Array,String],default:()=>[]},roomsOrder:{type:String,default:"desc"},loadingRooms:{type:[Boolean,String],default:!1},roomsLoaded:{type:[Boolean,String],default:!1},roomId:{type:String,default:null},loadFirstRoom:{type:[Boolean,String],default:!0},messages:{type:[Array,String],default:()=>[]},messagesLoaded:{type:[Boolean,String],default:!1},roomActions:{type:[Array,String],default:()=>[]},menuActions:{type:[Array,String],default:()=>[]},messageActions:{type:[Array,String],default:()=>[{name:"replyMessage",title:"Reply"},{name:"editMessage",title:"Edit Message",onlyMe:!0},{name:"deleteMessage",title:"Delete Message",onlyMe:!0},{name:"selectMessages",title:"Select"}]},messageSelectionActions:{type:[Array,String],default:()=>[]},autoScroll:{type:[Object,String],default:()=>({send:{new:!0,newAfterScrollUp:!0},receive:{new:!0,newAfterScrollUp:!1}})},customSearchRoomEnabled:{type:[Boolean,String],default:!1},showSearch:{type:[Boolean,String],default:!0},showAddRoom:{type:[Boolean,String],default:!0},showSendIcon:{type:[Boolean,String],default:!0},showFiles:{type:[Boolean,String],default:!0},showAudio:{type:[Boolean,String],default:!0},audioBitRate:{type:Number,default:128},audioSampleRate:{type:Number,default:44100},showEmojis:{type:[Boolean,String],default:!0},showReactionEmojis:{type:[Boolean,String],default:!0},showNewMessagesDivider:{type:[Boolean,String],default:!0},showFooter:{type:[Boolean,String],default:!0},textFormatting:{type:[Object,String],default:()=>({disabled:!1,italic:"_",bold:"*",strike:"~",underline:"°",multilineCode:"```",inlineCode:"`"})},linkOptions:{type:[Object,String],default:()=>({disabled:!1,target:"_blank",rel:null})},roomInfoEnabled:{type:[Boolean,String],default:!1},textareaActionEnabled:{type:[Boolean,String],default:!1},textareaAutoFocus:{type:[Boolean,String],default:!0},userTagsEnabled:{type:[Boolean,String],default:!0},emojisSuggestionEnabled:{type:[Boolean,String],default:!0},roomMessage:{type:String,default:""},scrollDistance:{type:Number,default:60},acceptedFiles:{type:String,default:"*"},templatesText:{type:[Array,String],default:()=>[]},mediaPreviewEnabled:{type:[Boolean,String],default:!0},usernameOptions:{type:[Object,String],default:()=>({minUsers:3,currentUser:!1})},emojiDataSource:{type:String,default:void 0}},emits:["toggle-rooms-list","room-info","fetch-messages","send-message","edit-message","delete-message","open-file","open-user-tag","open-failed-message","menu-action-handler","message-action-handler","send-message-reaction","typing-message","textarea-action-handler","fetch-more-rooms","add-room","search-room","room-action-handler","message-selection-action-handler"],data:()=>({slots:[],room:{},loadingMoreRooms:!1,showRoomsList:!0,isMobile:!1,showMediaPreview:!1,previewFile:{}}),computed:{t(){return{...Og,...this.textMessagesCasted}},cssVars(){const e=Cg[this.theme],t={};return Object.keys(e).map(s=>{t[s]={...e[s],...this.stylesCasted[s]||{}}}),(({general:e,container:t,header:s,footer:a,sidemenu:o,content:n,dropdown:r,message:i,markdown:l,room:c,emoji:d,icons:u})=>({"--chat-color":e.color,"--chat-color-button-clear":e.colorButtonClear,"--chat-color-button":e.colorButton,"--chat-bg-color-button":e.backgroundColorButton,"--chat-bg-color-input":e.backgroundInput,"--chat-color-spinner":e.colorSpinner,"--chat-color-placeholder":e.colorPlaceholder,"--chat-color-caret":e.colorCaret,"--chat-border-style":e.borderStyle,"--chat-bg-scroll-icon":e.backgroundScrollIcon,"--chat-container-border":t.border,"--chat-container-border-radius":t.borderRadius,"--chat-container-box-shadow":t.boxShadow,"--chat-header-bg-color":s.background,"--chat-header-color-name":s.colorRoomName,"--chat-header-color-info":s.colorRoomInfo,"--chat-footer-bg-color":a.background,"--chat-border-style-input":a.borderStyleInput,"--chat-border-color-input-selected":a.borderInputSelected,"--chat-footer-bg-color-reply":a.backgroundReply,"--chat-footer-bg-color-tag-active":a.backgroundTagActive,"--chat-footer-bg-color-tag":a.backgroundTag,"--chat-content-bg-color":n.background,"--chat-sidemenu-bg-color":o.background,"--chat-sidemenu-bg-color-hover":o.backgroundHover,"--chat-sidemenu-bg-color-active":o.backgroundActive,"--chat-sidemenu-color-active":o.colorActive,"--chat-sidemenu-border-color-search":o.borderColorSearch,"--chat-dropdown-bg-color":r.background,"--chat-dropdown-bg-color-hover":r.backgroundHover,"--chat-message-bg-color":i.background,"--chat-message-bg-color-me":i.backgroundMe,"--chat-message-color-started":i.colorStarted,"--chat-message-bg-color-deleted":i.backgroundDeleted,"--chat-message-bg-color-selected":i.backgroundSelected,"--chat-message-color-deleted":i.colorDeleted,"--chat-message-color-username":i.colorUsername,"--chat-message-color-timestamp":i.colorTimestamp,"--chat-message-bg-color-date":i.backgroundDate,"--chat-message-color-date":i.colorDate,"--chat-message-bg-color-system":i.backgroundSystem,"--chat-message-color-system":i.colorSystem,"--chat-message-color":i.color,"--chat-message-bg-color-media":i.backgroundMedia,"--chat-message-bg-color-reply":i.backgroundReply,"--chat-message-color-reply-username":i.colorReplyUsername,"--chat-message-color-reply-content":i.colorReply,"--chat-message-color-tag":i.colorTag,"--chat-message-bg-color-image":i.backgroundImage,"--chat-message-color-new-messages":i.colorNewMessages,"--chat-message-bg-color-scroll-counter":i.backgroundScrollCounter,"--chat-message-color-scroll-counter":i.colorScrollCounter,"--chat-message-bg-color-reaction":i.backgroundReaction,"--chat-message-border-style-reaction":i.borderStyleReaction,"--chat-message-bg-color-reaction-hover":i.backgroundReactionHover,"--chat-message-border-style-reaction-hover":i.borderStyleReactionHover,"--chat-message-color-reaction-counter":i.colorReactionCounter,"--chat-message-bg-color-reaction-me":i.backgroundReactionMe,"--chat-message-border-style-reaction-me":i.borderStyleReactionMe,"--chat-message-bg-color-reaction-hover-me":i.backgroundReactionHoverMe,"--chat-message-border-style-reaction-hover-me":i.borderStyleReactionHoverMe,"--chat-message-color-reaction-counter-me":i.colorReactionCounterMe,"--chat-message-bg-color-audio-record":i.backgroundAudioRecord,"--chat-message-bg-color-audio-line":i.backgroundAudioLine,"--chat-message-bg-color-audio-progress":i.backgroundAudioProgress,"--chat-message-bg-color-audio-progress-selector":i.backgroundAudioProgressSelector,"--chat-message-color-file-extension":i.colorFileExtension,"--chat-markdown-bg":l.background,"--chat-markdown-border":l.border,"--chat-markdown-color":l.color,"--chat-markdown-color-multi":l.colorMulti,"--chat-room-color-username":c.colorUsername,"--chat-room-color-message":c.colorMessage,"--chat-room-color-timestamp":c.colorTimestamp,"--chat-room-color-online":c.colorStateOnline,"--chat-room-color-offline":c.colorStateOffline,"--chat-room-bg-color-badge":c.backgroundCounterBadge,"--chat-room-color-badge":c.colorCounterBadge,"--chat-emoji-bg-color":d.background,"--chat-icon-color-search":u.search,"--chat-icon-color-add":u.add,"--chat-icon-color-toggle":u.toggle,"--chat-icon-color-menu":u.menu,"--chat-icon-color-close":u.close,"--chat-icon-color-close-image":u.closeImage,"--chat-icon-color-file":u.file,"--chat-icon-color-paperclip":u.paperclip,"--chat-icon-color-close-outline":u.closeOutline,"--chat-icon-color-close-preview":u.closePreview,"--chat-icon-color-send":u.send,"--chat-icon-color-send-disabled":u.sendDisabled,"--chat-icon-color-emoji":u.emoji,"--chat-icon-color-emoji-reaction":u.emojiReaction,"--chat-icon-color-document":u.document,"--chat-icon-color-pencil":u.pencil,"--chat-icon-color-checkmark":u.checkmark,"--chat-icon-color-checkmark-seen":u.checkmarkSeen,"--chat-icon-color-eye":u.eye,"--chat-icon-color-dropdown-message":u.dropdownMessage,"--chat-icon-bg-dropdown-message":u.dropdownMessageBackground,"--chat-icon-color-dropdown-room":u.dropdownRoom,"--chat-icon-color-dropdown-scroll":u.dropdownScroll,"--chat-icon-color-microphone":u.microphone,"--chat-icon-color-audio-play":u.audioPlay,"--chat-icon-color-audio-pause":u.audioPause,"--chat-icon-color-audio-cancel":u.audioCancel,"--chat-icon-color-audio-confirm":u.audioConfirm}))(t)},orderedRooms(){return this.roomsCasted.slice().sort((e,t)=>{const s=e.index||0,a=t.index||0;return"asc"===this.roomsOrder?s<a?-1:a<s?1:0:s>a?-1:a>s?1:0})},singleRoomCasted(){return this.castBoolean(this.singleRoom)},roomsListOpenedCasted(){return this.castBoolean(this.roomsListOpened)},loadingRoomsCasted(){return this.castBoolean(this.loadingRooms)},roomsLoadedCasted(){return this.castBoolean(this.roomsLoaded)},loadFirstRoomCasted(){return this.castBoolean(this.loadFirstRoom)},messagesLoadedCasted(){return this.castBoolean(this.messagesLoaded)},showSearchCasted(){return this.castBoolean(this.showSearch)},showAddRoomCasted(){return this.castBoolean(this.showAddRoom)},showSendIconCasted(){return this.castBoolean(this.showSendIcon)},showFilesCasted(){return this.castBoolean(this.showFiles)},showAudioCasted(){return this.castBoolean(this.showAudio)},showEmojisCasted(){return this.castBoolean(this.showEmojis)},showReactionEmojisCasted(){return this.castBoolean(this.showReactionEmojis)},showNewMessagesDividerCasted(){return this.castBoolean(this.showNewMessagesDivider)},showFooterCasted(){return this.castBoolean(this.showFooter)},roomInfoEnabledCasted(){return this.castBoolean(this.roomInfoEnabled)},textareaActionEnabledCasted(){return this.castBoolean(this.textareaActionEnabled)},textareaAutoFocusCasted(){return this.castBoolean(this.textareaAutoFocus)},userTagsEnabledCasted(){return this.castBoolean(this.userTagsEnabled)},emojisSuggestionEnabledCasted(){return this.castBoolean(this.emojisSuggestionEnabled)},mediaPreviewEnabledCasted(){return this.castBoolean(this.mediaPreviewEnabled)},roomsCasted(){return this.castArray(this.rooms)},messagesCasted(){return this.castArray(this.messages)},roomActionsCasted(){return this.castArray(this.roomActions)},menuActionsCasted(){return this.castArray(this.menuActions)},messageActionsCasted(){return this.castArray(this.messageActions)},messageSelectionActionsCasted(){return this.castArray(this.messageSelectionActions)},templatesTextCasted(){return this.castArray(this.templatesText)},stylesCasted(){return this.castObject(this.styles)},textMessagesCasted(){return this.castObject(this.textMessages)},autoScrollCasted(){return this.castObject(this.autoScroll)},textFormattingCasted(){return this.castObject(this.textFormatting)},linkOptionsCasted(){return this.castObject(this.linkOptions)},usernameOptionsCasted(){return this.castObject(this.usernameOptions)}},watch:{roomsCasted:{immediate:!0,deep:!0,handler(e,t){if(e[0]&&e.find(e=>e.roomId===this.room.roomId)||(this.showRoomsList=!0),!this.loadingMoreRooms&&this.loadFirstRoomCasted&&e[0]&&(!t||e.length!==t.length))if(this.roomId){const t=e.find(e=>e.roomId===this.roomId)||{};this.fetchRoom({room:t})}else!this.isMobile||this.singleRoomCasted?this.fetchRoom({room:this.orderedRooms[0]}):this.showRoomsList=!0}},loadingRoomsCasted(e){e&&(this.room={})},roomId:{immediate:!0,handler(e,t){if(e&&!this.loadingRoomsCasted&&this.roomsCasted.length){const t=this.roomsCasted.find(t=>t.roomId===e);this.fetchRoom({room:t})}else t&&!e&&(this.room={})}},room(e){e&&0!==Object.entries(e).length&&(!function(e){if(t=e,![{key:"roomId",type:["string","number"]},{key:"roomName",type:["string"]},{key:"users",type:["array"]}].every(e=>{let s=!1;return("array"===e.type[0]&&Array.isArray(t[e.key])||e.type.find(s=>s===typeof t[e.key]))&&(s=!0),s&&ng(t,e.key)}))throw new Error("Rooms object is not valid! Must contain at least roomId[String, Number], roomName[String] and users[Array]");var t}(e),e.users.forEach(e=>{!function(e){if(t=e,![{key:"_id",type:["string","number"]},{key:"username",type:["string"]}].every(e=>e.type.find(s=>s===typeof t[e.key])&&ng(t,e.key)))throw new Error("Participants object is not valid! Must contain at least _id[String, Number] and username[String]");var t}(e)}))},roomsListOpenedCasted:{immediate:!0,handler(e){this.showRoomsList=e}}},created(){this.updateResponsive(),window.addEventListener("resize",e=>{e.isTrusted&&this.updateResponsive()})},updated(){const e=document.querySelectorAll("[slot]");this.slots.length!==e.length&&(this.slots=e)},methods:{castBoolean:e=>"true"===e||!0===e,castArray:e=>e?Array.isArray(e)?e:JSON.parse(e):[],castObject:e=>e?"object"==typeof e?e:JSON.parse(e):{},updateResponsive(){this.isMobile=window.innerWidth<Number(this.responsiveBreakpoint)},toggleRoomsList(){this.showRoomsList=!this.showRoomsList,this.isMobile&&(this.room={}),this.$emit("toggle-rooms-list",{opened:this.showRoomsList})},fetchRoom({room:e}){this.room=e,this.fetchMessages({reset:!0}),this.isMobile&&(this.showRoomsList=!1)},fetchMoreRooms(){this.$emit("fetch-more-rooms")},roomInfo(){this.$emit("room-info",this.room)},addRoom(){this.$emit("add-room")},searchRoom(e){this.$emit("search-room",{value:e,roomId:this.room.roomId})},fetchMessages(e){this.$emit("fetch-messages",{room:this.room,options:e})},sendMessage(e){this.$emit("send-message",{...e,roomId:this.room.roomId})},editMessage(e){this.$emit("edit-message",{...e,roomId:this.room.roomId})},deleteMessage(e){this.$emit("delete-message",{message:e,roomId:this.room.roomId})},openFile({message:e,file:t}){this.mediaPreviewEnabledCasted&&"preview"===t.action?(this.previewFile=t.file,this.showMediaPreview=!0):this.$emit("open-file",{message:e,file:t})},openUserTag({user:e}){this.$emit("open-user-tag",{user:e})},openFailedMessage({message:e}){this.$emit("open-failed-message",{message:e,roomId:this.room.roomId})},menuActionHandler(e){this.$emit("menu-action-handler",{action:e,roomId:this.room.roomId})},roomActionHandler({action:e,roomId:t}){this.$emit("room-action-handler",{action:e,roomId:t})},messageActionHandler(e){this.$emit("message-action-handler",{...e,roomId:this.room.roomId})},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{...e,roomId:this.room.roomId})},sendMessageReaction(e){this.$emit("send-message-reaction",{...e,roomId:this.room.roomId})},typingMessage(e){this.$emit("typing-message",{message:e,roomId:this.room.roomId})},textareaActionHandler(e){this.$emit("textarea-action-handler",{message:e,roomId:this.room.roomId})}}},Ig={class:"vac-chat-container"};const Lg=function(e,t){const s=function(e){return rt(e)?{setup:e,name:e.name}:e}(e);class a extends Zo{constructor(e){super(s,e,t)}}return a.def=s,a}(Bn(jg,[["render",function(e,t,s,a,o,n){const r=qs("rooms-list"),i=qs("room"),l=qs("media-preview");return Na(),$a("div",{class:"vac-card-window",style:He([{height:s.height},n.cssVars])},[Ka("div",Ig,[n.singleRoomCasted?Ja("",!0):(Na(),Ua(r,{key:0,"current-user-id":s.currentUserId,rooms:n.orderedRooms,"loading-rooms":n.loadingRoomsCasted,"rooms-loaded":n.roomsLoadedCasted,room:o.room,"room-actions":n.roomActionsCasted,"custom-search-room-enabled":s.customSearchRoomEnabled,"text-messages":n.t,"show-search":n.showSearchCasted,"show-add-room":n.showAddRoomCasted,"show-rooms-list":o.showRoomsList&&n.roomsListOpenedCasted,"text-formatting":n.textFormattingCasted,"link-options":n.linkOptionsCasted,"is-mobile":o.isMobile,"scroll-distance":s.scrollDistance,onFetchRoom:n.fetchRoom,onFetchMoreRooms:n.fetchMoreRooms,onLoadingMoreRooms:t[0]||(t[0]=e=>o.loadingMoreRooms=e),onAddRoom:n.addRoom,onSearchRoom:n.searchRoom,onRoomActionHandler:n.roomActionHandler},Gs({_:2},[Ks(o.slots,t=>({name:t.slot,fn:ss(s=>[Zs(e.$slots,t.slot,qe(Za(s)))])}))]),1032,["current-user-id","rooms","loading-rooms","rooms-loaded","room","room-actions","custom-search-room-enabled","text-messages","show-search","show-add-room","show-rooms-list","text-formatting","link-options","is-mobile","scroll-distance","onFetchRoom","onFetchMoreRooms","onAddRoom","onSearchRoom","onRoomActionHandler"])),Ga(i,{"current-user-id":s.currentUserId,rooms:n.roomsCasted,"room-id":o.room.roomId||"","load-first-room":n.loadFirstRoomCasted,messages:n.messagesCasted,"room-message":s.roomMessage,"messages-loaded":n.messagesLoadedCasted,"menu-actions":n.menuActionsCasted,"message-actions":n.messageActionsCasted,"message-selection-actions":n.messageSelectionActionsCasted,"auto-scroll":n.autoScrollCasted,"show-send-icon":n.showSendIconCasted,"show-files":n.showFilesCasted,"show-audio":n.showAudioCasted,"audio-bit-rate":s.audioBitRate,"audio-sample-rate":s.audioSampleRate,"show-emojis":n.showEmojisCasted,"show-reaction-emojis":n.showReactionEmojisCasted,"show-new-messages-divider":n.showNewMessagesDividerCasted,"show-footer":n.showFooterCasted,"text-messages":n.t,"single-room":n.singleRoomCasted,"show-rooms-list":o.showRoomsList&&n.roomsListOpenedCasted,"text-formatting":n.textFormattingCasted,"link-options":n.linkOptionsCasted,"is-mobile":o.isMobile,"loading-rooms":n.loadingRoomsCasted,"room-info-enabled":n.roomInfoEnabledCasted,"textarea-action-enabled":n.textareaActionEnabledCasted,"textarea-auto-focus":n.textareaAutoFocusCasted,"user-tags-enabled":n.userTagsEnabledCasted,"emojis-suggestion-enabled":n.emojisSuggestionEnabledCasted,"scroll-distance":s.scrollDistance,"accepted-files":s.acceptedFiles,"templates-text":n.templatesTextCasted,"username-options":n.usernameOptionsCasted,"emoji-data-source":s.emojiDataSource,onToggleRoomsList:n.toggleRoomsList,onRoomInfo:n.roomInfo,onFetchMessages:n.fetchMessages,onSendMessage:n.sendMessage,onEditMessage:n.editMessage,onDeleteMessage:n.deleteMessage,onOpenFile:n.openFile,onOpenUserTag:n.openUserTag,onOpenFailedMessage:n.openFailedMessage,onMenuActionHandler:n.menuActionHandler,onMessageActionHandler:n.messageActionHandler,onMessageSelectionActionHandler:n.messageSelectionActionHandler,onSendMessageReaction:n.sendMessageReaction,onTypingMessage:n.typingMessage,onTextareaActionHandler:n.textareaActionHandler},Gs({_:2},[Ks(o.slots,t=>({name:t.slot,fn:ss(s=>[Zs(e.$slots,t.slot,qe(Za(s)))])}))]),1032,["current-user-id","rooms","room-id","load-first-room","messages","room-message","messages-loaded","menu-actions","message-actions","message-selection-actions","auto-scroll","show-send-icon","show-files","show-audio","audio-bit-rate","audio-sample-rate","show-emojis","show-reaction-emojis","show-new-messages-divider","show-footer","text-messages","single-room","show-rooms-list","text-formatting","link-options","is-mobile","loading-rooms","room-info-enabled","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","scroll-distance","accepted-files","templates-text","username-options","emoji-data-source","onToggleRoomsList","onRoomInfo","onFetchMessages","onSendMessage","onEditMessage","onDeleteMessage","onOpenFile","onOpenUserTag","onOpenFailedMessage","onMenuActionHandler","onMessageActionHandler","onMessageSelectionActionHandler","onSendMessageReaction","onTypingMessage","onTextareaActionHandler"])]),Ga(Wo,{name:"vac-fade-preview",appear:""},{default:ss(()=>[o.showMediaPreview?(Na(),Ua(l,{key:0,file:o.previewFile,onCloseMediaPreview:t[1]||(t[1]=e=>o.showMediaPreview=!1)},Gs({_:2},[Ks(o.slots,t=>({name:t.slot,fn:ss(s=>[Zs(e.$slots,t.slot,qe(Za(s)))])}))]),1032,["file"])):Ja("",!0)]),_:3})],4)}],["styles",['.vac-fade-spinner-enter-from{opacity:0}.vac-fade-spinner-enter-active{transition:opacity .8s}.vac-fade-spinner-leave-active{transition:opacity .2s;opacity:0}.vac-fade-image-enter-from{opacity:0}.vac-fade-image-enter-active{transition:opacity 1s}.vac-fade-image-leave-active{transition:opacity .5s;opacity:0}.vac-fade-message-enter-from{opacity:0}.vac-fade-message-enter-active{transition:opacity .5s}.vac-fade-message-leave-active{transition:opacity .2s;opacity:0}.vac-slide-left-enter-active,.vac-slide-right-enter-active{transition:all .3s ease;transition-property:transform,opacity}.vac-slide-left-leave-active,.vac-slide-right-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)!important;transition-property:transform,opacity}.vac-slide-left-enter-from,.vac-slide-left-leave-to{transform:translate(10px);opacity:0}.vac-slide-right-enter-from,.vac-slide-right-leave-to{transform:translate(-10px);opacity:0}.vac-slide-up-enter-active{transition:all .3s ease}.vac-slide-up-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)}.vac-slide-up-enter-from,.vac-slide-up-leave-to{transform:translateY(10px);opacity:0}.vac-bounce-enter-active{animation:vac-bounce-in .5s}.vac-bounce-leave-active{animation:vac-bounce-in .3s reverse}@keyframes vac-bounce-in{0%{transform:scale(0)}50%{transform:scale(1.05)}to{transform:scale(1)}}.vac-fade-preview-enter{opacity:0}.vac-fade-preview-enter-active{transition:opacity .1s}.vac-fade-preview-leave-active{transition:opacity .2s;opacity:0}.vac-bounce-preview-enter-active{animation:vac-bounce-image-in .4s}.vac-bounce-preview-leave-active{animation:vac-bounce-image-in .3s reverse}@keyframes vac-bounce-image-in{0%{transform:scale(.6)}to{transform:scale(1)}}.vac-menu-list{border-radius:4px;display:block;cursor:pointer;background:var(--chat-dropdown-bg-color);padding:6px 0}.vac-menu-list :hover{background:var(--chat-dropdown-bg-color-hover);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-list :not(:hover){transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-item{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 100%;flex:1 1 100%;min-height:30px;padding:5px 16px;position:relative;white-space:nowrap;line-height:30px}.vac-menu-options{position:absolute;right:10px;top:20px;z-index:9999;min-width:150px;display:inline-block;border-radius:4px;font-size:14px;color:var(--chat-color);overflow-y:auto;overflow-x:hidden;contain:content;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-app-border{border:var(--chat-border-style)}.vac-app-border-t{border-top:var(--chat-border-style)}.vac-app-border-r{border-right:var(--chat-border-style)}.vac-app-border-b{border-bottom:var(--chat-border-style)}.vac-app-box-shadow{transition:all .5s;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-item-clickable{cursor:pointer}.vac-vertical-center{display:flex;align-items:center;height:100%}.vac-vertical-center .vac-vertical-container{width:100%;text-align:center}.vac-svg-button{max-height:30px;display:flex;cursor:pointer;transition:all .2s}.vac-svg-button:hover{transform:scale(1.1);opacity:.7}.vac-avatar{background-size:cover;background-position:center center;background-repeat:no-repeat;background-color:#ddd;height:42px;width:42px;min-height:42px;min-width:42px;margin-right:15px;border-radius:50%}.vac-blur-loading{filter:blur(3px)}.vac-badge-counter{height:13px;width:auto;min-width:13px;border-radius:50%;display:flex;align-items:center;justify-content:center;padding:3px;font-size:11px;font-weight:500}.vac-text-ellipsis{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-text-bold{font-weight:700}.vac-text-italic{font-style:italic}.vac-text-strike{text-decoration:line-through}.vac-text-underline{text-decoration:underline}.vac-text-inline-code{display:inline-block;font-size:12px;color:var(--chat-markdown-color);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:2px 0;padding:2px 3px}.vac-text-multiline-code{display:block;font-size:12px;color:var(--chat-markdown-color-multi);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:4px 0;padding:7px}.vac-text-tag{color:var(--chat-message-color-tag);cursor:pointer}.vac-file-container{display:flex;align-content:center;justify-content:center;flex-wrap:wrap;text-align:center;background:var(--chat-bg-color-input);border:var(--chat-border-style-input);border-radius:4px;padding:10px}.vac-file-container svg{height:28px;width:28px}.vac-file-container .vac-text-extension{font-size:12px;color:var(--chat-message-color-file-extension);margin-top:-2px}.vac-card-window{width:100%;display:block;max-width:100%;background:var(--chat-content-bg-color);color:var(--chat-color);overflow-wrap:break-word;white-space:normal;border:var(--chat-container-border);border-radius:var(--chat-container-border-radius);box-shadow:var(--chat-container-box-shadow);-webkit-tap-highlight-color:transparent}.vac-card-window *{font-family:inherit}.vac-card-window a{color:#0d579c;font-weight:500}.vac-card-window .vac-chat-container{height:100%;display:flex}.vac-card-window .vac-chat-container input{min-width:10px}.vac-card-window .vac-chat-container textarea,.vac-card-window .vac-chat-container input[type=text],.vac-card-window .vac-chat-container input[type=search]{-webkit-appearance:none}.vac-media-preview{position:fixed;top:0;left:0;z-index:99;width:100vw;height:100vh;display:flex;align-items:center;background-color:#000c;outline:none}.vac-media-preview .vac-media-preview-container{height:calc(100% - 140px);width:calc(100% - 80px);padding:70px 40px;margin:0 auto}.vac-media-preview .vac-image-preview{width:100%;height:100%;background-size:contain;background-repeat:no-repeat;background-position:center}.vac-media-preview video{width:100%;height:100%}.vac-media-preview .vac-svg-button{position:absolute;top:30px;right:30px;transform:scale(1.4)}@media only screen and (max-width: 768px){.vac-media-preview .vac-svg-button{top:20px;right:20px;transform:scale(1.2)}.vac-media-preview .vac-media-preview-container{width:calc(100% - 40px);padding:70px 20px}}.vac-col-messages{position:relative;height:100%;flex:1;overflow:hidden;display:flex;flex-flow:column}.vac-col-messages .vac-container-center{height:100%;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}.vac-col-messages .vac-room-empty{font-size:14px;color:#9ca6af;font-style:italic;line-height:20px;white-space:pre-line}.vac-col-messages .vac-room-empty div{padding:0 10%}.vac-col-messages .vac-container-scroll{background:var(--chat-content-bg-color);flex:1;overflow-y:auto;margin-right:1px;margin-top:65px;-webkit-overflow-scrolling:touch}.vac-col-messages .vac-container-scroll.vac-scroll-smooth{scroll-behavior:smooth}.vac-col-messages .vac-messages-container{padding:0 5px 5px}.vac-col-messages .vac-text-started{font-size:14px;color:var(--chat-message-color-started);font-style:italic;text-align:center;margin-top:25px;margin-bottom:20px}.vac-col-messages .vac-icon-scroll{position:absolute;bottom:80px;right:20px;padding:8px;background:var(--chat-bg-scroll-icon);border-radius:50%;box-shadow:0 1px 1px -1px #0003,0 1px 1px #00000024,0 1px 2px #0000001f;display:flex;cursor:pointer;z-index:10}.vac-col-messages .vac-icon-scroll svg{height:25px;width:25px}.vac-col-messages .vac-messages-count{position:absolute;top:-8px;left:11px;background-color:var(--chat-message-bg-color-scroll-counter);color:var(--chat-message-color-scroll-counter)}.vac-col-messages .vac-messages-hidden{opacity:0}@media only screen and (max-width: 768px){.vac-col-messages .vac-container-scroll{margin-top:50px}.vac-col-messages .vac-text-started{margin-top:20px}.vac-col-messages .vac-icon-scroll{bottom:70px}}.vac-room-header{position:absolute;display:flex;align-items:center;height:64px;width:100%;z-index:10;margin-right:1px;background:var(--chat-header-bg-color);border-top-right-radius:var(--chat-container-border-radius)}.vac-room-header .vac-room-wrapper{display:flex;align-items:center;min-width:0;height:100%;width:100%;padding:0 16px}.vac-room-header .vac-toggle-button{margin-right:15px}.vac-room-header .vac-toggle-button svg{height:26px;width:26px}.vac-room-header .vac-rotate-icon{transform:rotate(180deg)!important}.vac-room-header .vac-rotate-icon-init{transform:rotate(360deg)}.vac-room-header .vac-info-wrapper,.vac-room-header .vac-room-selection{display:flex;align-items:center;min-width:0;width:100%;height:100%}.vac-room-header .vac-room-selection .vac-selection-button{padding:8px 16px;color:var(--chat-color-button);background-color:var(--chat-bg-color-button);border-radius:4px;margin-right:10px;cursor:pointer;transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-button:hover{opacity:.7}.vac-room-header .vac-room-selection .vac-selection-button:active{opacity:.9}.vac-room-header .vac-room-selection .vac-selection-button .vac-selection-button-count{margin-left:6px;opacity:.9}.vac-room-header .vac-room-selection .vac-selection-cancel{display:flex;align-items:center;margin-left:auto;white-space:nowrap;color:var(--chat-color-button-clear);transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-cancel:hover{opacity:.7}.vac-room-header .vac-room-name{font-size:17px;font-weight:500;line-height:22px;color:var(--chat-header-color-name)}.vac-room-header .vac-room-info{font-size:13px;line-height:18px;color:var(--chat-header-color-info)}.vac-room-header .vac-room-options{margin-left:auto}@media only screen and (max-width: 768px){.vac-room-header{height:50px}.vac-room-header .vac-room-wrapper{padding:0 10px}.vac-room-header .vac-room-name{font-size:16px;line-height:22px}.vac-room-header .vac-room-info{font-size:12px;line-height:16px}.vac-room-header .vac-avatar{height:37px;width:37px;min-height:37px;min-width:37px}}.vac-room-footer{width:100%;border-bottom-right-radius:4px;z-index:10}.vac-box-footer{display:flex;position:relative;background:var(--chat-footer-bg-color);padding:10px 8px}.vac-textarea{max-height:300px;overflow-y:auto;height:20px;width:100%;line-height:20px;outline:0;resize:none;border-radius:20px;padding:12px 16px;box-sizing:content-box;font-size:16px;background:var(--chat-bg-color-input);color:var(--chat-color);caret-color:var(--chat-color-caret);border:var(--chat-border-style-input)}.vac-textarea::placeholder{color:var(--chat-color-placeholder);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-textarea-outline{border:1px solid var(--chat-border-color-input-selected);box-shadow:inset 0 0 0 1px var(--chat-border-color-input-selected)}.vac-icon-textarea,.vac-icon-textarea-left{display:flex;align-items:center}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea{margin-left:5px}.vac-icon-textarea-left{display:flex;align-items:center;margin-right:5px}.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea-left .vac-icon-microphone{fill:var(--chat-icon-color-microphone);margin:0 7px}.vac-icon-textarea-left .vac-dot-audio-record{height:15px;width:15px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-record);animation:vac-scaling .8s ease-in-out infinite alternate}@keyframes vac-scaling{0%{transform:scale(1);opacity:.4}to{transform:scale(1.1);opacity:1}}.vac-icon-textarea-left .vac-dot-audio-record-time{font-size:16px;color:var(--chat-color);margin-left:8px;width:45px}.vac-icon-textarea-left .vac-icon-audio-stop,.vac-icon-textarea-left .vac-icon-audio-confirm{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop svg,.vac-icon-textarea-left .vac-icon-audio-confirm svg{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop{margin-right:20px}.vac-icon-textarea-left .vac-icon-audio-stop #vac-icon-close-outline{fill:var(--chat-icon-color-audio-cancel)}.vac-icon-textarea-left .vac-icon-audio-confirm{margin-right:3px;margin-left:12px}.vac-icon-textarea-left .vac-icon-audio-confirm #vac-icon-checkmark{fill:var(--chat-icon-color-audio-confirm)}.vac-send-disabled,.vac-send-disabled svg{cursor:none!important;pointer-events:none!important;transform:none!important}@media only screen and (max-width: 768px){.vac-room-footer{width:100%}.vac-box-footer{padding:7px 2px 7px 7px}.vac-box-footer.vac-box-footer-border{border-top:var(--chat-border-style-input)}.vac-textarea{padding:7px;line-height:18px}.vac-textarea::placeholder{color:transparent}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 5px!important}}@media only screen and (max-height: 768px){.vac-textarea{max-height:120px}}.vac-emojis-container{width:calc(100% - 16px);padding:10px 8px;background:var(--chat-footer-bg-color);display:flex;align-items:center;overflow:auto}.vac-emojis-container .vac-emoji-element{padding:0 8px;font-size:30px;border-radius:4px;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-emojis-container .vac-emoji-element-active{background:var(--chat-footer-bg-color-tag-active)}@media only screen and (max-width: 768px){.vac-emojis-container{width:calc(100% - 10px);padding:7px 5px}.vac-emojis-container .vac-emoji-element{padding:0 7px;font-size:26px}}.vac-reply-container{display:flex;padding:10px 10px 0;background:var(--chat-footer-bg-color);align-items:center;width:calc(100% - 20px)}.vac-reply-container .vac-reply-box{width:100%;overflow:hidden;background:var(--chat-footer-bg-color-reply);border-radius:4px;padding:8px 10px}.vac-reply-container .vac-reply-info{overflow:hidden}.vac-reply-container .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-container .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content);white-space:pre-line}.vac-reply-container .vac-icon-reply{margin-left:10px}.vac-reply-container .vac-icon-reply svg{height:20px;width:20px}.vac-reply-container .vac-image-reply{max-height:100px;max-width:200px;margin:4px 10px 0 0;border-radius:4px}.vac-reply-container .vac-audio-reply{margin-right:10px}.vac-reply-container .vac-file-container{max-width:80px}@media only screen and (max-width: 768px){.vac-reply-container{padding:5px 8px;width:calc(100% - 16px)}}.vac-room-files-container{display:flex;align-items:center;padding:10px 6px 0;background:var(--chat-footer-bg-color)}.vac-room-files-container .vac-files-box{display:flex;overflow:auto;width:calc(100% - 30px)}.vac-room-files-container video{height:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-files-container .vac-icon-close{margin-left:auto}.vac-room-files-container .vac-icon-close svg{height:20px;width:20px}@media only screen and (max-width: 768px){.vac-files-container{padding:6px 4px 4px 2px}}.vac-room-file-container{display:flex;position:relative;margin:0 4px}.vac-room-file-container .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:100px;width:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-file-container .vac-file-container{height:80px;width:80px}.vac-room-file-container .vac-icon-remove{position:absolute;top:6px;left:6px;z-index:10}.vac-room-file-container .vac-icon-remove svg{height:20px;width:20px;border-radius:50%}.vac-room-file-container .vac-icon-remove:before{content:" ";position:absolute;width:100%;height:100%;background:rgba(0,0,0,.5);border-radius:50%;z-index:-1}.vac-tags-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-tags-container .vac-tags-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-tags-container .vac-tags-box-active{background:var(--chat-footer-bg-color-tag-active)}.vac-tags-container .vac-tags-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-tags-container .vac-tags-avatar{height:34px;width:34px;min-height:34px;min-width:34px}.vac-tags-container .vac-tags-username{font-size:14px}@media only screen and (max-width: 768px){.vac-tags-container .vac-tags-box{height:50px}.vac-tags-container .vac-tags-info{padding:0 12px}}.vac-template-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-template-container .vac-template-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-template-container .vac-template-active{background:var(--chat-footer-bg-color-tag-active)}.vac-template-container .vac-template-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-template-container .vac-template-tag{font-size:14px;font-weight:700;margin-right:10px}.vac-template-container .vac-template-text{font-size:14px}@media only screen and (max-width: 768px){.vac-template-container .vac-template-box{height:50px}.vac-template-container .vac-template-info{padding:0 12px}}.vac-rooms-container{display:flex;flex-flow:column;flex:0 0 25%;min-width:260px;max-width:500px;position:relative;background:var(--chat-sidemenu-bg-color);height:100%;border-top-left-radius:var(--chat-container-border-radius);border-bottom-left-radius:var(--chat-container-border-radius)}.vac-rooms-container.vac-rooms-container-full{flex:0 0 100%;max-width:100%}.vac-rooms-container .vac-rooms-empty{font-size:14px;color:#9ca6af;font-style:italic;text-align:center;margin:40px 0;line-height:20px;white-space:pre-line}.vac-rooms-container .vac-room-list{flex:1;position:relative;max-width:100%;cursor:pointer;padding:0 10px 5px;overflow-y:auto}.vac-rooms-container .vac-room-item{border-radius:8px;align-items:center;display:flex;flex:1 1 100%;margin-bottom:5px;padding:0 14px;position:relative;min-height:71px;transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-rooms-container .vac-room-item:hover{background:var(--chat-sidemenu-bg-color-hover)}.vac-rooms-container .vac-room-selected{color:var(--chat-sidemenu-color-active)!important;background:var(--chat-sidemenu-bg-color-active)!important}.vac-rooms-container .vac-room-selected:hover{background:var(--chat-sidemenu-bg-color-active)!important}@media only screen and (max-width: 768px){.vac-rooms-container .vac-room-list{padding:0 7px 5px}.vac-rooms-container .vac-room-item{min-height:60px;padding:0 8px}}.vac-room-container{display:flex;flex:1;align-items:center;width:100%}.vac-room-container .vac-name-container{flex:1}.vac-room-container .vac-title-container{display:flex;align-items:center;line-height:25px}.vac-room-container .vac-state-circle{width:9px;height:9px;border-radius:50%;background-color:var(--chat-room-color-offline);margin-right:6px;transition:.3s}.vac-room-container .vac-state-online{background-color:var(--chat-room-color-online)}.vac-room-container .vac-room-name{flex:1;color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-text-date{margin-left:5px;font-size:11px;color:var(--chat-room-color-timestamp)}.vac-room-container .vac-text-last{display:flex;align-items:center;font-size:12px;line-height:19px;color:var(--chat-room-color-message)}.vac-room-container .vac-message-new{color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-icon-check{display:flex;vertical-align:middle;height:14px;width:14px;margin-top:-2px;margin-right:2px}.vac-room-container .vac-icon-microphone{height:15px;width:15px;vertical-align:middle;margin:-3px 1px 0 -2px;fill:var(--chat-room-color-message)}.vac-room-container .vac-room-options-container{display:flex;margin-left:auto}.vac-room-container .vac-room-badge{background-color:var(--chat-room-bg-color-badge);color:var(--chat-room-color-badge);margin-left:5px}.vac-room-container .vac-list-room-options{height:19px;width:19px;align-items:center;margin-left:5px}.vac-box-empty{margin-top:10px}@media only screen and (max-width: 768px){.vac-box-empty{margin-top:7px}}.vac-box-search{position:sticky;display:flex;align-items:center;height:64px;padding:0 15px}.vac-box-search .vac-icon-search{display:flex;position:absolute;left:30px}.vac-box-search .vac-icon-search svg{width:18px;height:18px}.vac-box-search .vac-input{height:38px;width:100%;background:var(--chat-bg-color-input);color:var(--chat-color);font-size:15px;outline:0;caret-color:var(--chat-color-caret);padding:10px 10px 10px 40px;border:1px solid var(--chat-sidemenu-border-color-search);border-radius:20px}.vac-box-search .vac-input::placeholder{color:var(--chat-color-placeholder)}.vac-box-search .vac-add-icon{margin-left:auto;padding-left:10px}@media only screen and (max-width: 768px){.vac-box-search{height:58px}}.vac-message-wrapper .vac-card-info{border-radius:4px;text-align:center;margin:10px auto;font-size:12px;padding:4px;display:block;overflow-wrap:break-word;position:relative;white-space:normal;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-card-date{max-width:150px;font-weight:500;text-transform:uppercase;color:var(--chat-message-color-date);background-color:var(--chat-message-bg-color-date)}.vac-message-wrapper .vac-card-system{max-width:250px;padding:8px 4px;color:var(--chat-message-color-system);background-color:var(--chat-message-bg-color-system)}.vac-message-wrapper .vac-line-new{color:var(--chat-message-color-new-messages);position:relative;text-align:center;font-size:13px;padding:10px 0}.vac-message-wrapper .vac-line-new:after,.vac-message-wrapper .vac-line-new:before{border-top:1px solid var(--chat-message-color-new-messages);content:"";left:0;position:absolute;top:50%;width:calc(50% - 60px)}.vac-message-wrapper .vac-line-new:before{left:auto;right:0}.vac-message-wrapper .vac-message-box{display:flex;flex:0 0 50%;max-width:50%;justify-content:flex-start;line-height:1.4}.vac-message-wrapper .vac-avatar{height:28px;width:28px;min-height:28px;min-width:28px;margin:0 0 2px;align-self:flex-end}.vac-message-wrapper .vac-avatar-current-offset{margin-right:28px}.vac-message-wrapper .vac-avatar-offset{margin-left:28px}.vac-message-wrapper .vac-failure-container{position:relative;align-self:flex-end;height:20px;width:20px;margin:0 0 2px -4px;border-radius:50%;background-color:#f44336}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:6px}.vac-message-wrapper .vac-failure-container .vac-failure-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-size:15px;font-weight:700}.vac-message-wrapper .vac-message-container{position:relative;padding:2px 10px;align-items:end;min-width:100px;box-sizing:content-box}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-offset-current{margin-left:50%;justify-content:flex-end}.vac-message-wrapper .vac-message-card{background-color:var(--chat-message-bg-color);color:var(--chat-message-color);border-radius:8px;font-size:14px;padding:6px 9px 3px;white-space:pre-line;max-width:100%;-webkit-transition-property:box-shadow,opacity;transition-property:box-shadow,opacity;transition:box-shadow .28s cubic-bezier(.4,0,.2,1);will-change:box-shadow;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-message-highlight{box-shadow:0 1px 2px -1px #0000001a,0 1px 2px -1px #0000001c,0 1px 5px -1px #0000001c}.vac-message-wrapper .vac-message-current{background-color:var(--chat-message-bg-color-me)!important}.vac-message-wrapper .vac-message-deleted{color:var(--chat-message-color-deleted)!important;font-size:13px!important;font-style:italic!important;background-color:var(--chat-message-bg-color-deleted)!important}.vac-message-wrapper .vac-message-selected{background-color:var(--chat-message-bg-color-selected)!important;transition:background-color .2s}.vac-message-wrapper .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:250px;width:250px;max-width:100%;border-radius:4px;margin:4px auto 5px;transition:.4s filter linear}.vac-message-wrapper .vac-text-username{font-size:13px;color:var(--chat-message-color-username);margin-bottom:2px}.vac-message-wrapper .vac-username-reply{margin-bottom:5px}.vac-message-wrapper .vac-text-timestamp{font-size:10px;color:var(--chat-message-color-timestamp);text-align:right}.vac-message-wrapper .vac-progress-time{float:left;margin:-2px 0 0 40px;color:var(--chat-color);font-size:12px}.vac-message-wrapper .vac-icon-edited{-webkit-box-align:center;align-items:center;display:-webkit-inline-box;display:inline-flex;justify-content:center;letter-spacing:normal;line-height:1;text-indent:0;vertical-align:middle;margin:0 4px 2px}.vac-message-wrapper .vac-icon-edited svg{height:12px;width:12px}.vac-message-wrapper .vac-icon-check{height:14px;width:14px;vertical-align:middle;margin:-3px -3px 0 3px}@media only screen and (max-width: 768px){.vac-message-wrapper .vac-message-container{padding:2px 3px 1px}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-message-box{flex:0 0 80%;max-width:80%}.vac-message-wrapper .vac-avatar{height:25px;width:25px;min-height:25px;min-width:25px;margin:0 6px 1px 0}.vac-message-wrapper .vac-avatar.vac-avatar-current{margin:0 0 1px 6px}.vac-message-wrapper .vac-avatar-current-offset{margin-right:31px}.vac-message-wrapper .vac-avatar-offset{margin-left:31px}.vac-message-wrapper .vac-failure-container{margin-left:2px}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:0}.vac-message-wrapper .vac-offset-current{margin-left:20%}.vac-message-wrapper .vac-progress-time{margin-left:37px}}.vac-audio-player{display:flex;margin:8px 0 5px}.vac-audio-player .vac-svg-button{max-width:18px;margin-left:7px}@media only screen and (max-width: 768px){.vac-audio-player{margin:4px 0 0}.vac-audio-player .vac-svg-button{max-width:16px;margin-left:5px}}.vac-player-bar{display:flex;align-items:center;max-width:calc(100% - 18px);margin-right:7px;margin-left:20px}.vac-player-bar .vac-player-progress{width:190px}.vac-player-bar .vac-player-progress .vac-line-container{position:relative;height:4px;border-radius:5px;background-color:var(--chat-message-bg-color-audio-line)}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-progress{position:absolute;height:inherit;background-color:var(--chat-message-bg-color-audio-progress);border-radius:inherit}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{position:absolute;top:-5px;margin-left:-7px;height:14px;width:14px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-progress-selector);transition:transform .25s}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot__active{transform:scale(1.2)}@media only screen and (max-width: 768px){.vac-player-bar{margin-right:5px}.vac-player-bar .vac-player-progress .vac-line-container{height:3px}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{height:12px;width:12px;top:-5px;margin-left:-5px}}.vac-message-actions-wrapper .vac-options-container{position:absolute;top:2px;right:10px;height:40px;width:70px;overflow:hidden;border-top-right-radius:8px}.vac-message-actions-wrapper .vac-blur-container{position:absolute;height:100%;width:100%;left:8px;bottom:10px;background:var(--chat-message-bg-color);filter:blur(3px);border-bottom-left-radius:8px}.vac-message-actions-wrapper .vac-options-me{background:var(--chat-message-bg-color-me)}.vac-message-actions-wrapper .vac-message-options{background:var(--chat-icon-bg-dropdown-message);border-radius:50%;position:absolute;top:7px;right:7px}.vac-message-actions-wrapper .vac-message-options svg{height:17px;width:17px;padding:5px;margin:-5px}.vac-message-actions-wrapper .vac-message-emojis{position:absolute;top:6px;right:30px}.vac-message-actions-wrapper .vac-menu-options{right:15px}.vac-message-actions-wrapper .vac-menu-left{right:-118px}@media only screen and (max-width: 768px){.vac-message-actions-wrapper .vac-options-container{right:3px}.vac-message-actions-wrapper .vac-menu-left{right:-50px}}.vac-message-files-container .vac-file-wrapper{position:relative;width:fit-content}.vac-message-files-container .vac-file-wrapper .vac-file-container{height:60px;width:60px;margin:3px 0 5px;cursor:pointer;transition:all .6s}.vac-message-files-container .vac-file-wrapper .vac-file-container:hover{opacity:.85}.vac-message-files-container .vac-file-wrapper .vac-file-container svg{height:30px;width:30px}.vac-message-files-container .vac-file-wrapper .vac-file-container.vac-file-container-progress{background-color:#0000004d}.vac-message-file-container{position:relative;z-index:0}.vac-message-file-container .vac-message-image-container{cursor:pointer}.vac-message-file-container .vac-image-buttons{position:absolute;width:100%;height:100%;border-radius:4px;background:linear-gradient(to bottom,rgba(0,0,0,0) 55%,rgba(0,0,0,.02) 60%,rgba(0,0,0,.05) 65%,rgba(0,0,0,.1) 70%,rgba(0,0,0,.2) 75%,rgba(0,0,0,.3) 80%,rgba(0,0,0,.5) 85%,rgba(0,0,0,.6) 90%,rgba(0,0,0,.7) 95%,rgba(0,0,0,.8) 100%)}.vac-message-file-container .vac-image-buttons svg{height:26px;width:26px}.vac-message-file-container .vac-image-buttons .vac-button-view,.vac-message-file-container .vac-image-buttons .vac-button-download{position:absolute;bottom:6px;left:7px}.vac-message-file-container .vac-image-buttons :first-child{left:40px}.vac-message-file-container .vac-image-buttons .vac-button-view{max-width:18px;bottom:8px}.vac-message-file-container .vac-video-container{width:350px;max-width:100%;margin:4px auto 5px;cursor:pointer}.vac-message-file-container .vac-video-container video{width:100%;height:100%;border-radius:4px}.vac-button-reaction{display:inline-flex;align-items:center;border:var(--chat-message-border-style-reaction);outline:none;background:var(--chat-message-bg-color-reaction);border-radius:4px;margin:4px 2px 0;transition:.3s;padding:0 5px;font-size:18px;line-height:23px}.vac-button-reaction span{font-size:11px;font-weight:500;min-width:7px;color:var(--chat-message-color-reaction-counter)}.vac-button-reaction:hover{border:var(--chat-message-border-style-reaction-hover);background:var(--chat-message-bg-color-reaction-hover);cursor:pointer}.vac-button-reaction.vac-reaction-me{border:var(--chat-message-border-style-reaction-me);background:var(--chat-message-bg-color-reaction-me)}.vac-button-reaction.vac-reaction-me span{color:var(--chat-message-color-reaction-counter-me)}.vac-button-reaction.vac-reaction-me:hover{border:var(--chat-message-border-style-reaction-hover-me);background:var(--chat-message-bg-color-reaction-hover-me)}.vac-reply-message{background:var(--chat-message-bg-color-reply);border-radius:4px;margin:-1px -5px 8px;padding:8px 10px}.vac-reply-message .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-message .vac-image-reply-container{width:70px}.vac-reply-message .vac-image-reply-container .vac-message-image-reply{height:70px;width:70px;margin:4px auto 3px}.vac-reply-message .vac-video-reply-container{width:200px;max-width:100%}.vac-reply-message .vac-video-reply-container video{width:100%;height:100%;border-radius:4px}.vac-reply-message .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content)}.vac-reply-message .vac-file-container{height:60px;width:60px}.vac-emoji-wrapper{position:relative;display:flex}.vac-emoji-wrapper .vac-emoji-reaction svg{height:19px;width:19px}.vac-emoji-wrapper .vac-emoji-picker{position:absolute;z-index:9999;bottom:32px;right:10px;width:300px;padding-top:4px;overflow:scroll;box-sizing:border-box;border-radius:.5rem;background:var(--chat-emoji-bg-color);box-shadow:0 1px 2px -2px #0000001a,0 1px 2px -1px #0000001a,0 1px 2px 1px #0000001a;scrollbar-width:none}.vac-emoji-wrapper .vac-emoji-picker::-webkit-scrollbar{display:none}.vac-emoji-wrapper .vac-emoji-picker.vac-picker-reaction{position:fixed;top:initial;right:initial}.vac-emoji-wrapper .vac-emoji-picker emoji-picker{height:100%;width:100%;--emoji-size: 1.2rem;--background: var(--chat-emoji-bg-color);--emoji-padding: .4rem;--border-color: var(--chat-sidemenu-border-color-search);--button-hover-background: var(--chat-sidemenu-bg-color-hover);--button-active-background: var(--chat-sidemenu-bg-color-hover)}.vac-format-message-wrapper .vac-format-container{display:inline}.vac-format-message-wrapper .vac-icon-deleted{height:14px;width:14px;vertical-align:middle;margin:-2px 2px 0 0;fill:var(--chat-message-color-deleted)}.vac-format-message-wrapper .vac-icon-deleted.vac-icon-deleted-room{margin:-3px 1px 0 0;fill:var(--chat-room-color-message)}.vac-format-message-wrapper .vac-image-link-container{background-color:var(--chat-message-bg-color-media);padding:8px;margin:2px auto;border-radius:4px}.vac-format-message-wrapper .vac-image-link{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:contain;background-position:center center!important;background-repeat:no-repeat!important;height:150px;width:150px;max-width:100%;border-radius:4px;margin:0 auto}.vac-format-message-wrapper .vac-image-link-message{max-width:166px;font-size:12px}.vac-loader-wrapper.vac-container-center{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-loader-wrapper.vac-container-top{padding:21px}.vac-loader-wrapper.vac-container-top #vac-circle{height:20px;width:20px}.vac-loader-wrapper #vac-circle{margin:auto;height:28px;width:28px;border:3px rgba(0,0,0,.25) solid;border-top:3px var(--chat-color-spinner) solid;border-right:3px var(--chat-color-spinner) solid;border-bottom:3px var(--chat-color-spinner) solid;border-radius:50%;-webkit-animation:vac-spin 1s infinite linear;animation:vac-spin 1s infinite linear}@media only screen and (max-width: 768px){.vac-loader-wrapper #vac-circle{height:24px;width:24px}.vac-loader-wrapper.vac-container-top{padding:18px}.vac-loader-wrapper.vac-container-top #vac-circle{height:16px;width:16px}}@-webkit-keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}#vac-icon-search{fill:var(--chat-icon-color-search)}#vac-icon-add{fill:var(--chat-icon-color-add)}#vac-icon-toggle{fill:var(--chat-icon-color-toggle)}#vac-icon-menu{fill:var(--chat-icon-color-menu)}#vac-icon-close{fill:var(--chat-icon-color-close)}#vac-icon-close-image{fill:var(--chat-icon-color-close-image)}#vac-icon-file{fill:var(--chat-icon-color-file)}#vac-icon-paperclip{fill:var(--chat-icon-color-paperclip)}#vac-icon-close-outline{fill:var(--chat-icon-color-close-outline)}#vac-icon-close-outline-preview{fill:var(--chat-icon-color-close-preview)}#vac-icon-send{fill:var(--chat-icon-color-send)}#vac-icon-send-disabled{fill:var(--chat-icon-color-send-disabled)}#vac-icon-emoji{fill:var(--chat-icon-color-emoji)}#vac-icon-emoji-reaction{fill:var(--chat-icon-color-emoji-reaction)}#vac-icon-document{fill:var(--chat-icon-color-document)}#vac-icon-pencil{fill:var(--chat-icon-color-pencil)}#vac-icon-checkmark,#vac-icon-double-checkmark{fill:var(--chat-icon-color-checkmark)}#vac-icon-checkmark-seen,#vac-icon-double-checkmark-seen{fill:var(--chat-icon-color-checkmark-seen)}#vac-icon-eye{fill:var(--chat-icon-color-eye)}#vac-icon-dropdown-message{fill:var(--chat-icon-color-dropdown-message)}#vac-icon-dropdown-room{fill:var(--chat-icon-color-dropdown-room)}#vac-icon-dropdown-scroll{fill:var(--chat-icon-color-dropdown-scroll)}#vac-icon-audio-play{fill:var(--chat-icon-color-audio-play)}#vac-icon-audio-pause{fill:var(--chat-icon-color-audio-pause)}.vac-progress-wrapper{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-progress-wrapper circle{transition:stroke-dashoffset .35s;transform:rotate(-90deg);transform-origin:50% 50%}.vac-progress-wrapper .vac-progress-content{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:-1;margin-top:-2px;background-color:#000000b3;border-radius:50%}.vac-progress-wrapper .vac-progress-content .vac-progress-text{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-weight:700;color:#fff}.vac-progress-wrapper .vac-progress-content .vac-progress-text .vac-progress-pourcent{font-size:9px;font-weight:400}\n']]]));function Pg(){customElements.get("vue-advanced-chat")||customElements.define("vue-advanced-chat",Lg)}}}]);